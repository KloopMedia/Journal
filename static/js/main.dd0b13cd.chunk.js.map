{"version":3,"sources":["util/Firebase.js","util/Auth.js","kloop_transparent_site.png","Components/Appbar/newAppBar.js","Components/form/feedback.js","Components/Dialog/FeedbackDialog.js","Components/form/LinearProgressWithLabel.js","Components/form/file.js","Components/form/textInput.js","Components/form/selectBox.js","Components/form/radiobutton.js","Components/form/timePickers.js","Components/form/checkbox.js","Components/Profile/Profile.js","Components/Tasks/Card.js","Components/Tasks/Tasks.js","Components/form/text.js","Components/form/form.js","Components/Dialog/Dialog.js","Components/Tasks/Task.js","Components/Cases/Case.js","Components/Cases/Cases.js","Components/Notifications/Notification.js","Components/Notifications/Notifications.js","Components/Home/Home.js","Components/Moderator/UserCard.js","Components/Moderator/ModeratedTask.js","Components/Moderator/PaginatedTasks.js","Components/Moderator/TasksObserver.js","Components/Auth/Signin.js","util/PrivateRoute.js","Components/FAQ/Card.js","Components/FAQ/FAQ.js","Components/Tasks/JSchemaCard.js","Components/Page/Page.js","Components/form/Loader.js","Components/form/CustomFileUpload.js","Components/Tasks/JSchemaTask.js","App.js","reportWebVitals.js","index.js"],"names":["firebase","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","provider","auth","GoogleAuthProvider","signInWithGoogle","signInWithPopup","AuthContext","React","createContext","AuthProvider","children","useState","currentUser","setCurrentUser","setPending","useEffect","onAuthStateChanged","user","rootRef","firestore","collection","userRef","doc","uid","get","then","exists","console","log","set","username","displayName","email","created_date","FieldValue","serverTimestamp","Provider","value","drawerWidth","useStyles","makeStyles","theme","root","display","drawer","breakpoints","up","width","flexShrink","appBar","background","boxShadow","marginLeft","menuButton","color","marginRight","spacing","toolbar","mixins","drawerPaper","content","flexGrow","padding","ResponsiveDrawer","props","window","classes","useTheme","mobileOpen","setMobileOpen","useContext","anchorEl","setAnchorEl","menuOpen","Boolean","handleDrawerToggle","moderator","setModerator","numOfMessages","setNumOfMessages","messages","setMessages","userRanks","setUserRanks","userPages","setUserPages","snap","forEach","id","catch","onSnapshot","data","ranks","length","where","snapshot","docChanges","change","type","prevState","unsubscribe","a","size","m","count","shown","push","sort","b","toDate","className","Divider","to","Object","keys","map","page","name","container","undefined","document","body","CssBaseline","AppBar","position","Toolbar","IconButton","aria-label","edge","onClick","Grid","style","src","KloopLogo","alt","height","aria-controls","aria-haspopup","event","currentTarget","Badge","badgeContent","overlap","fill","fontSize","anchorOrigin","vertical","horizontal","keepMounted","transformOrigin","open","onClose","direction","alignItems","message","i","justify","Typography","flex","title","Button","update","align","borderColor","variant","signOut","Hidden","smUp","implementation","Drawer","anchor","paper","ModalProps","xsDown","Feedback","setValue","textValue","setTextValue","returnAnswer","FormControl","const","paddingBottom","RadioGroup","onChange","target","reason","text","answers","el","FormControlLabel","control","Radio","label","disabled","locked","TextField","multiline","rows","fullWidth","AlertDialog","Dialog","state","handleClose","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","description","returnFeedback","DialogActions","dialogFunction","feedbackValue","autoFocus","LinearProgressWithLabel","Box","mr","LinearProgress","minWidth","Math","round","File","setFormData","setShowFeedback","returnFile","feedbackType","askFeedback","saveQuestionFeedback","prevTaskId","files","multiple","BasicTextFields","forwardRef","ref","dialogOpen","setDialogOpen","setFeedback","feedbackFormData","showFeedback","index","response","attachMaterials","uploadFilesData","handleDialogClose","marginBottom","marginTop","paddingRight","formControl","maxWidth","SelectBox","setOpen","required","InputLabel","Select","labelId","onOpen","indexOf","MenuItem","RadioButton","flexWrap","textField","TimePickers","noValidate","InputLabelProps","shrink","InputProps","disableUnderline","CheckboxesGroup","setState","ready","setReady","answer","handleChange","checked","component","FormLabel","FormGroup","Checkbox","Profile","questions","setQuestions","setAnswers","forms","setForms","uploaded","setUploaded","redirect","setRedirect","setUserData","JSON","stringify","key","question","tmp","borderWidth","margin","mergedAnswers","q","bullet","pos","TaskCard","complete","language","cardColor","sendRequest","Card","CardContent","justifyContent","CardActions","TabPanel","other","role","hidden","p","a11yProps","paddingTop","Tasks","allTasks","setTasks","submittedTasks","setSubmitted","tasks","submitted","querySnapshot","is_complete","error","Paper","Tabs","newValue","centered","Tab","task","Form","uploadsRef","feedback_type","hideActions","showOk","handleOk","setResponses","lockButton","setLock","setCaseTasks","dialogState","setDialog","dialogType","setDialogType","releaseFeedbackData","setReleaseFeedbackData","openSnackbar","setOpenSnackbar","setFiles","uploading","setUploading","useParams","handleCloseSnackbar","getQuestions","taskID","questionId","getResponses","r","responseId","getSameCaseTasks","sameCaseTasks","case_id","f","status","sq","sr","ques","t","resp","Promise","all","d","sf","res","newF","concat","getForms","file","arr","upload","storage","child","v","put","getDownloadURL","url","url_wo_token","split","entries","previousTaskId","add","user_id","timestamp","alert","saveToFirebase","lock","merge","filename","arrayUnion","public_url","handleDialogOpen","CircularProgress","release_status","release_description","Snackbar","autoHideDuration","action","Fragment","Case","caseId","disableCase","setDisable","setMessage","parseInt","order","task_type","taskType","case_type","case_stage_id","border","item","Cases","allCases","setCases","setRanks","getCasesFromFirebase","cases","c","down","dt","setShown","date","opacity","paddingLeft","getDate","toString","padStart","getMonth","getFullYear","getHours","getMinutes","getSeconds","Notifications","cards","setCards","updateFirestoreStatus","Notification","queryString","require","Home","setToken","makeToken","uuid","Date","now","oldToken","tg_token","oldDate","substring","moment","diff","newToken","urlString","parse","location","search","rank","processed","Link","href","transform","UserCard","userInfo","gutterBottom","surname","district","phone","ModeratedTask","taskInfo","setTaskInfo","pending","passed","setPassed","notPassed","setNotPassed","verified","setVerified","notVerified","setNotVerified","getReviewStatus","review_status","getData","updateReviewStatus","assigned_users","users","find","getUserInfo","PaginatedTasks","setPage","rowsPerPage","dataSlice","setDataSlice","calculateSlice","pageNumber","rowsPage","iData","List","numberOfPages","floor","start","end","slice","pagination","TablePagination","onChangePage","newPage","onChangeRowsPerPage","labelRowsPerPage","isAllowedToRenderTask","minHeight","xs","TasksObserver","taskTypes","taskTitles","taskReviewStatuses","setUser","setUsers","setTaskType","taskTitle","setTaskTitle","taskReviewStatus","setTaskReviewStatus","getUsers","usersList","usersRef","orderBy","docs","getTasks","tasksList","tasksRef","NativeSelect","FormHelperText","startIcon","Signin","PrivateRoute","RouteComponent","rest","render","routeProps","button","sendAnswer","taskId","select","FAQ","handleClickApplyFilters","tasklist","taskList","questionList","apply","JSchemaTaskCard","history","useHistory","cardType","stage","stageID","pCase","waiting","setWaiting","sendCallbackRequest","callback","callbackType","callbackName","uuidv4","FieldPath","documentId","Page","pageData","setPageData","userCases","setUserCases","userTasks","setUserTasks","filteredStages","setFilteredStages","unlimStages","setUnlimStages","tabValue","setTabValue","availableStages","setAvailableStages","availableTasks","setAvailableTasks","userRanksDescriptions","setUserRanksDescriptions","intersection","casesPath","complexStateFirebaseUpdate","simpleStateFirebaseUpdate","caseWithSelectableTasks","limit","setFunction","subState","newState","assign","newFilteredStages","cloneDeep","newUnlimStages","caseID","stageId","rank_limit_number","setIntersection","maxTasksPerStage","calculatemaxTasksPerStage","tasksPerStage","countTasksPerStage","creatable","occurrences","values","rArray","limits","largestLimit","arrA","arrB","setA","Set","setB","_intersection","elem","has","displayTasks","stages","caseType","Loader","fileBeingUploaded","setFileBeingUploaded","storageRef","progress","on","TaskEvent","STATE_CHANGED","bytesTransferred","totalBytes","TaskState","PAUSED","RUNNING","code","downloadURL","filesLinks","contents","CustomFileUpload","currentUserUid","connectingTelegram","setConnectingTelegram","telegramConnected","setTelegramConnected","pathToFolder","handleTgConnectClick","fileUpload","linksToFiles","formData","schema","path","JSchemaTask","formResponses","setFormResponses","taskForm","setTaskForm","mergedForm","setMergedForm","taskMetadata","setTaskMetadata","caseStages","setCaseStages","backgroundTasks","setBackgroundTasks","backgroundTaskForms","setBackgroundTaskForms","mergedBackgroundForms","setMergedBackgroundForms","backgroundResponses","setBackgroundResponses","setCurrentFocus","gRef","setGRef","formLocked","setFormLocked","changes","deletes","modifyResponses","mergedBgForms","mergeForm","backgroundTasksList","backgroundStages","caseForms","tForm","cForms","start_ui_schema","end_ui_schema","form_questions","ui_schema","properties","definitions","uiOrder","uiSchema","goBack","fields","customFileUpload","e","handleFormChange","onFocus","onBlur","k","delete","handleBlur","App","exact","Task","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.dd0b13cd.chunk.js","sourcesContent":["import firebase from 'firebase';\n\nconst firebaseConfig = {\n    apiKey: \"AIzaSyBfzhQOCtbcUk_tWjPDnjYtHwoouCEkclg\",\n    authDomain: \"journal-bb5e3.firebaseapp.com\",\n    databaseURL: \"https://journal-bb5e3.firebaseio.com\",\n    projectId: \"journal-bb5e3\",\n    storageBucket: \"journal-bb5e3.appspot.com\",\n    messagingSenderId: \"918752509407\",\n    appId: \"1:918752509407:web:77670a68ff906f13e5d86a\"\n};\n  // Initialize Firebase\n  firebase.initializeApp(firebaseConfig);\n\n  const provider = new firebase.auth.GoogleAuthProvider();\n  export const signInWithGoogle = () => {\n    firebase.auth().signInWithPopup(provider);\n  };\n\nexport default firebase;","import React, { useEffect, useState } from \"react\";\nimport firebase from \"./Firebase\";\n\nexport const AuthContext = React.createContext();\n\nexport const AuthProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [pending, setPending] = useState(true);\n\n  useEffect(() => {\n    firebase.auth().onAuthStateChanged((user) => {\n      setCurrentUser(user)\n      setPending(false)\n      let rootRef = firebase.firestore().collection(\"users\")\n      if (user) {\n        let userRef = rootRef.doc(user.uid)\n        userRef.get().then(doc => {\n          if (doc && doc.exists) {\n              // pass\n              console.log('User Exist')\n          }\n          else {\n            console.log(\"Creating user\")\n            userRef.set(\n              {\n                username: user.displayName,\n                email: user.email,\n                created_date: firebase.firestore.FieldValue.serverTimestamp()\n              }\n            )\n          }\n        })\n      }\n    });\n  }, []);\n\n  // if(pending){\n  //   return <>Loading...</>\n  // }\n\n  return (\n    <AuthContext.Provider\n      value={{\n        currentUser\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n","export default __webpack_public_path__ + \"static/media/kloop_transparent_site.f6fb098e.png\";","import React, { useContext, useState, useEffect } from 'react';\nimport { AuthContext } from '../../util/Auth';\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport PropTypes from 'prop-types';\nimport AppBar from '@material-ui/core/AppBar';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Divider from '@material-ui/core/Divider';\nimport Drawer from '@material-ui/core/Drawer';\nimport Hidden from '@material-ui/core/Hidden';\nimport IconButton from '@material-ui/core/IconButton';\nimport InboxIcon from '@material-ui/icons/MoveToInbox';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport MailIcon from '@material-ui/icons/Mail';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport Menu from '@material-ui/core/Menu';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\nimport KloopLogo from '../../kloop_transparent_site.png'\nimport NotificationsIcon from '@material-ui/icons/Notifications';\nimport { Badge } from '@material-ui/core';\nimport Grid from '@material-ui/core/Grid'\n\nimport {\n\tLink\n} from \"react-router-dom\";\n\nconst drawerWidth = 240;\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\tdisplay: 'flex',\n\t},\n\tdrawer: {\n\t\t[theme.breakpoints.up('sm')]: {\n\t\t\twidth: drawerWidth,\n\t\t\tflexShrink: 0,\n\t\t},\n\t},\n\tappBar: {\n\t\tbackground: 'white',\n\t\tboxShadow: 'none',\n\t\t[theme.breakpoints.up('sm')]: {\n\t\t\twidth: `calc(100% - ${drawerWidth}px)`,\n\t\t\tmarginLeft: drawerWidth,\n\t\t},\n\t},\n\tmenuButton: {\n\t\tcolor: 'black',\n\t\tmarginRight: theme.spacing(2),\n\t\t[theme.breakpoints.up('sm')]: {\n\t\t\tdisplay: 'none',\n\t\t},\n\t},\n\t// necessary for content to be below app bar\n\ttoolbar: theme.mixins.toolbar,\n\tdrawerPaper: {\n\t\twidth: drawerWidth,\n\t},\n\tcontent: {\n\t\tflexGrow: 1,\n\t\tpadding: theme.spacing(3),\n\t},\n}));\n\nfunction ResponsiveDrawer(props) {\n\tconst { window } = props;\n\tconst classes = useStyles();\n\tconst theme = useTheme();\n\tconst [mobileOpen, setMobileOpen] = React.useState(false);\n\tconst { currentUser } = useContext(AuthContext);\n\tconst [anchorEl, setAnchorEl] = React.useState(null);\n\tconst menuOpen = Boolean(anchorEl);\n\n\tconst handleDrawerToggle = () => {\n\t\tsetMobileOpen(!mobileOpen);\n\t};\n\n\n\tconst [moderator, setModerator] = useState(false)\n\tconst [numOfMessages, setNumOfMessages] = useState(0)\n\tconst [messages, setMessages] = useState([])\n\tconst [userRanks, setUserRanks] = useState([])\n\tconst [userPages, setUserPages] = useState({})\n\n\tuseEffect(() => {\n\t\tif (currentUser) {\n\t\t\tfirebase.firestore().collection('editors').get().then((snap) => {\n\t\t\t\tsnap.forEach(doc => {\n\t\t\t\t\tif (doc.id === currentUser.uid) {\n\t\t\t\t\t\tconsole.log('moderator')\n\t\t\t\t\t\tsetModerator(true)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}).catch(() => setModerator(false))\n\t\t}\n\t}, [currentUser])\n\n\tuseEffect(() => {\n\t\tif (currentUser) {\n\t\t\tfirebase\n\t\t\t\t.firestore()\n\t\t\t\t.collection('users')\n\t\t\t\t.doc(currentUser.uid)\n\t\t\t\t.collection(\"user_private\")\n\t\t\t\t.doc(\"private\")\n\t\t\t\t.onSnapshot( doc => {\n\t\t\t\t\tsetUserRanks(doc.data().ranks)\n\t\t\t\t\tconsole.log(\"User ranks: \", doc.data().ranks)\n\t\t\t\t})\n\t\t}\n\t}, [currentUser])\n\n\tuseEffect(() => {\n\t\tif (userRanks.length > 0) {\n\t\t\tfirebase\n\t\t\t\t.firestore()\n\t\t\t\t.collection('pages')\n\t\t\t\t.where(\"ranks\", \"array-contains-any\", userRanks)\n\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\tsetUserPages(prevState => {\n\t\t\t\t\t\t\t\treturn {...prevState, [change.doc.id]: change.doc.data()}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tconsole.log(\"User pages: \", change.doc.id)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t}\n\t}, [userRanks])\n\n\n\tuseEffect(() => {\n\t\tlet unsubscribe = () => {}\n\t\tif (currentUser) {\n\t\t\tunsubscribe = firebase.firestore().collection('notifications').where('user_id', 'array-contains', currentUser.uid).onSnapshot(async snap => {\n\t\t\t\tconsole.log(snap.size)\n\t\t\t\tlet m = []\n\t\t\t\tlet count = 0\n\t\t\t\tsnap.forEach(doc => {\n\t\t\t\t\tif (!doc.data().shown) {\n\t\t\t\t\t\tm.push({ id: doc.id, ...doc.data() })\n\t\t\t\t\t\tcount++\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tm.sort((a, b) => b.created_date.toDate() - a.created_date.toDate())\n\t\t\t\tsetNumOfMessages(count)\n\t\t\t\tsetMessages(m)\n\t\t\t})\n\t\t}\n\t\treturn () => unsubscribe\n\t}, [currentUser])\n\n\tconst updateFirestoreStatus = (id, index) => {\n\t\tfirebase.firestore().collection('notifications').doc(id).update({ shown: true })\n\t}\n\n\tconst handleMenu = (event) => {\n\t\tsetAnchorEl(event.currentTarget);\n\t};\n\n\tconst handleMenuClose = () => {\n\t\tsetAnchorEl(null)\n\t}\n\n\tconst drawer = (\n\t\t<div>\n\t\t\t<div className={classes.toolbar} />\n\t\t\t<Divider />\n\t\t\t<nav>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<Link to=\"/\">Главная</Link>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<Link to=\"/profile\">Профиль</Link>\n\t\t\t\t\t</li>\n\t\t\t\t\t{/*<li>*/}\n\t\t\t\t\t{/*\t<Link to=\"/tasks\">Задания</Link>*/}\n\t\t\t\t\t{/*</li>*/}\n\t\t\t\t\t{/*<li>*/}\n\t\t\t\t\t{/*\t<Link to=\"/request\">Получить задание</Link>*/}\n\t\t\t\t\t{/*</li>*/}\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<Link to=\"/notifications\">Уведомления</Link>\n\t\t\t\t\t</li>\n\t\t\t\t\t{moderator ? <li>\n\t\t\t\t\t\t<Link to=\"/tasksObserver\">Модератор</Link>\n\t\t\t\t\t</li> : null}\n\t\t\t\t\t{moderator ? <li>\n\t\t\t\t\t\t<Link to=\"/faq\">FAQ для модераторов</Link>\n\t\t\t\t\t</li> : null}\n\t\t\t\t\t</ul>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tObject.keys(userPages).map(page => {\n\t\t\t\t\t\t\t\treturn <li key={page}> <Link to={\"/p/\" + page}>\n\t\t\t\t\t\t\t\t\t{userPages[page].name}\n\t\t\t\t\t\t\t\t</Link> </li>\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</nav>\n\t\t</div>\n\t);\n\n\tconst container = window !== undefined ? () => window().document.body : undefined;\n\n\treturn (\n\t\t<div className={classes.root}>\n\t\t\t<CssBaseline />\n\t\t\t<AppBar position=\"fixed\" className={classes.appBar}>\n\t\t\t\t<Toolbar>\n\t\t\t\t\t<IconButton\n\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\taria-label=\"open drawer\"\n\t\t\t\t\t\tedge=\"start\"\n\t\t\t\t\t\tonClick={handleDrawerToggle}\n\t\t\t\t\t\tclassName={classes.menuButton}\n\t\t\t\t\t>\n\t\t\t\t\t\t<MenuIcon />\n\t\t\t\t\t</IconButton>\n\t\t\t\t\t<Grid container style={{ flexGrow: 1 }}>\n\t\t\t\t\t\t<img src={KloopLogo} alt=\"Kloop.kg - Новости Кыргызстана\" style={{ width: 150, height: 'auto' }} />\n\t\t\t\t\t\t{/* <img src=\"https://kloop.kg/wp-content/uploads/2017/01/kloop_transparent_site.png\" alt=\"Kloop.kg - Новости Кыргызстана\" style={{ width: 150, height: 'auto' }} /> */}\n\t\t\t\t\t\t{/* <Typography variant=\"h5\" style={{ color: \"black\" }}>Journal</Typography> */}\n\t\t\t\t\t</Grid>\n\t\t\t\t\t{currentUser &&\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<IconButton\n\t\t\t\t\t\t\t\taria-label=\"account of current user\"\n\t\t\t\t\t\t\t\taria-controls=\"menu-appbar\"\n\t\t\t\t\t\t\t\taria-haspopup=\"true\"\n\t\t\t\t\t\t\t\tonClick={handleMenu}\n\t\t\t\t\t\t\t\tcolor=\"inherit\"\n\t\t\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Badge badgeContent={numOfMessages} color=\"secondary\" overlap=\"circle\" >\n\t\t\t\t\t\t\t\t\t<NotificationsIcon style={{ fill: 'grey', fontSize: '28px' }} />\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t\t<Menu\n\t\t\t\t\t\t\t\tid=\"menu-appbar\"\n\t\t\t\t\t\t\t\tanchorEl={anchorEl}\n\t\t\t\t\t\t\t\tanchorOrigin={{\n\t\t\t\t\t\t\t\t\tvertical: 'top',\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tkeepMounted\n\t\t\t\t\t\t\t\ttransformOrigin={{\n\t\t\t\t\t\t\t\t\tvertical: 'top',\n\t\t\t\t\t\t\t\t\thorizontal: 'right',\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\topen={menuOpen}\n\t\t\t\t\t\t\t\tonClose={handleMenuClose}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Grid container direction=\"column\" alignItems=\"center\" >\n\t\t\t\t\t\t\t\t\t{messages.length > 0 ? messages.map((message, i) => (\n\t\t\t\t\t\t\t\t\t\t<Grid container key={\"notification_\" + i} className={classes.message} justify=\"flex-start\" style={{ padding: 0 }}>\n\t\t\t\t\t\t\t\t\t\t\t<Typography style={{ flex: 1, padding: 10 }}>{message.title}</Typography>\n\t\t\t\t\t\t\t\t\t\t\t<Button style={{ padding: 10 }} onClick={() => updateFirestoreStatus(message.id)} size=\"small\">скрыть</Button>\n\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t)) : <Typography className={classes.message} align=\"center\" style={{ padding: 10 }}>Нет новых уведомлений</Typography>}\n\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t</Menu>\n\t\t\t\t\t\t</div>}\n\t\t\t\t\t{currentUser\n\t\t\t\t\t\t?\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<span style={{color: 'black', fontSize: 12, marginLeft: 7}}>\n\t\t\t\t\t\t\t\t{currentUser.email}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<Button style={{borderColor: \"black\", color: 'black', marginLeft: 10, fontSize: 12}}\n\t\t\t\t\t\t\t\t\tvariant=\"outlined\" size=\"small\"\n\t\t\t\t\t\t\t\t\tonClick={() => firebase.auth().signOut()}>\n\t\t\t\t\t\t\t\tВыход\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t: <Button style={{ borderColor: \"black\", color: 'black', marginLeft: 10, fontSize: 12 }} size=\"small\" variant=\"outlined\" onClick={signInWithGoogle}>вход</Button>\n\t\t\t\t\t}\n\t\t\t\t</Toolbar>\n\t\t\t</AppBar>\n\t\t\t<nav className={classes.drawer} aria-label=\"mailbox folders\">\n\t\t\t\t{/* The implementation can be swapped with js to avoid SEO duplication of links. */}\n\t\t\t\t<Hidden smUp implementation=\"css\">\n\t\t\t\t\t<Drawer\n\t\t\t\t\t\tcontainer={container}\n\t\t\t\t\t\tvariant=\"temporary\"\n\t\t\t\t\t\tanchor={theme.direction === 'rtl' ? 'right' : 'left'}\n\t\t\t\t\t\topen={mobileOpen}\n\t\t\t\t\t\tonClose={handleDrawerToggle}\n\t\t\t\t\t\tclasses={{\n\t\t\t\t\t\t\tpaper: classes.drawerPaper,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tModalProps={{\n\t\t\t\t\t\t\tkeepMounted: true, // Better open performance on mobile.\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{drawer}\n\t\t\t\t\t</Drawer>\n\t\t\t\t</Hidden>\n\t\t\t\t<Hidden xsDown implementation=\"css\">\n\t\t\t\t\t<Drawer\n\t\t\t\t\t\tclasses={{\n\t\t\t\t\t\t\tpaper: classes.drawerPaper,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"permanent\"\n\t\t\t\t\t\topen\n\t\t\t\t\t>\n\t\t\t\t\t\t{drawer}\n\t\t\t\t\t</Drawer>\n\t\t\t\t</Hidden>\n\t\t\t</nav>\n\t\t\t<main className={classes.content}>\n\t\t\t\t<div className={classes.toolbar} />\n\t\t\t\t{props.children}\n\t\t\t</main>\n\t\t</div>\n\t);\n}\n\nResponsiveDrawer.propTypes = {\n\t/**\n\t * Injected by the documentation to work in an iframe.\n\t * You won't need it on your project.\n\t */\n\twindow: PropTypes.func,\n};\n\nexport default ResponsiveDrawer;\n","import React, { useState } from 'react';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport TextField from '@material-ui/core/TextField';\n\n\nconst Feedback = (props) => {\n\n    const [value, setValue] = useState(null)\n    const [textValue, setTextValue] = useState('')\n    const { returnAnswer } = props\n\n    const handleChange = (event) => {\n        setValue(event.target.value)\n        returnAnswer({reason: event.target.value, text: textValue})\n    };\n\n    const handleTextChange = (event) => {\n        setTextValue(event.target.value)\n        returnAnswer({reason: value, text: event.target.value})\n    }\n\n\n\n    return (\n        <div>\n            <h4>{props.title}</h4>\n            <FormControl const='fieldset' style={{paddingBottom: 15}}>\n                <RadioGroup aria-label={props.title} name={props.title} value={value} onChange={handleChange}>\n                    {props.answers.map((el, i) => <FormControlLabel\n                        key={i}\n                        value={el}\n                        control={<Radio color=\"primary\" />}\n                        label={el}\n                        disabled={props.locked ? true : false} />)}\n                </RadioGroup>\n            </FormControl>\n            <TextField\n                id={\"feedback_input\"}\n                label=\"Примечание\"\n                value={textValue}\n                onChange={handleTextChange}\n                // required={required}\n                multiline\n                rows={5}\n                variant=\"outlined\"\n                fullWidth\n            />\n        </div>\n    )\n}\n\nexport default Feedback","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Typography from '@material-ui/core/Typography';\n\nimport Feedback from '../form/feedback'\n\n\nexport default function AlertDialog(props) {\n\n  return (\n    <div>\n      <Dialog\n        open={props.state}\n        onClose={props.handleClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">{props.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            <Typography>{props.description}</Typography>\n            <Feedback answers={props.answers} returnAnswer={props.returnFeedback} />\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={props.handleClose} color=\"primary\">\n            Отмена\n          </Button>\n          <Button onClick={props.dialogFunction} disabled={!props.feedbackValue.reason} color=\"primary\" autoFocus>\n            Подтвердить\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, {useState} from 'react'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Box from '@material-ui/core/Box'\nimport Typography from '@material-ui/core/Typography'\n\nconst LinearProgressWithLabel = (props) => {\n    return (\n      <Box display=\"flex\" alignItems=\"center\">\n        <Box width=\"100%\" mr={1}>\n          <LinearProgress variant=\"determinate\" {...props} />\n        </Box>\n        <Box minWidth={35}>\n          <Typography variant=\"body2\" color=\"textSecondary\">{`${Math.round(\n            props.value,\n          )}%`}</Typography>\n        </Box>\n      </Box>\n    );\n  }\n\nexport default LinearProgressWithLabel","import React, { useContext, useEffect, useRef, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography, IconButton, Box, Button, Snackbar } from '@material-ui/core';\nimport FeedbackIcon from '@material-ui/icons/Feedback';\nimport FeedbackDialog from '../Dialog/FeedbackDialog'\nimport Feedback from './feedback'\n\nimport firebase from '../../util/Firebase'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        '& > *': {\n            width: '40ch',\n        },\n    },\n\n}));\n\n\nconst File = (props) => {\n    const classes = useStyles();\n    const [value, setValue] = React.useState('');\n    const [dialogOpen, setDialogOpen] = useState(false)\n    const [feedbackValue, setFeedback] = useState({})\n    const [feedbackFormData, setFormData] = useState({})\n    const [showFeedback, setShowFeedback] = useState(false)\n\n    const { returnFile, locked, id, feedbackType, askFeedback, saveQuestionFeedback, prevTaskId } = props\n\n    useEffect(() => {\n        console.log(feedbackType)\n        if (feedbackType && askFeedback) {\n            console.log(feedbackType)\n            firebase.firestore().collection('schema').doc('structure').collection('feedbacks').doc(feedbackType).get().then(doc => {\n                setFormData(doc.data())\n            })\n            setShowFeedback(true)\n        }\n        else {\n            setShowFeedback(false)\n        }\n    }, [feedbackType])\n\n    const handleChange = (event) => {\n        returnFile(event.target.files, id)\n    };\n\n    const sendFeedback = () => {\n        saveQuestionFeedback(feedbackValue, id, prevTaskId)\n        handleDialogClose()\n    }\n\n    const returnFeedback = (value) => {\n        setFeedback(value)\n    }\n\n\n    const handleDialogClose = () => {\n        setDialogOpen(false)\n    }\n\n    return (\n        <div>\n            {/* <FeedbackDialog\n                title={feedbackFormData.title}\n                dialogFunction={sendFeedback}\n                state={dialogOpen}\n                handleClose={handleDialogClose}\n                feedbackValue={feedbackValue}\n                answers={feedbackFormData.answers}\n                description={feedbackFormData.description}\n                returnFeedback={returnFeedback}\n            />\n            <Box display=\"flex\" style={{ marginBottom: 10, marginTop: 20 }}>\n                <Typography variant=\"h6\" style={{ paddingRight: 8 }}>{props.title}</Typography>\n                {showFeedback && <IconButton size=\"small\" onClick={() => setDialogOpen(true)}><FeedbackIcon color=\"primary\" /></IconButton>}\n            </Box> */}\n            <input\n                    type=\"file\"\n                    onChange={handleChange}\n                    multiple\n                />\n        </div>\n    );\n}\n\nexport default File","import React, { forwardRef, useEffect, useRef, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography, IconButton, Box } from '@material-ui/core';\nimport FeedbackIcon from '@material-ui/icons/Feedback';\nimport FeedbackDialog from '../Dialog/FeedbackDialog'\nimport Feedback from './feedback'\nimport FirebaseFileUploader from './FirebaseFileUploader'\nimport File from './file'\n\nimport firebase from '../../util/Firebase'\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {\n\t\t'& > *': {\n\t\t\twidth: '40ch',\n\t\t},\n\t},\n\n}));\n\n\nconst BasicTextFields = forwardRef((props, ref) => {\n\tconst classes = useStyles();\n\tconst [value, setValue] = React.useState('');\n\tconst [dialogOpen, setDialogOpen] = useState(false)\n\tconst [answer, setAnswer] = useState(null)\n\tconst [feedbackValue, setFeedback] = useState({})\n\tconst [feedbackFormData, setFormData] = useState({})\n\tconst [showFeedback, setShowFeedback] = useState(false)\n\n\tconst { index, response, returnFile, locked, id, feedbackType, askFeedback, saveQuestionFeedback, prevTaskId, uploadFilesData, attachMaterials } = props\n\n\tuseEffect(() => {\n\t\tif (response) {\n\t\t\tsetValue(response)\n\t\t}\n\t}, [response])\n\n\tuseEffect(() => {\n\t\tif (feedbackType && askFeedback) {\n\t\t\tconsole.log(feedbackType)\n\t\t\tfirebase.firestore().collection('schema').doc('structure').collection('feedbacks').doc(feedbackType).get().then(doc => {\n\t\t\t\tsetFormData(doc.data())\n\t\t\t})\n\t\t\tsetShowFeedback(true)\n\t\t}\n\t\telse {\n\t\t\tsetShowFeedback(false)\n\t\t}\n\t}, [feedbackType])\n\n\tconst handleChange = (event) => {\n\t\tsetValue(event.target.value)\n\t\tprops.returnAnswer(event.target.value, props.index)\n\t};\n\n\tconst sendFeedback = () => {\n\t\tsaveQuestionFeedback(feedbackValue, id, prevTaskId)\n\t\thandleDialogClose()\n\t}\n\n\tconst returnFeedback = (value) => {\n\t\tsetFeedback(value)\n\t}\n\n\n\tconst handleDialogClose = () => {\n\t\tsetDialogOpen(false)\n\t}\n\n\tconst handleFilesUpload = (filename, downloadURL) => {\n\t\tuploadFilesData(filename, downloadURL, id)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<FeedbackDialog\n\t\t\t\ttitle={feedbackFormData.title}\n\t\t\t\tdialogFunction={sendFeedback}\n\t\t\t\tstate={dialogOpen}\n\t\t\t\thandleClose={handleDialogClose}\n\t\t\t\tfeedbackValue={feedbackValue}\n\t\t\t\tanswers={feedbackFormData.answers}\n\t\t\t\tdescription={feedbackFormData.description}\n\t\t\t\treturnFeedback={returnFeedback}\n\t\t\t/>\n\t\t\t<Box display=\"flex\" style={{ marginBottom: 10, marginTop: 20 }}>\n\t\t\t\t<Typography variant=\"h6\" style={{ paddingRight: 8 }}>{props.title}</Typography>\n\t\t\t\t{showFeedback && <IconButton size=\"small\" onClick={() => setDialogOpen(true)}><FeedbackIcon color=\"primary\" /></IconButton>}\n\t\t\t</Box>\n\t\t\t<TextField\n\t\t\t\tid={\"inputBox\" + index}\n\t\t\t\tlabel=\"Мой ответ\"\n\t\t\t\tvalue={value}\n\t\t\t\tonChange={handleChange}\n\t\t\t\t// required={required}\n\t\t\t\tmultiline\n\t\t\t\trows={5}\n\t\t\t\tdisabled={locked}\n\t\t\t\tvariant=\"outlined\"\n\t\t\t\tfullWidth\n\t\t\t/>\n\t\t\t{!locked && attachMaterials && <File returnFile={returnFile} locked={locked} id={id} />}\n\t\t\t{/* <FirebaseFileUploader\n                ref={ref}\n                title={\"\"}\n                index={index}\n                uploadFilesData={handleFilesUpload}\n            /> */}\n\t\t</div>\n\t);\n})\n\nexport default BasicTextFields","import React, { useEffect } from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport { Typography } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme) => ({\n\tformControl: {\n\t\tminWidth: 100,\n\t\tmaxWidth: 300\n\t},\n}));\n\nexport default function SelectBox(props) {\n\tconst classes = useStyles();\n\tconst [value, setValue] = React.useState('');\n\tconst [open, setOpen] = React.useState(false);\n\n\tconst {index, response, required, locked } = props\n\n\tuseEffect(() => {\n\t\tif (response) {\n\t\t\t// console.log(props.answers[response])\n\t\t\t// setValue(props.answers[response])\n\t\t\tsetValue(response)\n\t\t}\n\t}, [response])\n\n\tconst handleChange = (event) => {\n\t\tsetValue(event.target.value);\n\t\tlet id = props.answers.indexOf(event.target.value)\n\t\tprops.returnAnswer(event.target.value, index)\n\t};\n\n\tconst handleClose = (event) => {\n\t\tsetOpen(false)\n\t};\n\n\tconst handleOpen = (event) => {\n\t\tsetOpen(true)\n\t}\n\n\treturn (\n\t\t<div>\n\t\t\t<Typography variant=\"h6\" style={{marginBottom: 5, marginTop: 20}}>{props.title}</Typography>\n\t\t\t<FormControl className={classes.formControl} disabled={locked}>\n\t\t\t\t<InputLabel id=\"controlled-open-select-label\">Выбрать</InputLabel>\n\t\t\t\t<Select\n\t\t\t\t\tlabelId=\"controlled-open-select-label\"\n\t\t\t\t\tid={\"select\" + index}\n\t\t\t\t\topen={open}\n\t\t\t\t\tonClose={handleClose}\n\t\t\t\t\tonOpen={handleOpen}\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={handleChange}>\n\t\t\t\t\t<MenuItem value={\"\"}><em>None</em></MenuItem>\n\t\t\t\t\t{props.answers.map((el, i) => <MenuItem key={i} value={el}>{el}</MenuItem>)}\n\t\t\t\t</Select>\n\t\t\t</FormControl>\n\t\t</div>\n\t)\n\n}","import React, { useEffect } from 'react';\nimport Radio from '@material-ui/core/Radio';\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\n\nexport default function RadioButton(props) {\n\tconst [value, setValue] = React.useState('');\n\tconst {index, response} = props\n\n\tuseEffect(() => {\n\t\tif (response) {\n\t\t\tsetValue(response)\n\t\t}\n\t}, [response])\n\n\tconst handleChange = (event) => {\n\t\tsetValue(event.target.value)\n\t\tlet id = props.answers.indexOf(event.target.value)\n\t\tprops.returnAnswer(event.target.value, index, id)\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<h4>{props.title}</h4>\n\t\t\t<FormControl const='fieldset'>\n\t\t\t\t<RadioGroup aria-label={props.title} name={props.title} value={value} onChange={handleChange}>\n\t\t\t\t\t{props.answers.map((el, i) => <FormControlLabel \n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={i} \n\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={el} \n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol={<Radio color=\"primary\" />} \n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel={el} \n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={props.locked ? true : false} />)}\n\t\t\t\t</RadioGroup>\n\t\t\t</FormControl>\n\t\t</div>\n\t)\n\t\t;\n}","import React, { useEffect } from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\n\nconst useStyles = makeStyles((theme) => ({\n\tcontainer: {\n\t\tdisplay: 'flex',\n\t\tflexWrap: 'wrap',\n\t},\n\ttextField: {\n\t\tmarginLeft: theme.spacing(1),\n\t\tmarginRight: theme.spacing(1),\n\t\twidth: 'auto',\n\t},\n}));\n\nexport default function TimePickers(props) {\n\tconst classes = useStyles();\n\tconst [value, setValue] = React.useState('');\n\tconst {index, response} = props\n\n\tuseEffect(() => {\n\t\tif (response) {\n\t\t\tsetValue(response)\n\t\t}\n\t}, [index, response])\n\n\tconst handleChange = (event) => {\n\t\tsetValue(event.target.value)\n\t\tprops.returnAnswer(event.target.value, index, event.target.value)\n\t};\n\n\n\treturn (\n\t\t<div>\n\t\t\t<h4>{props.title}</h4>\n\t\t\t<form className={classes.container} noValidate>\n\t\t\t\t<TextField\n\t\t\t\t\tid={\"time\" + index}\n\t\t\t\t\tlabel=\"Время\"\n\t\t\t\t\ttype=\"time\"\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\tclassName={classes.textField}\n\t\t\t\t\tInputLabelProps={{\n\t\t\t\t\t\tshrink: true,\n\t\t\t\t\t}}\n\t\t\t\t\tInputProps={{disableUnderline: true}}\n\t\t\t\t\tdisabled={props.locked ? true : false}\n\t\t\t\t/>\n\t\t\t</form>\n\t\t</div>\n\t);\n}","import React, {useEffect, useState} from 'react';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport { Typography } from '@material-ui/core';\n\n\nexport default function CheckboxesGroup(props) {\n    const [state, setState] = React.useState({});\n    const [ready, setReady] = useState(false)\n    const {index, answers, required, response, locked} = props\n\n    useEffect(() => {\n\t\tif (response) {\n            setState(response)\n            let a = {}\n            answers.forEach((answer, i) => {\n                if (response[answer]) {\n                    a[answer] = response[answer]\n                }\n                else {\n                    a[answer] = false\n                }\n            })\n            setState(a)\n            props.returnAnswer(a, index)\n        }\n        else {\n            let a = {}\n            answers.forEach((answer, i) => a[answer] = false)\n            props.returnAnswer(a, index)\n            \n        }\n        setReady(true)\n        console.log(state)\n    }, [response, answers])\n\n\n    const handleChange = (event) => {\n        setState({ ...state, [event.target.name]: event.target.checked });\n        props.returnAnswer({...state, [event.target.name]: event.target.checked}, index)\n    };\n\n    return (\n        ready ?\n        <div>\n            <Typography variant=\"h6\" style={{marginBottom: 0, marginTop: 20}}>{props.title}</Typography>\n            <FormControl component=\"fieldset\" disabled={locked}>\n                <FormLabel component=\"legend\">Выберите один или несколько вариантов</FormLabel>\n                <FormGroup>\n                    {answers.map((el, i) => (\n                        <FormControlLabel\n                            key={i}\n                            control={<Checkbox checked={state[el]} onChange={handleChange} name={el} />}\n                            label={el}\n                        />\n                    ))}\n                </FormGroup>\n            </FormControl>\n        </div> : null\n    );\n}\n","import React, { useState, useEffect, useContext } from 'react'\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\n\nimport TextInput from \"../form/textInput\";\nimport SelectBox from \"../form/selectBox\";\nimport RadioButton from \"../form/radiobutton\";\nimport TimePickers from \"../form/timePickers\";\nimport Checkbox from \"../form/checkbox\"\nimport { Button, Grid, Typography } from '@material-ui/core';\nimport { Redirect } from 'react-router';\n\n\nconst Profile = () => {\n    const [questions, setQuestions] = useState([])\n    const [answers, setAnswers] = useState({})\n    const [forms, setForms] = useState([])\n    const [uploaded, setUploaded] = useState(false)\n    const [redirect, setRedirect] = useState(false)\n    const [userData, setUserData] = useState({})\n\n    const { currentUser } = useContext(AuthContext);\n\n    useEffect(() => {\n        let user = {}\n        if (currentUser) {\n            firebase.firestore().collection(\"users\").doc(currentUser.uid).get().then(doc => {\n                setUserData(doc.data())\n                user = doc.data()\n            }).then(() => {\n                firebase.firestore().collection(\"profileTemplate\").doc(\"Template\").get().then(doc => {\n                    console.log(JSON.stringify(doc.data()))\n                    setQuestions(doc.data().questions)\n                    console.log(doc.data().questions)\n                    const forms = doc.data().questions.map((el, i) => {\n                        let response = null\n                        if (user[el.key]) {\n                            console.log(user[el.key])\n                            response = user[el.key]\n                        }\n                        if (el.type === 'input') {\n                            return <TextInput key={\"profile_\" + i} index={i} title={el.question} response={response} returnAnswer={returnAnswer} required={el.required} />\n                        }\n                        else if (el.type === 'select') {\n                            return <SelectBox key={\"profile_\" + i} index={i} title={el.question} response={response} answers={el.answers} returnAnswer={returnAnswer} required={el.required} />\n                        }\n                        else if (el.type === 'radio') {\n                            return <RadioButton key={\"profile_\" + i} index={i} title={el.question} response={response} answers={el.answers} returnAnswer={returnAnswer} required={el.required} />\n                        }\n                        else if (el.type === 'time') {\n                            return <TimePickers key={\"profile_\" + i} index={i} title={el.question} response={response} returnAnswer={returnAnswer} required={el.required} />\n                        }\n                        else if (el.type === 'checkbox') {\n                            return <Checkbox key={\"profile_\" + i} index={i} title={el.question} response={response} answers={el.answers} returnAnswer={returnAnswer} required={el.required} />\n                        }\n                        else {\n                            return null\n                        }\n                    })\n                    setForms(forms)\n                })\n            })\n        }\n    }, [currentUser])\n\n\n    const returnAnswer = (answer, index) => {\n        const tmp = answers\n        tmp[index] = answer\n        setAnswers(tmp)\n        console.log(answers)\n    }\n\n    const saveToFirebase = () => {\n        let mergedAnswers = {}\n        questions.forEach((q, i) => {\n            if (answers[i]) {\n                mergedAnswers[q.key] = answers[i]\n            }\n        })\n\n        firebase.firestore().collection(\"users\").doc(currentUser.uid).update({\n            // profileAnswers: answers,\n            ...mergedAnswers\n        }).then(() => setUploaded(true))\n    }\n\n    // const addCaseId = () => {\n    //     firebase.firestore().collection(\"tasks\").where(\"type\", \"==\", \"Поиск контактных данных\").get().then(snap => {\n    //         snap.forEach( async doc => {\n    //             await firebase.firestore().collection(\"tasks\").doc(doc.id).update({case_id: doc.id})\n    //             console.log(doc.id)\n    //         })\n    //     })\n    // }\n\n    return (\n        currentUser ?\n            <Grid style={{ padding: 30 }}>\n                {redirect && <Redirect to=\"/\" />}\n                {forms}\n                <Grid container style={{ padding: 20 }} justify=\"center\">\n                    <Button variant=\"outlined\" style={{ borderWidth: 2, borderColor: \"#003366\", color: '#003366', margin: 10 }} onClick={saveToFirebase}>Отправить</Button>\n                    {uploaded && <Button variant=\"outlined\" style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 10 }} onClick={() => setRedirect(true)} >На главную</Button>}\n                </Grid>\n\n            </Grid>\n            :\n            <Grid container direction=\"column\" style={{ padding: 20 }} justify=\"center\">\n                <Typography align=\"center\" variant=\"h3\">авторизируйтесь</Typography>\n                <br />\n                <Button variant=\"contained\" onClick={signInWithGoogle}>Войти с помощью аккаунта Google</Button>\n            </Grid>\n    )\n\n}\n\nexport default Profile","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { Redirect } from 'react-router';\nimport { Box, Grid } from '@material-ui/core';\n\nconst useStyles = makeStyles({\n\troot: {\n\t\tminWidth: 250\n\t},\n\tbullet: {\n\t\tdisplay: 'inline-block',\n\t\tmargin: '0 2px',\n\t},\n\ttitle: {\n\t\tfontSize: 14,\n\t},\n\tpos: {\n\t\tmarginBottom: 12,\n\t},\n});\n\nconst TaskCard = (props) => {\n\tconst classes = useStyles();\n\tconst { title, complete, type, language, description, id, cardColor, sendRequest, disabled } = props\n\n\tconst [redirect, setRedirect] = useState(false)\n\n\treturn (\n\t\t<div>\n\t\t\t{redirect && <Redirect to={\"/tasks/\" + id} />}\n\t\t\t<Card className={classes.root} style={{ background: cardColor }}>\n\t\t\t\t<CardContent>\n\t\t\t\t\t<Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n\t\t\t\t\t\t<Typography variant=\"h6\">\n\t\t\t\t\t\t\t{title}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t{complete && <Typography color=\"error\">\n\t\t\t\t\t\t\tСдано\n\t\t\t\t\t\t</Typography>}\n\t\t\t\t\t</Box>\n\t\t\t\t\t<Typography variant=\"subtitle1\" className={classes.pos} color=\"textSecondary\">\n\t\t\t\t\t\t#{type}\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<Typography variant=\"body2\" component=\"p\">\n\t\t\t\t\t\tЗадание: {description}\n\t\t\t\t\t</Typography>\n\t\t\t\t</CardContent>\n\t\t\t\t<CardActions>\n\t\t\t\t\t{sendRequest ?\n\t\t\t\t\t\t<Button variant=\"contained\" disabled={disabled} color=\"primary\" size=\"small\" onClick={() => sendRequest(type, id)}>{\"Получить задание\"}</Button>\n\t\t\t\t\t\t:\n\t\t\t\t\t\t<Button size=\"small\" onClick={() => setRedirect(true)}>{\"Открыть\"}</Button>\n\t\t\t\t\t}\n\t\t\t\t</CardActions>\n\t\t\t</Card>\n\t\t</div>\n\t);\n}\n\nexport default TaskCard","import React, {useState, useEffect, useContext} from 'react'\nimport firebase, {signInWithGoogle} from '../../util/Firebase'\nimport {AuthContext} from \"../../util/Auth\";\nimport {Grid, Typography} from '@material-ui/core';\nimport {makeStyles} from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Box from '@material-ui/core/Box';\nimport TaskCard from './Card'\nimport PropTypes from 'prop-types';\n\nfunction TabPanel(props) {\n    const {children, value, index, ...other} = props;\n\n    return (\n        <div\n            role=\"tabpanel\"\n            hidden={value !== index}\n            id={`full-width-tabpanel-${index}`}\n            aria-labelledby={`full-width-tab-${index}`}\n            {...other}\n        >\n            {value === index && (\n                <Box p={3}>\n                    <Typography>{children}</Typography>\n                </Box>\n            )}\n        </div>\n    );\n}\n\nTabPanel.propTypes = {\n    children: PropTypes.node,\n    index: PropTypes.any.isRequired,\n    value: PropTypes.any.isRequired,\n};\n\nfunction a11yProps(index) {\n    return {\n        id: `full-width-tab-${index}`,\n        'aria-controls': `full-width-tabpanel-${index}`,\n    };\n}\n\n\nconst useStyles = makeStyles({\n    root: {\n        paddingTop: 30,\n        flexGrow: 1\n    },\n});\n\n\nconst Tasks = (props) => {\n    const classes = useStyles()\n    const [allTasks, setTasks] = useState(null)\n    const [submittedTasks, setSubmitted] = useState(null)\n    const [quickTasks, setQuickTasks] = useState(null)\n    const {currentUser} = useContext(AuthContext);\n    const [value, setValue] = useState(0)\n\n    useEffect(() => {\n        if (currentUser) {\n            let tasks = []\n            let submitted = []\n            console.log(\"Fired\")\n            firebase.firestore().collection(\"tasks\").where(\"assigned_users\", \"array-contains\", currentUser.uid).get()\n                .then((querySnapshot) => {\n                    querySnapshot.forEach((doc) => {\n                        console.log(doc.id, \" => \", doc.data());\n                        if (doc.data().is_complete) {\n                            submitted.push({id: doc.id, ...doc.data()})\n                        } else {\n                            tasks.push({id: doc.id, ...doc.data()})\n                        }\n\n                    });\n                })\n                .then(() => {\n                    setTasks(tasks)\n                    setSubmitted(submitted)\n                })\n                .catch((error) => {\n                    console.log(\"Error getting documents: \", error);\n                });\n        }\n    }, [currentUser])\n    const handleChange = (event, newValue) => {\n        setValue(newValue);\n    };\n\n    return (\n        <Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\n            {/* <Grid>\n\t\t\t\t<Button onClick={requestTask}>Получить задание</Button>\n\t\t\t</Grid> */}\n\n            {/*<Typography variant=\"h4\">Задания</Typography>*/}\n            <div className={classes.root}>\n                <Paper position=\"static\" color=\"default\">\n                    <Tabs value={value} onChange={handleChange} variant=\"fullWidth\" centered\n                          aria-label=\"simple tabs example\">\n                        <Tab label=\"Невыполненные\" {...a11yProps(0)}/>\n                        <Tab label=\"Выполненные\" {...a11yProps(1)}/>\n                        {/*<Tab label=\"Быстрые задания\" {...a11yProps(3)}/>*/}\n                    </Tabs>\n                </Paper>\n            </div>\n            <TabPanel value={value} index={0}>\n                {allTasks && allTasks.map((task, i) => (\n                    <Grid key={'active_task_' + i} style={{padding: 10}}>\n                        <TaskCard title={task.title} complete={task.is_complete} description={task.description}\n                                  type={task.type} id={task.id}/>\n                    </Grid>\n                ))}\n            </TabPanel>\n\n            <TabPanel value={value} index={1}>\n                {submittedTasks && submittedTasks.map((task, i) => (\n                    <Grid key={'submitted_task_' + i} style={{padding: 10}}>\n                        <TaskCard title={task.title} complete={task.is_complete} description={task.description}\n                                  type={task.type} id={task.id}/>\n                    </Grid>\n                ))}\n            </TabPanel>\n           {/* <TabPanel value={value} index={2}>\n                быстрые задания\n            </TabPanel>*/}\n        </Grid>\n    )\n}\n\nexport default Tasks","import React, { useEffect } from 'react';\nimport { Typography } from '@material-ui/core';\n\n\n\nfunction BasicTextFields(props) {\n\n\tconst {title} = props\n\n\treturn (\n\t\t<div>\n\t\t\t<Typography variant=\"h6\" style={{marginBottom: 0, marginTop: 20}}>{title}</Typography>\n\t\t</div>\n\t);\n}\n\nexport default BasicTextFields","import React, { forwardRef } from 'react'\n\nimport TextInput from \"./textInput\";\nimport SelectBox from \"./selectBox\";\nimport RadioButton from \"./radiobutton\";\nimport TimePickers from \"./timePickers\";\nimport Checkbox from \"./checkbox\"\nimport Text from \"./text\"\nimport File from \"./file\"\n\nconst Form = forwardRef((props, ref) => {\n\n    const { question, index, response, uploadsRef, returnAnswer, locked, askFeedback, saveQuestionFeedback, id, prevTaskId, returnFile, uploadFilesData } = props\n\n    if (question.type === 'input') {\n        return <TextInput\n            key={index}\n            // ref={ref}\n            index={index}\n            title={question.title}\n            response={response}\n            returnAnswer={returnAnswer}\n            required={question.required}\n            locked={locked}\n            askFeedback={askFeedback}\n            feedbackType={question.feedback_type}\n            saveQuestionFeedback={saveQuestionFeedback}\n            id={id}\n            prevTaskId={prevTaskId}\n            uploadFilesData={uploadFilesData}\n            uploadsRef={uploadsRef}\n            returnFile={returnFile}\n            attachMaterials={question.attachMaterials}\n        />\n    }\n    else if (question.type === 'select') {\n        return <SelectBox key={index} index={index} title={question.title} response={response} answers={question.answers} returnAnswer={returnAnswer} required={question.required} locked={locked} />\n    }\n    else if (question.type === 'radio') {\n        return <RadioButton key={index} index={index} title={question.title} response={response} answers={question.answers} returnAnswer={returnAnswer} required={question.required} locked={locked} />\n    }\n    else if (question.type === 'time') {\n        return <TimePickers key={index} index={index} title={question.title} response={response} returnAnswer={returnAnswer} required={question.required} locked={locked} />\n    }\n    else if (question.type === 'checkbox') {\n        return <Checkbox key={index} index={index} title={question.title} response={response} answers={question.answers} returnAnswer={returnAnswer} required={question.required} locked={locked} />\n    }\n    else if (question.type === 'text') {\n        return <Text key={index} title={question.title} />\n    }\n    else if (question.type === 'file') {\n        return <File key={index} index={index} id={id} title={question.title} returnFile={returnFile} locked={locked} askFeedback={askFeedback} feedbackType={question.feedback_type} saveQuestionFeedback={saveQuestionFeedback} prevTaskId={prevTaskId} />\n    }\n    else {\n        return null\n    }\n\n})\n\n\nexport default Form\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\nimport DialogTitle from '@material-ui/core/DialogTitle';\n\nexport default function AlertDialog(props) {\n\n  return (\n    <div>\n      <Dialog\n        open={props.state}\n        onClose={props.handleClose}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">{props.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            {props.content}\n          </DialogContentText>\n        </DialogContent>\n          {props.hideActions ? \"\" :\n              props.showOk ?\n                  <DialogActions>\n                      <Button onClick={props.handleOk} color=\"primary\">\n                          Ok\n                      </Button>\n                  </DialogActions>\n                  :\n                  <DialogActions>\n                      <Button onClick={props.handleClose} color=\"primary\">\n                          Отмена\n                      </Button>\n                      <Button onClick={props.dialogFunction} color=\"primary\" autoFocus>\n                          Подтвердить\n                      </Button>\n                  </DialogActions>}\n      </Dialog>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useContext, useRef } from 'react'\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\n\nimport Form from \"../form/form\"\nimport Dialog from \"../Dialog/Dialog\"\nimport DialogFeedback from \"../Dialog/FeedbackDialog\"\nimport Feedback from \"../form/feedback\"\n\nimport { Button, Divider, Grid, Typography } from '@material-ui/core';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nimport { Redirect, useParams } from 'react-router';\nimport { Link } from \"react-router-dom\";\n\n\nconst Tasks = () => {\n\tconst [questions, setQuestions] = useState([])\n\tconst [responses, setResponses] = useState([])\n\tconst [answers, setAnswers] = useState({})\n\tconst [forms, setForms] = useState([])\n\tconst [uploaded, setUploaded] = useState(false)\n\tconst [redirect, setRedirect] = useState(false)\n\tconst [userData, setUserData] = useState({})\n\tconst [lockButton, setLock] = useState(false)\n\tconst [caseTasks, setCaseTasks] = useState([])\n\tconst [dialogState, setDialog] = useState(false)\n\tconst [dialogType, setDialogType] = useState(null)\n\tconst [feedbackValue, setFeedback] = useState({})\n\tconst [releaseFeedbackData, setReleaseFeedbackData] = useState({})\n\tconst [openSnackbar, setOpenSnackbar] = useState(false);\n\tconst [files, setFiles] = useState({})\n\tconst [uploading, setUploading] = useState(false)\n\n\tconst { currentUser } = useContext(AuthContext);\n\tconst { id } = useParams();\n\n\tconst handleCloseSnackbar = (event, reason) => {\n\t\tif (reason === 'clickaway') {\n\t\t\treturn;\n\t\t}\n\n\t\tsetOpenSnackbar(false);\n\t};\n\n\t// const uploadsRef = useRef();\n\n\tuseEffect(() => {\n\t\tconst getQuestions = async (taskID) => {\n\t\t\tlet q = []\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(taskID).collection(\"questions\").get()\n\t\t\t\t.then((querySnapshot) => {\n\t\t\t\t\tquerySnapshot.forEach((doc) => {\n\t\t\t\t\t\tq.push({ questionId: doc.id, data: doc.data() })\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t\t\t\t});\n\n\t\t\treturn q\n\t\t}\n\n\n\t\tconst getResponses = async (taskID) => {\n\t\t\tlet r = []\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(taskID).collection(\"responses\").get()\n\t\t\t\t.then((querySnapshot) => {\n\t\t\t\t\tquerySnapshot.forEach((doc) => {\n\t\t\t\t\t\tr.push({ responseId: doc.id, data: doc.data() })\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t\t\t\t});\n\n\t\t\treturn r\n\t\t}\n\n\n\t\tconst getSameCaseTasks = async () => {\n\t\t\tlet sameCaseTasks = []\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(id).get().then(doc => {\n\t\t\t\treturn doc.data()\n\t\t\t}).then(async data => {\n\t\t\t\tawait firebase.firestore().collection(\"tasks\").where(\"case_id\", \"==\", data.case_id).get().then(snap => {\n\t\t\t\t\tsnap.forEach(doc => {\n\t\t\t\t\t\tif (doc.id !== id) {\n\t\t\t\t\t\t\tsameCaseTasks.push({ id: doc.id, ...doc.data() })\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t})\n\t\t\treturn sameCaseTasks\n\t\t}\n\n\t\tconst getForms = async () => {\n\t\t\tlet f = []\n\t\t\tlet locked = true\n\n\t\t\tsetForms(null)\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").get().then(doc => {\n\t\t\t\tif (doc.data().status === 'complete') {\n\t\t\t\t\tlocked = true\n\t\t\t\t\tsetLock(true)\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlocked = false\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tlet sq = []\n\t\t\tlet sr = []\n\n\t\t\tlet sameCaseTasks = await getSameCaseTasks()\n\t\t\tsetCaseTasks(sameCaseTasks)\n\t\t\tif (sameCaseTasks.length > 0) {\n\t\t\t\tlet ques = sameCaseTasks.map(t => {\n\t\t\t\t\treturn getQuestions(t.id)\n\t\t\t\t})\n\t\t\t\tlet resp = sameCaseTasks.map(t => {\n\t\t\t\t\treturn getResponses(t.id)\n\t\t\t\t})\n\t\t\t\tconsole.log(ques)\n\t\t\t\tawait Promise.all(ques).then(data => data.forEach(d => sq.push(...d)))\n\t\t\t\tawait Promise.all(resp).then(data => data.forEach(d => sr.push(...d)))\n\n\t\t\t\tconsole.log(sq)\n\t\t\t\tconsole.log(sr)\n\t\t\t}\n\n\t\t\tlet sf = sq.map((el, i) => {\n\t\t\t\tlet response = null\n\t\t\t\tsr.forEach((res) => {\n\t\t\t\t\tif (el.questionId === res.responseId) {\n\t\t\t\t\t\tresponse = res.data.answer\n\t\t\t\t\t\treturnAnswer(res.data.answer, i)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\treturn <Form key={el.questionId + '_' + i} question={el.data} index={i} response={response} returnAnswer={returnAnswer} locked={true} askFeedback={true} saveQuestionFeedback={saveQuestionFeedback} id={el.questionId} prevTaskId={sameCaseTasks[0].id} />\n\t\t\t})\n\n\t\t\tsf.push(<div key={\"div_divider_stripped\"} style={{ height: 25, margin: '20px 0', background: 'repeating-linear-gradient( 45deg, white, white 10px, grey 10px, grey 25px)' }}><br /></div>)\n\n\n\t\t\tlet q = await getQuestions(id)\n\t\t\tlet r = await getResponses(id)\n\n\n\t\t\tsetQuestions(q)\n\t\t\tsetResponses(r)\n\n\n\t\t\t// let newQ = sq.concat(q)\n\t\t\t// let newR = sr.concat(r)\n\n\t\t\tf = q.map((el, i) => {\n\t\t\t\tlet response = null\n\t\t\t\tr.forEach((res) => {\n\t\t\t\t\tif (el.questionId === res.responseId) {\n\t\t\t\t\t\tresponse = res.data.answer\n\t\t\t\t\t\treturnAnswer(res.data.answer, i)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\treturn (\n\t\t\t\t\t<Form\n\t\t\t\t\t\tkey={el.questionId + '_' + i}\n\t\t\t\t\t\tquestion={el.data}\n\t\t\t\t\t\tindex={i}\n\t\t\t\t\t\tresponse={response}\n\t\t\t\t\t\treturnFile={returnFile}\n\t\t\t\t\t\treturnAnswer={returnAnswer}\n\t\t\t\t\t\tid={el.questionId}\n\t\t\t\t\t\tlocked={locked}\n\t\t\t\t\t\t// ref={uploadsRef}\n\t\t\t\t\t\tuploadFilesData={uploadFilesData} />\n\t\t\t\t)\n\t\t\t})\n\n\t\t\tlet newF = sf.concat(f)\n\t\t\tsetForms(newF)\n\t\t}\n\t\tif (currentUser) {\n\t\t\tgetForms()\n\t\t}\n\t}, [currentUser, id, lockButton])\n\n\n\tconst returnAnswer = (answer, index) => {\n\t\tconst tmp = answers\n\t\ttmp[index] = answer\n\t\tsetAnswers(tmp)\n\t}\n\n\tconst returnFile = (file, questionId) => {\n\t\tlet arr = [...file]\n\t\tlet tmp = files\n\t\ttmp[questionId] = arr\n\t\tsetFiles(tmp)\n\t\tconsole.log([...file], questionId)\n\t}\n\n\tconst upload = async () => {\n\t\t// uploadsRef.current.startUpload()\n\t\tif (Object.keys(files).length > 0) {\n\t\t\tconsole.log('files')\n\t\t\tsetUploading(true)\n\t\t\tfor (const [key, value] of Object.entries(files)) {\n\t\t\t\tlet ref = firebase.storage().ref(id).child(key).child(currentUser.uid)\n\t\t\t\tawait Promise.all(value.map(async v => {\n\t\t\t\t\tlet snap = await ref.child(v.name).put(v)\n\t\t\t\t\tlet url = await snap.ref.getDownloadURL()\n\t\t\t\t\tlet url_wo_token = url.split(\"?\")[0]\n\t\t\t\t\tawait uploadFilesData(v.name, url_wo_token, key)\n\t\t\t\t}));\n\t\t\t}\n\t\t\tsetUploaded(true)\n\t\t\tsetUploading(false)\n\t\t}\n\t}\n\n\tconst saveQuestionFeedback = (data, questionId, previousTaskId) => {\n\t\tif (previousTaskId) {\n\t\t\tfirebase.firestore().collection('tasks').doc(previousTaskId).collection('feedbacks').doc(questionId).collection('messages')\n\t\t\t\t.add({\n\t\t\t\t\tanswer: data.reason,\n\t\t\t\t\ttext: data.text,\n\t\t\t\t\tuser_id: currentUser.uid,\n\t\t\t\t\ttimestamp: firebase.firestore.FieldValue.serverTimestamp()\n\t\t\t\t})\n\t\t\t\t.then(() => setOpenSnackbar(true))\n\t\t}\n\t\telse {\n\t\t\talert('Ошибка: Что-то пошло не так при сохранении фидбека. Сообщите программисту!')\n\t\t}\n\t}\n\n\tconst saveToFirebase = async (lock) => {\n\t\tawait upload()\n\t\tquestions.forEach(async (q, i) => {\n\t\t\tif (answers[i] || answers[i] === \"\") {\n\t\t\t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"responses\").doc(q.questionId).set({ answer: answers[i] }, { merge: true })\n\t\t\t}\n\t\t})\n\n\t\tif (lock) {\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'complete' })\n\t\t\tsetLock(true)\n\t\t\tconsole.log(\"Task Locked\")\n\t\t\tsetDialog(false)\n\t\t}\n\t}\n\n\tconst uploadFilesData = async (filename, url, questionId) => {\n\t\tlet rootRef = firebase.firestore().collection(\"tasks\").doc(id).collection(\"responses\").doc(questionId)\n\t\tconsole.log(\"Файл отправлен\")\n\t\tif (filename && url) {\n\t\t\trootRef.set(\n\t\t\t\t{\n\t\t\t\t\tfiles: firebase.firestore.FieldValue.arrayUnion({ public_url: url, filename: filename })\n\t\t\t\t}, { merge: true }\n\t\t\t).then(() => console.log('super'))\n\t\t}\n\t};\n\n\tconst handleDialogClose = () => {\n\t\tsetDialog(false);\n\t\tsetFeedback({})\n\t};\n\n\tconst handleDialogOpen = (type) => {\n\t\tif (type === 'send') {\n\t\t\tsetDialogType('send')\n\t\t\tsetDialog(true)\n\t\t}\n\t\tif (type === 'release') {\n\t\t\tsetDialogType('release')\n\t\t\tsetDialog(true)\n\t\t}\n\n\t}\n\n\tuseEffect(() => {\n\t\tfirebase.firestore().collection(\"schema\").doc(\"structure\").collection(\"feedbacks\").doc(\"release\").get().then(doc => {\n\t\t\tsetReleaseFeedbackData(doc.data())\n\t\t})\n\t}, [])\n\n\tconst releaseTask = () => {\n\t\tfirebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'open' })\n\t\t\t.then(() => firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'released', release_status: feedbackValue.reason, release_description: feedbackValue.text })\n\t\t\t\t.then(() => {\n\t\t\t\t\tsetDialog(false)\n\t\t\t\t\tsetLock(true)\n\t\t\t\t}))\n\t\t// alert(feedbackValue)\n\t}\n\n\tconst handleFeedbackSave = (value) => {\n\t\tsetFeedback(value)\n\t}\n\n\treturn (\n\t\tcurrentUser ?\n\t\t\t<Grid style={{ padding: 30 }}>\n\t\t\t\t{dialogType === 'send' && <Dialog\n\t\t\t\t\tstate={dialogState}\n\t\t\t\t\thandleClose={handleDialogClose}\n\t\t\t\t\thideActions={uploading || uploaded}\n\t\t\t\t\ttitle={uploading ? \"Загрузка файлов\" : uploaded ? \"Файлы загружены\" : \"Отправить задание?\"}\n\t\t\t\t\tcontent={uploading ? <CircularProgress /> : uploaded ? \"Спасибо\" : \"Вы собираетесь отправить задание. Это значит, что вы больше не сможете изменять ответы.\"}\n\t\t\t\t\tdialogFunction={() => saveToFirebase(true)} />}\n\t\t\t\t{dialogType === 'release' && <DialogFeedback\n\t\t\t\t\tstate={dialogState}\n\t\t\t\t\tfeedbackValue={feedbackValue}\n\t\t\t\t\thandleClose={handleDialogClose}\n\t\t\t\t\ttitle={releaseFeedbackData.title}\n\t\t\t\t\tdialogFunction={releaseTask}\n\t\t\t\t\tanswers={releaseFeedbackData.answers}\n\t\t\t\t\tdescription={releaseFeedbackData.description}\n\t\t\t\t\treturnFeedback={handleFeedbackSave} />}\n\t\t\t\t{redirect && <Redirect to=\"/tasks\" />}\n\t\t\t\t<Snackbar\n\t\t\t\t\tanchorOrigin={{\n\t\t\t\t\t\tvertical: 'bottom',\n\t\t\t\t\t\thorizontal: 'left',\n\t\t\t\t\t}}\n\t\t\t\t\topen={openSnackbar}\n\t\t\t\t\tautoHideDuration={6000}\n\t\t\t\t\tonClose={handleCloseSnackbar}\n\t\t\t\t\tmessage=\"Фидбек отправлен\"\n\t\t\t\t\taction={\n\t\t\t\t\t\t<React.Fragment>\n\t\t\t\t\t\t\t<IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={handleCloseSnackbar}>\n\t\t\t\t\t\t\t\t<CloseIcon fontSize=\"small\" />\n\t\t\t\t\t\t\t</IconButton>\n\t\t\t\t\t\t</React.Fragment>\n\t\t\t\t\t}\n\t\t\t\t/>\n\t\t\t\t{/* Предыдущие задания{caseTasks.map((t, i) => <Button key={\"case_button_\"+i} component={ Link } to={\"/tasks/\" + t.id}>{t.title}</Button>)} */}\n\t\t\t\t{forms}\n\t\t\t\t<Grid container style={{ padding: 20 }} justify=\"center\">\n\t\t\t\t\t<Button variant=\"outlined\" style={{ borderWidth: 2, borderColor: \"grey\", color: 'grey', margin: 5 }} onClick={() => setRedirect(true)}>Назад</Button>\n\t\t\t\t\t{!lockButton &&\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"#003366\", color: '#003366', margin: 5 }} onClick={() => saveToFirebase(false)}>Сохранить</Button>\n\t\t\t\t\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 5 }} onClick={() => handleDialogOpen('send')}>Отправить</Button>\n\t\t\t\t\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 5 }} onClick={() => handleDialogOpen('release')}>Освободить</Button>\n\t\t\t\t\t\t</div>}\n\t\t\t\t</Grid>\n\n\t\t\t</Grid>\n\t\t\t:\n\t\t\t<Grid container direction=\"column\" style={{ padding: 20 }} justify=\"center\">\n\t\t\t\t<Typography align=\"center\" variant=\"h3\">авторизируйтесь</Typography>\n\t\t\t\t<br />\n\t\t\t\t<Button variant=\"contained\" onClick={signInWithGoogle}>Войти с помощью аккаунта Google</Button>\n\t\t\t</Grid>\n\t)\n\n}\n\nexport default Tasks","import React, { useEffect, useState, useContext } from 'react'\nimport { AuthContext } from \"../../util/Auth\";\nimport firebase from '../../util/Firebase'\n\nimport Paper from '@material-ui/core/Paper'\nimport Button from '@material-ui/core/Button';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\n\nimport Card from '../Tasks/Card'\nimport { Box, Grid, Typography } from '@material-ui/core'\nimport { set } from 'immutable';\n\n\nconst Case = (props) => {\n    const { caseId, userRanks } = props\n    const [allTasks, setTasks] = useState(null)\n    const [ready, setReady] = useState(false)\n    const { currentUser } = useContext(AuthContext);\n\n    const [open, setOpen] = React.useState(false);\n    const [disableCase, setDisable] = useState(false)\n    const [message, setMessage] = useState('')\n\n    const handleClose = (event, reason) => {\n        if (reason === 'clickaway') {\n            return;\n        }\n\n        setOpen(false);\n    };\n\n    useEffect(() => {\n        if (currentUser) {\n            let tasks = []\n            console.log(\"Fired\")\n            firebase.firestore().collection(\"schema\").doc(\"structure\").collection(\"cases\").doc(caseId).collection(\"stages\").get()\n                .then((querySnapshot) => {\n                    querySnapshot.forEach((doc) => {\n                        // before change\n                        //tasks.push({ id: doc.id, ...doc.data() }) \n\n                        //after change\n                        const ranks = doc.data().ranks\n                        console.log('RANKS')\n                        console.log(ranks)\n                        console.log(userRanks)\n                        // if (ranks && userRanks.some(userRank => ranks.includes(userRank))) {\n                        //     tasks.push({ id: doc.id, ...doc.data(), disabled: false })\n                        // }\n                        // else {\n                        //     tasks.push({ id: doc.id, ...doc.data(), disabled: true })\n                        //     setMessage(<Typography color=\"error\" display=\"block\">Получите достижение <Typography component=\"span\" display=\"inline\" color=\"primary\" align=\"justify\">Первопроходец Battle For Azeroth</Typography> чтобы активировать следующее задание</Typography>)\n                        // }\n                        tasks.push({ id: doc.id, ...doc.data(), disabled: false })\n                        \n                    });\n                })\n                .then(() => {\n                    tasks.sort((a, b) => parseInt(a.order) - parseInt(b.order))\n                    setTasks(tasks)\n                    setReady(true)\n                })\n                .catch((error) => {\n                    console.log(\"Error getting documents: \", error);\n                });\n        }\n    }, [currentUser])\n\n    useEffect(() => {\n        if (currentUser) {\n            firebase.firestore().collection('tasks').where('assigned_users', 'array-contains', currentUser.uid).where('is_complete', '==', false).get().then(snap => {\n                if (snap.size < 3) {\n                    console.log(\"SIZE\", snap.size)\n                    setDisable(false)\n                }\n                else {\n                    setDisable(true)\n                    setMessage(<Typography color=\"error\">У вас есть активные задания. Сдайте или освободите их, чтобы получить новые.</Typography>)\n                }\n            })\n        }\n    }, [currentUser, disableCase, open])\n\n    const sendRequest = (type, task_type) => {\n        firebase.firestore().collection(\"task_requests\").doc(currentUser.uid).collection(\"requests\").add({\n            taskType: type,\n            status: \"pending\",\n            user: currentUser.uid,\n            case_type: caseId,\n            case_stage_id: task_type\n        }).then((doc) => {\n            setOpen(true)\n            console.log('sending request')\n        })\n    }\n\n    return (\n        <div>\n            <Snackbar\n                anchorOrigin={{\n                    vertical: 'bottom',\n                    horizontal: 'left',\n                }}\n                open={open}\n                autoHideDuration={6000}\n                onClose={handleClose}\n                message=\"Запрос отправлен\"\n                action={\n                    <React.Fragment>\n                        <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={handleClose}>\n                            <CloseIcon fontSize=\"small\" />\n                        </IconButton>\n                    </React.Fragment>\n                }\n            />\n\n            <Paper style={{ margin: '20px 5px', border: '1px grey solid' }}>\n                <Box style={{ padding: '10px 20px 0px' }}>\n                    <Box style={{ padding: '5px 10px 10px' }}>\n                        <Typography variant=\"h6\">{props.title}</Typography>\n                    </Box>\n                    <Box style={{ padding: '10px 10px 5px' }}>\n                        <Typography variant=\"body2\">{props.description}</Typography>\n                    </Box>\n                    <Box style={{ padding: '10px 10px 0px' }}>\n                        {message}\n                    </Box>\n                </Box>\n\n                <Grid container justify=\"center\" style={{ padding: 10 }}>\n                    {ready && allTasks.map((t, i) => (\n                        <Grid item key={i} style={{ padding: 10 }}>\n                            <Card title={t.title} description={t.description} type={t.type} id={t.id} cardColor=\"#F5F5F5\" sendRequest={sendRequest} disabled={disableCase || t.disabled} />\n                        </Grid>\n                    ))}\n                </Grid>\n            </Paper>\n        </div>\n    )\n}\n\nexport default Case","import React, { useState, useEffect, useContext } from 'react'\nimport firebase from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\n\nimport Case from './Case'\n\n\nconst Cases = () => {\n\n    const { currentUser } = useContext(AuthContext);\n    const [allCases, setCases] = useState([])\n    const [ready, setReady] = useState(false)\n    const [userRanks, setRanks] = useState([])\n\n    // New\n    useEffect(() => {\n        if (currentUser) {\n            firebase.firestore().collection('users').doc(currentUser.uid).collection('user_private').doc('private').get().then(doc => {\n                \n                if (doc && doc.exists) {                \n\n                    let ranks = doc.data().ranks\n                    console.log(ranks)\n                    setRanks(ranks)\n                    getCasesFromFirebase(ranks)\n                }\n            })\n        }\n    }, [currentUser])\n\n\n    // /////// Old ////////\n    // useEffect(() => {\n    //     if (currentUser) {\n    //         let cases = []\n    //         console.log(\"Fired\")\n    //         firebase.firestore().collection(\"schema\").doc(\"structure\").collection(\"cases\").get()\n    //             .then((querySnapshot) => {\n    //                 querySnapshot.forEach((doc) => {\n    //                     cases.push({ id: doc.id, ...doc.data() })\n    //                 });\n    //             })\n    //             .then(() => {\n    //                 setCases(cases)\n    //                 setReady(true)\n    //             })\n    //             .catch((error) => {\n    //                 console.log(\"Error getting documents: \", error);\n    //             });\n    //     }\n    // }, [currentUser])\n    // //////////////\n\n    const getCasesFromFirebase = (ranks) => {\n        let cases = []\n        console.log(\"Fired\")\n        firebase.firestore().collection(\"schema\").doc(\"structure\").collection(\"cases\").where('ranks', 'array-contains-any', ranks).get()\n            .then((querySnapshot) => {\n                querySnapshot.forEach((doc) => {\n                    console.log(doc.data())\n                    cases.push({ id: doc.id, ...doc.data() })\n                });\n            })\n            .then(() => {\n                setCases(cases)\n                setReady(true)\n            })\n            .catch((error) => {\n                console.log(\"Error getting documents: \", error);\n            });\n    }\n\n    return (\n        <div>\n            {ready && allCases.map((c, i) => (\n                <Case key={i} title={c.title} description={c.description} caseId={c.id} userRanks={userRanks} />\n            ))}\n        </div>\n    )\n}\n\nexport default Cases","import React, { useEffect, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { Redirect } from 'react-router';\nimport { Grid } from '@material-ui/core';\n\nconst useStyles = makeStyles(theme => ({\n\troot: {\n\t\tmargin: 20,\n\t\twidth: 500,\n\t\t[theme.breakpoints.down(\"sm\")]: {\n\t\t\tmaxWidth: 300\n\t\t}\n\t},\n\tbullet: {\n\t\tdisplay: 'inline-block',\n\t\tmargin: '0 2px',\n\t},\n\ttitle: {\n\t\tfontSize: 14,\n\t},\n\tpos: {\n\t\tmarginBottom: 12,\n\t},\n}));\n\nconst TaskCard = (props) => {\n\tconst classes = useStyles();\n\tconst { title, description, id, setShown, shown, date } = props\n\n\tconst getFormatDate = (dt) => {\n\t\t// let month = '' + (d.getMonth() + 1)\n\t\t// let day = '' + d.getDate()\n\t\t// let year = d.getFullYear()\n\n\t\t// if (month.length < 2)\n\t\t// \tmonth = '0' + month;\n\t\t// if (day.length < 2)\n\t\t// \tday = '0' + day;\n\t\tlet formatDate = `${\n\t\t\tdt.getDate().toString().padStart(2, '0')}/${\n\t\t\t(dt.getMonth()+1).toString().padStart(2, '0')}/${\n\t\t\tdt.getFullYear().toString().padStart(4, '0')} ${\n\t\t\tdt.getHours().toString().padStart(2, '0')}:${\n\t\t\tdt.getMinutes().toString().padStart(2, '0')}:${\n\t\t\tdt.getSeconds().toString().padStart(2, '0')}`\n\n\t\treturn formatDate\n\t}\n\n\treturn (\n\t\t<Grid container justify=\"center\">\n\t\t\t<Card className={classes.root} style={shown ? { background: 'grey', opacity: 0.25 } : { background: 'lightblue' }} >\n\t\t\t\t<CardContent>\n\t\t\t\t\t<Typography variant=\"h6\">\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<Typography variant=\"body2\" component=\"p\">\n\t\t\t\t\t\t{description}\n\t\t\t\t\t</Typography>\n\t\t\t\t</CardContent>\n\t\t\t\t<CardActions style={{ justifyContent: 'space-between' }}>\n\t\t\t\t\t<Typography style={{paddingLeft: 8}} variant=\"subtitle2\">{getFormatDate(date.toDate())}</Typography>\n\t\t\t\t\t<Button size=\"small\" onClick={() => setShown(id)}>{\"Просмотрено\"}</Button>\n\t\t\t\t</CardActions>\n\t\t\t</Card>\n\t\t</Grid>\n\t);\n}\n\nexport default TaskCard","import { Button, Grid, Typography } from '@material-ui/core';\nimport React, { useEffect, useState, useContext } from 'react'\nimport { AuthContext } from '../../util/Auth';\nimport firebase from '../../util/Firebase'\n\nimport Notification from './Notification'\n\n\nconst Notifications = () => {\n\n    const { currentUser } = useContext(AuthContext);\n    const [cards, setCards] = useState([])\n\n    const updateFirestoreStatus = (id) => {\n        firebase.firestore().collection('notifications').doc(id).update({ shown: true })\n    }\n\n    useEffect(() => {\n        if (currentUser) {\n            const unsubscribe = firebase.firestore().collection('notifications').where('user_id', 'array-contains', currentUser.uid).onSnapshot(async snap => {\n                let messages = []\n                snap.forEach((doc, i) => {\n                    messages.push({ id: doc.id, ...doc.data() })\n                })\n                console.log(messages[0].created_date.toDate())\n                messages.sort((a, b) => b.created_date.toDate() - a.created_date.toDate())\n                setCards(messages)\n            })\n            return () => unsubscribe()\n        }\n    }, [currentUser])\n\n    return (\n        <div>\n            <Typography variant=\"h5\" align=\"center\">Уведомления</Typography>\n            {cards.map((doc, i) => <Notification key={i} id={doc.id} index={i} date={doc.created_date} title={doc.title} setShown={updateFirestoreStatus} shown={doc.shown} description={doc.description} />)}\n        </div>\n    )\n\n}\n\nexport default Notifications","import React, { useContext, useEffect, useState } from 'react'\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\nimport moment from 'moment';\nimport { v1 as uuid } from 'uuid'\nimport { Button, Grid, Link, makeStyles, Typography } from '@material-ui/core';\n\nconst queryString = require('query-string');\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        marginTop: 20,\n        background: 'lightgreen',\n        height: 200,\n        width: 500,\n        [theme.breakpoints.down(\"sm\")]: {\n            maxWidth: 300\n        }\n    }\n}));\n\n\nconst Home = () => {\n    const classes = useStyles();\n    const [token, setToken] = useState(null)\n    const { currentUser } = useContext(AuthContext);\n\n    useEffect(() => {\n        const makeToken = () => {\n            return uuid().toString() + '_' + Date.now()\n        }\n        if (currentUser) {\n            const unsubscribe = firebase.firestore().collection('users').doc(currentUser.uid).onSnapshot(doc => {\n                let oldToken;\n                if (doc.exists && doc.data().tg_token) {\n                    oldToken = doc.data().tg_token\n                }\n                else {\n                    oldToken = false\n                }\n                \n                console.log(oldToken)\n                if (oldToken) {\n                    console.log(oldToken)\n                    let oldDate = parseInt(oldToken.substring(oldToken.indexOf('_') + 1))\n                    let date = moment().diff(oldDate, 'hours')\n                    console.log(date)\n                    if (date > 0) {\n                        let newToken = makeToken()\n                        firebase.firestore().collection('users').doc(currentUser.uid).update({ tg_token: newToken })\n                        setToken(newToken)\n                    }\n                    else {\n                        setToken(oldToken)\n                    }\n                }\n                else {\n                    console.log('no token')\n                    let newToken = makeToken()\n                    firebase.firestore().collection('users').doc(currentUser.uid).update({ tg_token: newToken })\n                    setToken(newToken)\n                }\n            })\n            return () => unsubscribe()\n        }\n    }, [currentUser])\n\n    useEffect(() => {\n        if (currentUser) {\n            let urlString = queryString.parse(window.location.search)\n            if (urlString.rank) {\n                console.log(urlString.rank)\n                firebase.firestore().collection('schema').doc('structure').collection('ranks').doc(urlString.rank).get().then(doc => {\n                    if (doc.exists) {\n                        console.log('creating request')\n                        firebase.firestore().collection('rank_requests').add({\n                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n                            user_id: currentUser.uid,\n                            processed: false,\n                            rank: doc.id\n                        })\n                    }\n                    else {\n                        console.log('no rank')\n                    }\n                })\n            }\n        }\n    }, [currentUser])\n\n    return (\n        currentUser ?\n            <Grid container justify=\"center\" direction=\"column\" alignItems=\"center\" className={classes.root} >\n                <Link variant=\"h5\" align=\"center\" href={\"https://kloopmedia.github.io/Journal/#/p/elections_monitoring\"}>ФОРМЫ ДЛЯ НАБЛЮДЕНИЯ НА ВЫБОРАХ</Link>\n            </Grid>\n            // <Grid container justify=\"center\" direction=\"column\" alignItems=\"center\" className={classes.root} >\n            //     <Typography style={{ paddingBottom: 10 }} variant=\"h5\" align=\"center\">Вы почти зарегистрировались! Осталось нажать на ссылку ниже.</Typography>\n            //     {token ? <Link variant=\"h5\" href={\"https://telegram.me/journal_tg_bot?start=\" + token}>Ссылка на бот</Link>\n            //     : <Typography variant=\"body2\" align=\"center\">Если ссылка не создалась в течение 5 секунд, перезагрузите страницу</Typography>}\n            // </Grid>\n            :\n            <Grid container direction=\"column\" style={{ padding: 20 }} justify=\"center\">\n                <Typography align=\"center\" variant=\"h3\">Регистрация</Typography>\n                <br />\n                <Button size=\"large\" color=\"primary\" variant=\"contained\" onClick={signInWithGoogle}>Войти с помощью аккаунта Google</Button>\n            </Grid>\n    )\n}\n\nexport default Home","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nconst useStyles = makeStyles({\n  root: {\n    minWidth: 275,\n  },\n  bullet: {\n    display: 'inline-block',\n    margin: '0 2px',\n    transform: 'scale(0.8)',\n  },\n  title: {\n    fontSize: 14,\n  },\n  pos: {\n    marginBottom: 12,\n  },\n});\n\nexport default function UserCard(props) {\n  const classes = useStyles();\n\n  console.log('TEST CARD')\n  console.log(props)\n\n  if(props.userInfo == {}){\n    return (<div></div>)\n  }\n\n  return (\n    <Card className={classes.root} variant=\"outlined\">\n      <CardContent>\n        <Typography className={classes.title} color=\"textSecondary\" gutterBottom>\n          id: {props.userInfo.id}\n        </Typography>\n        <Typography variant=\"h5\" component=\"h2\">\n        {props.userInfo.surname} {props.userInfo.name}\n        </Typography>\n        <Typography className={classes.pos} color=\"textSecondary\">\n          Регион: {props.userInfo.district}\n        </Typography>\n        <Typography variant=\"body2\" component=\"p\">\n          {props.userInfo.phone}\n        </Typography>\n        <Typography variant=\"body2\" component=\"p\">\n          {props.userInfo.email}\n        </Typography>\n      </CardContent>\n    </Card>\n  );\n}","import React, { useEffect, useState, useContext } from 'react';\nimport firebase from '../../util/Firebase'\n\nimport Form from '../form/form'\nimport { Button, Grid, Typography } from '@material-ui/core';\n\nimport UserCard from '../Moderator/UserCard'\n\n\nconst ModeratedTask = (props) => {\n\n\tconst [tasks, setTasks] = React.useState([]);\n\tconst [taskInfo, setTaskInfo] = useState({})  \n\t\n\tlet userInfo = {}\n\n    const [questions, setQuestions] = useState([])    \n    const [responses, setResponses] = useState([])    \n    const [answers, setAnswers] = useState({})    \n    const [forms, setForms] = useState(<div></div>)\n    \n\tconst [pending, setPending] = useState(false)\n\tconst [passed, setPassed] = useState(false)\n\tconst [notPassed, setNotPassed] = useState(false)\n\tconst [verified, setVerified] = useState(false)\n\tconst [notVerified, setNotVerified] = useState(false)\n\n\tconst getReviewStatus = async () => {\n        firebase.firestore().collection(\"tasks\").doc(props.task.id).get().then(doc => {\n\t\t\t\t\n\t\t\tlet review_status = doc.data().review_status\n\t\t\t\n\t\t\tsetPending(review_status === 'pending')\n\t\t\tsetPassed(review_status === 'passed')\n\t\t\tsetNotPassed(review_status === 'not passed')\n\t\t\tsetVerified(review_status === 'verified')\n\t\t\tsetNotVerified(review_status === 'not verified')\t\t\t\n        })\n\t}\n\t\n\tconst getUserInfo = () => {\n\n\t\tif (taskInfo.assigned_users !== undefined && taskInfo.assigned_users.length > 0){\n\t\t\n\t\t\tlet item = props.users.find(item => item.id === taskInfo.assigned_users[0])\n\t\t\tif (item !== undefined){\n\t\t\t\tuserInfo = item\n\t\t\t}\t\t\t\t\n\t\t\telse{\n\t\t\t\tuserInfo = {}\n\t\t\t}\n\t\t}\n        \n    }\n\n    useEffect(() => {\n\t\tconst getData = async () => {\n\t\t\tlet q = []\n\t\t\tlet r = []\n\t\t\tlet f = []\n\t\t\tlet locked = true\n\n\n\t\t\tconsole.log(\"HOOK\")\n\t\t\tgetReviewStatus()\t\t\n\t\t\t\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(props.task.id).get()\n\t\t\t\t.then(doc => {\t\t\t\t\n\t\t\t\t\tsetTaskInfo(doc.data())\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t\t\t\t});\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(props.task.id).collection(\"questions\").get()\n\t\t\t\t.then((querySnapshot) => {\n\t\t\t\t\tquerySnapshot.forEach((doc) => {\n\t\t\t\t\t\t// console.log(doc.id, \" => \", doc.data());\n\t\t\t\t\t\tq.push({ questionId: doc.id, data: doc.data() })\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tsetQuestions(q)\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t\t\t\t});\n\n\t\t\tawait firebase.firestore().collection(\"tasks\").doc(props.task.id).collection(\"responses\").get()\n\t\t\t\t.then((querySnapshot) => {\n\t\t\t\t\tquerySnapshot.forEach((doc) => {\n\t\t\t\t\t\t// console.log(doc.id, \" => \", doc.data());\n\t\t\t\t\t\tr.push({ responseId: doc.id, data: doc.data() })\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tsetResponses(r)\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t\t\t\t});\n\t\t\n\n\t\t\t//ЗАЛИПУХА!!!\n\t\t\tsetForms(<div></div>)\t\n\n\t\t\tf = q.map((el, i) => {\n\t\t\t\tlet response = null\n\t\t\t\t// console.log(i)\n\t\t\t\tr.forEach((res) => {\n\t\t\t\t\tif (el.questionId === res.responseId) {\n\t\t\t\t\t\tresponse = res.data.answer\n\t\t\t\t\t\treturnAnswer(res.data.answer, i)\n\t\t\t\t\t\t// console.log(res.data)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\treturn <Form key={i} question={el.data} index={i} response={response} returnAnswer={returnAnswer} locked={locked} />\n\t\t\t})\n\t\t\tsetForms(f)\n\t\t}\n\t\tif (props.task.id) {\n\t\t\tgetData()\n\t\t}\n\t}, [props.task.id])\n    \n    const returnAnswer = (answer, index) => {\n\t\tconst tmp = answers\n\t\ttmp[index] = answer\n\t\tsetAnswers(tmp)\n\t\t// console.log(answers)\n\t}\n\n\tconst handlePending = () => {\n\t\tupdateReviewStatus('pending')\n\t\tgetReviewStatus()\n\t}\n\n\tconst handlePassed = () => {\n\t\tupdateReviewStatus('passed')\n\t\tgetReviewStatus()\n\t}\n\n\tconst handleNotPassed = () => {\n\t\tupdateReviewStatus('not passed')\n\t\tgetReviewStatus()\n\t}\n\n\tconst handleVerified = () => {\n\t\tupdateReviewStatus('verified')\n\t\tgetReviewStatus()\n\t}\n\n\tconst handleNotVerified = () => {\n\t\tupdateReviewStatus('not verified')\n\t\tgetReviewStatus()\n\t}\n\t\n\tconst updateReviewStatus = async (review_status) => {\n\t\tawait firebase.firestore().collection(\"tasks\").doc(props.task.id).update({ review_status: review_status })\n\t}\n    \n    // console.log('TEST')\n    // console.log(tasks)\n\n\tgetUserInfo()\n\treturn (\n\t\t<Grid style={{ padding: 30 }}>\n\n\t\t\t<Grid container style={{ padding: 20 }} justify=\"center\">\n\t\t\t\t<Button variant=\"contained\" color={pending ? \"secondary\" : '{}'} onClick={handlePending}>\n\t\t\t\t\tPENDING\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"contained\" color={passed ? \"secondary\" : '{}'} onClick={handlePassed}>\n\t\t\t\t\tPASSED\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"contained\" color={notPassed ? \"secondary\" : '{}'} onClick={handleNotPassed}>\n\t\t\t\t\tNOT PASSED\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"contained\" color={verified ? \"secondary\" : '{}'} onClick={handleVerified}>\n\t\t\t\t\tVERIFIED\n\t\t\t\t</Button>\n\t\t\t\t<Button variant=\"contained\" color={notVerified ? \"secondary\" : '{}'} onClick={handleNotVerified}>\n\t\t\t\t\tNOT VERIFIED\n\t\t\t\t</Button>\n            </Grid>\n\n\t\t\t<Grid container justify = \"center\">\n                <UserCard userInfo={userInfo}> </UserCard>\n            </Grid>\n\n            {forms}\n            \n\n\t\t\t</Grid>\n\t);\n}\n\nexport default ModeratedTask","import React, {useState, useEffect} from 'react'\nimport ModeratedTask from './ModeratedTask'\nimport Grid from \"@material-ui/core/Grid\";\nimport TablePagination from \"@material-ui/core/TablePagination\";\nimport {List} from \"immutable\"\n\nconst rowsPP = 1;\n\nconst PaginatedTasks= props => {\n    const [page, setPage] = useState(0);\n    const [rowsPerPage, setRowsPerPage] = useState(rowsPP);\n    const [dataSlice, setDataSlice] = useState([]);\n\n    const calculateSlice = (pageNumber, rowsPage, data) => {\n        const iData = List(data)\n        const numberOfPages = Math.floor(iData.size / rowsPage);\n        console.log(\"numberOfPages\", numberOfPages);\n        const start = pageNumber * rowsPage;\n        let end = iData.size\n        if (pageNumber !== numberOfPages - 1) {\n            end = (pageNumber + 1) * rowsPage;\n        }\n        console.log(\"Start\", start);\n        console.log(\"End\", end);\n        return data.slice(start, end)\n    }\n\n    const handleChangePage = (event, newPage) => {\n        setDataSlice(calculateSlice(newPage, rowsPerPage, props.data));\n        setPage(newPage);\n    };\n    const handleChangeRowsPerPage = (event) => {\n        // setPage(0);\n        // setRowsPerPage(event.target.value);\n        // setDataSlice(calculateSlice(0, event.target.value, props.data));\n    };\n\n    useEffect(() => {\n        // Update the document title using the browser API\n        setPage(0)\n        setDataSlice(calculateSlice(0, rowsPP, props.data));\n    }, [props.data]);\n\n\n    const pagination = props.data.length > 0 && (\n        <Grid container justify = \"center\">\n        <TablePagination\n            justify=\"center\"\n            component=\"div\"\n            count={props.data.length}\n            page={page}\n            onChangePage={handleChangePage}\n            rowsPerPage={rowsPerPage}\n            onChangeRowsPerPage={handleChangeRowsPerPage}\n            labelRowsPerPage = 'По одной задаче на страницу!'\n        /></Grid>)\n\n\n    // console.log('PAGINATION')\n    // console.log(dataSlice)\n\n    const isAllowedToRenderTask = dataSlice[0] !== undefined\n    return (\n        <div>\n            {pagination}\n            <Grid\n                container\n                spacing={0}\n                direction=\"column\"\n                alignItems=\"center\"\n                justify=\"center\"\n                style={{minHeight: '100vh'}}>\n\n                <Grid item xs={12}>\n                    <Grid container justify=\"center\" direction='column' spacing={1}>\n                       \n                            {isAllowedToRenderTask\n                                ? <Grid item>\n                                    <ModeratedTask \n                                        task={dataSlice[0]}\n                                        users={props.users}                                      \n                                    ></ModeratedTask>\n                                </Grid>\n                                : 'Выберите и примените фильтры!'\n                            }\n\n\n                    </Grid>\n                </Grid>\n\n            </Grid>\n            {pagination}\n        </div>\n    )\n\n}\n\nexport default PaginatedTasks","import React, { useEffect, useState, useContext } from 'react';\nimport firebase from '../../util/Firebase'\n\nimport Form from '../form/form'\nimport { Button, Grid, Typography } from '@material-ui/core';\n\nimport PaginatedTasks from '../Moderator/PaginatedTasks'\n\nimport NativeSelect from '@material-ui/core/NativeSelect';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\n\nimport SearchIcon from '@material-ui/icons/Search';\n\nconst TasksObserver = (props) => {\n\n    // console.log('TEST FUNCT')\n    // console.log(props)\n\n    //TODO load from SCHEMA\n    const taskTypes = ['ВСЕ', 'Поиск контактных данных', 'interview']   \n\n    //TODO load from SCHEMA        \n    const taskTitles = ['ВСЕ', 'Задание № 1.1', 'Задание № 1.2', 'Задание № 1.3', 'Задание № 2.1', 'Задание № 2.2', 'Задание № 2.3', 'Задание 3.1', 'Задание 3.2', 'Задание 3.3']  \n\n    //TODO load from SCHEMA        \n    const taskReviewStatuses = ['ВСЕ', 'pending', 'passed', 'not passed', 'verified', 'not verified']\n\n    const [tasks, setTasks] = React.useState([]);\n    const [user, setUser] = React.useState('ВСЕ');\n    const [users, setUsers] = React.useState([]);\n    const [taskType, setTaskType] = React.useState(taskTypes[0]);\n    const [taskTitle, setTaskTitle] = React.useState(taskTitles[0]);\n    const [taskReviewStatus, setTaskReviewStatus] = React.useState(taskReviewStatuses[0]);\n\n    const setTaskTypeHandler = (event) => {\n        setTaskType(event.target.value); \n    };\n\n    const setTaskTitleHandler = (event) => {\n        setTaskTitle(event.target.value); \n    };\n\n    const setUserHandler = (event) => {\n        setUser(event.target.value); \n    };\n\n    const setTaskReviewStatusHandler = (event) => {\n        setTaskReviewStatus(event.target.value); \n    };    \n\n    const handleClickApplyFilters = (event) => {\n\n        getTasks()\n\n      }\n\n    \n    const getUsers = async () => {\n        let usersList = [{id: 'ВСЕ', name: 'ВСЕ', surname: ''}]\n        let usersRef = firebase.firestore().collection('users').orderBy(\"surname\")\n        await usersRef.get().then(docs => {\n            docs.forEach(doc => {\n                usersList.push({id: doc.id, ...doc.data()})\n            })\n\n            setUsers(usersList)\n        })\n    }\n\n    const getTasks = async () => {\n        let tasksList = []\n        let tasksRef = firebase.firestore().collection('tasks')\n\n        // console.log('USER ID')\n        // console.log(user)\n\n        if(user != 'ВСЕ'){\n            tasksRef = tasksRef.where(\"assigned_users\", \"array-contains\", user)\n        }\n\n        if(taskTitle != 'ВСЕ'){\n            tasksRef = tasksRef.where(\"title\", \"==\", taskTitle)\n        }\n\n        if(taskType != 'ВСЕ'){\n            tasksRef = tasksRef.where(\"type\", \"==\", taskType)\n        }\n\n        if(taskReviewStatus != 'ВСЕ'){\n            tasksRef = tasksRef.where(\"review_status\", \"==\", taskReviewStatus)\n        }\n\n        await tasksRef.get().then(docs => {\n            docs.forEach(doc => {\n                tasksList.push({id: doc.id, ...doc.data()})\n            })\n\n            setTasks(tasksList)\n        })\n    }\n\n    useEffect(() => {        \n        getUsers()        \n    }, [])   \n    \n    // console.log('USERS')\n    // console.log(users)\n\n\treturn (\n        <div>\n            <Grid container justify = \"center\">\n                <FormControl style={{width:'350px'}}>\n                <NativeSelect\n                    value={user.value}\n                    onChange={setUserHandler}\n                    name=\"filterUser\"\n                    //inputProps={{ 'aria-label': 'filterViolation' }}\n                >\n                    {\n                        users.map(userInfo => (\n                        <option value={userInfo.id}> {userInfo.surname} {userInfo.name}</option>\n                    ))\n                    }\n                </NativeSelect>\n                 <FormHelperText>Выберите фильтр по users</FormHelperText>\n                </FormControl>\n            </Grid>\n\n            <Grid container justify = \"center\">\n                <FormControl style={{width:'350px'}}>\n                <NativeSelect\n                    value={taskTitle}\n                    onChange={setTaskTitleHandler}\n                    name=\"filterTaskTitle\"\n                    //inputProps={{ 'aria-label': 'filterViolation' }}\n                >\n                    {\n                        taskTitles.map(taskTitle => (\n                        <option value={taskTitle}>{taskTitle}</option>\n                    ))\n                    }\n                </NativeSelect>\n                 <FormHelperText>Выберите фильтр по наименованию задачи</FormHelperText>\n                </FormControl>\n            </Grid>\n\n            <Grid container justify = \"center\">\n                <FormControl style={{width:'350px'}}>\n                <NativeSelect\n                    value={taskType}\n                    onChange={setTaskTypeHandler}\n                    name=\"filterTaskType\"\n                    //inputProps={{ 'aria-label': 'filterViolation' }}\n                >\n                    {\n                        taskTypes.map(taskType => (\n                        <option value={taskType}>{taskType}</option>\n                    ))\n                    }\n                </NativeSelect>\n                 <FormHelperText>Выберите фильтр по типу задачи</FormHelperText>\n                </FormControl>\n            </Grid>\n\n            <Grid container justify = \"center\">\n                <FormControl style={{width:'350px'}}>\n                <NativeSelect\n                    value={taskReviewStatus}\n                    onChange={setTaskReviewStatusHandler}\n                    name=\"filterReviewStatus\"\n                    //inputProps={{ 'aria-label': 'filterViolation' }}\n                >\n                    {\n                        taskReviewStatuses.map(taskReviewStatus => (\n                        <option value={taskReviewStatus}>{taskReviewStatus}</option>\n                    ))\n                    }\n                </NativeSelect>\n                 <FormHelperText>Выберите фильтр по review_status</FormHelperText>\n                </FormControl>\n            </Grid>\n\n            <Grid container justify = \"center\">\n                <Button\n                    style={{width:'350px'}}\n                    type ='number'\n                    variant=\"contained\"\n                    onClick={handleClickApplyFilters}\n                    color= 'primary'\n                    //className={classes.button}\n                    startIcon={<SearchIcon />}\n                >\n                    Применить фильтры\n                </Button>\n            </Grid>\n\n            <Grid container justify = \"center\">\n                <PaginatedTasks data={tasks} users={users}></PaginatedTasks>\n            </Grid>\n        </div>\n\t);\n}\n\nexport default TasksObserver","import React, { useContext } from 'react'\nimport { signInWithGoogle } from '../../util/Firebase'\nimport { Button, Grid, Typography } from '@material-ui/core'\nimport { AuthContext } from '../../util/Auth';\nimport { Redirect } from 'react-router';\n\n\nconst Signin = () => {\n    const { currentUser } = useContext(AuthContext);\n    if (currentUser) {\n        return <Redirect to={'/'} />;\n    }\n    return (\n        <Grid container direction=\"column\" style={{ padding: 20 }} justify=\"center\">\n            <Typography align=\"center\" variant=\"h4\">Регистрация</Typography>\n            <Typography variant=\"body1\" align=\"center\">Нажмите на кнопку (Вход или Регистрация).</Typography>\n            <Typography variant=\"body1\" align=\"center\">Если у вас нет аккаунта Google, то создайте его.</Typography>\n            <br />\n            <Button size=\"large\" color=\"primary\" variant=\"contained\" onClick={signInWithGoogle}>Регистрация</Button>\n        </Grid>\n    )\n}\n\nexport default Signin","import React, { useContext } from \"react\";\nimport { Route, Redirect } from \"react-router-dom\";\nimport { AuthContext } from \"./Auth\";\n\nconst PrivateRoute = ({ component: RouteComponent, ...rest }) => {\n  const {currentUser} = useContext(AuthContext);\n  return (\n    <Route\n      {...rest}\n      render={routeProps =>\n        !!currentUser ? (\n          <RouteComponent {...routeProps} />\n        ) : (\n          <Redirect to={\"/signin\"} />\n        )\n      }\n    />\n  );\n};\n\n\nexport default PrivateRoute","import React, { forwardRef, useEffect, useRef, useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { Typography, Box, Button, Grid } from '@material-ui/core';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        border: '2px grey solid',\n        padding: '0px 10px',\n        margin: 10,\n        background: 'yellow',\n\t\twidth: 700,\n        [theme.breakpoints.down(\"sm\")]: {\n            maxWidth: 300\n        }\n    },\n    button: {\n        background: 'orange',\n        margin: '10px 0'\n    }\n\n}));\n\n\nconst BasicTextFields = forwardRef((props, ref) => {\n    const classes = useStyles();\n    const [value, setValue] = React.useState('');\n\n    const { title, sendAnswer, taskId, questionId } = props\n\n    const handleChange = (event) => {\n        setValue(event.target.value)\n    };\n\n    return (\n        <div className={classes.root}>\n            <Box display=\"flex\" style={{ marginBottom: 10, marginTop: 10 }}>\n                <Typography variant=\"h6\" style={{ paddingRight: 8 }}>{title}</Typography>\n            </Box>\n            <TextField\n                label=\"Мой ответ\"\n                value={value}\n                style={{ background: 'white' }}\n                onChange={handleChange}\n                multiline\n                rows={5}\n                variant=\"outlined\"\n                fullWidth\n            />\n            <Grid container justify=\"flex-end\">\n                <Button className={classes.button} onClick={() => sendAnswer(taskId, questionId, value)}>Отправить</Button>\n            </Grid>\n\n        </div>\n    );\n})\n\nexport default BasicTextFields","import React, { useEffect, useState, useContext } from 'react';\nimport firebase from '../../util/Firebase'\n\nimport { Button, Grid, makeStyles, Typography } from '@material-ui/core';\n\nimport NativeSelect from '@material-ui/core/NativeSelect';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\n\nimport SearchIcon from '@material-ui/icons/Search';\nimport Card from './Card'\n\n\nconst useStyles = makeStyles((theme) => ({\n    select: {\n        margin: '20px 0',\n        width: 500,\n        [theme.breakpoints.down(\"sm\")]: {\n            maxWidth: 300\n        }\n    },\n\n}));\n\nconst FAQ = (props) => {\n\n    // console.log('TEST FUNCT')\n    // console.log(props)\n\n    //TODO load from SCHEMA\n    const classes = useStyles();\n    const taskTypes = ['ВСЕ', 'Поиск контактных данных', 'interview']\n\n\n    const [tasks, setTasks] = React.useState([]);\n    const [taskType, setTaskType] = React.useState(taskTypes[0]);\n    const [questions, setQuestions] = useState([])\n\n    const setTaskTypeHandler = (event) => {\n        setTaskType(event.target.value);\n    };\n\n    const handleClickApplyFilters = async (event) => {\n        let tasklist = await getTasks()\n        getQuestions(tasklist)\n    }\n\n    const getTasks = async () => {\n        let tasksList = []\n        let tasksRef = firebase.firestore().collection('tasks').where('case_type', '==', 'FAQ').where('is_complete', '==', false)\n\n        if (taskType !== 'ВСЕ') {\n            tasksRef = tasksRef.where(\"type\", \"==\", taskType)\n        }\n        console.log('fired')\n        await tasksRef.get().then(docs => {\n            docs.forEach(doc => {\n                tasksList.push({ id: doc.id, ...doc.data() })\n            })\n            tasksList.sort((a, b) => b.timestamp.toDate() - a.timestamp.toDate())\n            setTasks(tasksList)\n        })\n        return tasksList\n    }\n\n    const getQuestions = async (taskList) => {\n        let questionList = await taskList.map(async task => {\n            let arr = []\n            await firebase.firestore().collection('tasks').doc(task.id).collection('questions').get().then(snap => {\n                snap.forEach(doc => {\n                    arr.push({ taskId: task.id, questionId: doc.id, timestamp: task.timestamp.toDate(), ...doc.data() })\n                })\n            })\n            return arr\n        })\n        Promise.all(questionList).then(q => setQuestions([].concat.apply([], q)))\n    }\n\n    const sendAnswer = (taskId, questionId, answer) => {\n        firebase.firestore().collection('tasks').doc(taskId).collection('responses').doc(questionId).set({ answer: answer })\n        console.log(taskId, answer)\n    }\n\n\n    return (\n        <Grid container justify=\"center\">\n            <Grid container justify=\"center\">\n                <FormControl className={classes.select}>\n                    <NativeSelect\n                        value={taskType}\n                        onChange={setTaskTypeHandler}\n                        name=\"filterTaskType\"\n                    >\n                        {\n                            taskTypes.map((taskType, i) => (\n                                <option key={taskType} value={taskType}>{taskType}</option>\n                            ))\n                        }\n                    </NativeSelect>\n                    <FormHelperText>Выберите фильтр по типу задачи</FormHelperText>\n                </FormControl>\n            </Grid>\n\n            <Grid container justify=\"center\" className={classes.select}>\n                <Button\n                    style={{ width: '350px' }}\n                    type='number'\n                    variant=\"contained\"\n                    onClick={handleClickApplyFilters}\n                    color='primary'\n                    //className={classes.button}\n                    startIcon={<SearchIcon />}\n                >\n                    Применить фильтры\n                </Button>\n            </Grid>\n\n            <Grid container justify=\"center\">\n                {questions\n                    ? questions.map((task, i) => <Card key={'task_' + i} taskId={task.taskId} questionId={task.questionId} title={task.title} sendAnswer={sendAnswer} />)\n                    : <Typography style={{ padding: 30 }}>Нет новых вопросов</Typography>}\n            </Grid>\n        </Grid>\n    );\n}\n\nexport default FAQ","import React, { useState } from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Card from '@material-ui/core/Card';\nimport CardActions from '@material-ui/core/CardActions';\nimport CardContent from '@material-ui/core/CardContent';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\n\nimport { Redirect, useHistory } from 'react-router';\nimport { Box, Grid } from '@material-ui/core';\nimport firebase from \"../../util/Firebase\";\nimport { v4 as uuidv4 } from 'uuid';\nimport {CircularProgress} from \"@material-ui/core\";\n\nconst useStyles = makeStyles({\n\troot: {\n\t\tminWidth: 250\n\t},\n\tbullet: {\n\t\tdisplay: 'inline-block',\n\t\tmargin: '0 2px',\n\t},\n\ttitle: {\n\t\tfontSize: 14,\n\t},\n\tpos: {\n\t\tmarginBottom: 12,\n\t},\n});\n\nconst JSchemaTaskCard = (props) => {\n\tconst classes = useStyles();\n\tconst history = useHistory();\n\tconst { complete, id, cardColor, cardType, stage, stageID, task, user, pCase } = props\n\n\tconst [waiting, setWaiting] = useState(false)\n\tconst [newTaskId, setNewTaskId] = useState(null)\n\n\tconst handleOpen = () => {\n\t\tif (cardType === \"creatable\" || cardType === \"selectable\" || cardType === \"creatableUnlim\") {\n\t\t\tsendCallbackRequest()\n\t\t} else {\n\t\t\thistory.push(\"/t/\" + id)\n\t\t\t//setRedirect(true)\n\t\t}\n\t}\n\n\tconst sendCallbackRequest = () => {\n\t\tsetWaiting(true)\n\t\tlet callback = \"\"\n\t\tlet callbackType = \"\"\n\t\tlet callbackName = \"\"\n\t\tif (cardType === \"creatable\" || cardType === \"creatableUnlim\") {\n\t\t\tcallback = uuidv4()\n\t\t\tcallbackType = \"callbackId\"\n\t\t\tcallbackName = \"callbackId\"\n\t\t} else if (cardType === \"selectable\") {\n\t\t\tcallback = id\n\t\t\tcallbackName = \"taskId\"\n\t\t\tcallbackType = firebase.firestore.FieldPath.documentId()\n\t\t}\n\t\tfirebase.firestore()\n\t\t\t.collection(\"task_requests\")\n\t\t\t.doc(user.uid)\n\t\t\t.collection(\"requests\")\n\t\t\t.add({\n\t\t\t\tstatus: \"pending\",\n\t\t\t\tuser: user.uid,\n\t\t\t\tcase_type: pCase,\n\t\t\t\tcase_stage_id: stageID,\n\t\t\t\t[callbackName]: callback\n\t\t\t}).then((doc) => {\n\t\t\tconst unsubscribe = firebase.firestore()\n\t\t\t\t.collection(\"tasks\")\n\t\t\t\t.where(\"assigned_users\", \"array-contains\", user.uid)\n\t\t\t\t.where(callbackType, \"==\", callback)\n\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tif (change.type === \"added\") {\n\t\t\t\t\t\t\tif (change.doc.id) {\n\t\t\t\t\t\t\t\t//setNewTaskId(change.doc.id)\n\t\t\t\t\t\t\t\t//setRedirect(true)\n\t\t\t\t\t\t\t\tunsubscribe()\n\t\t\t\t\t\t\t\thistory.push(\"/t/\" + change.doc.id)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t})\n\t}\n\n\treturn (\n\t\t<Card key={id} className={classes.root} style={{background: cardColor}}>\n\t\t\t<CardContent>\n\t\t\t\t<Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\">\n\t\t\t\t\t<Typography variant=\"h6\">\n\t\t\t\t\t\t{stage.title}\n\t\t\t\t\t</Typography>\n\t\t\t\t\t{complete && <Typography color=\"error\">\n\t\t\t\t\t\tСдано\n\t\t\t\t\t</Typography>}\n\t\t\t\t</Box>\n\t\t\t\t<Typography variant=\"subtitle1\" className={classes.pos} color=\"textSecondary\">\n\t\t\t\t\t#{id}\n\t\t\t\t</Typography>\n\t\t\t\t<Typography variant=\"body2\" component=\"p\">\n\t\t\t\t\tЗадание: {stage.description}\n\t\t\t\t</Typography>\n\t\t\t</CardContent>\n\t\t\t<CardActions>\n\t\t\t\t{waiting ?\n\t\t\t\t\t<CircularProgress/>\n\t\t\t\t\t:\n\t\t\t\t\t<Button size=\"small\" onClick={handleOpen}>{(cardType === \"creatableUnlim\") ? \"СОЗДАТЬ НОВУЮ ФОРМУ\" : \"Открыть\"}</Button>\n\t\t\t\t}\n\t\t\t</CardActions>\n\t\t</Card>\n\t);\n}\n\nexport default JSchemaTaskCard","import React, { useState, useEffect, useContext, useRef } from 'react'\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\nimport { Redirect, useParams } from 'react-router';\nimport Box from \"@material-ui/core/Box\";\nimport {Grid, Typography} from \"@material-ui/core\";\nimport PropTypes from \"prop-types\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Tabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport TaskCard from \"../Tasks/JSchemaCard\";\nimport { cloneDeep } from \"lodash\"\n\nfunction TabPanel(props) {\n    const {children, value, index, ...other} = props;\n\n    return (\n        <div\n            role=\"tabpanel\"\n            hidden={value !== index}\n            id={`full-width-tabpanel-${index}`}\n            aria-labelledby={`full-width-tab-${index}`}\n            {...other}\n        >\n            {value === index && (\n                <Box p={3}>\n                    <Typography>{children}</Typography>\n                </Box>\n            )}\n        </div>\n    );\n}\n\nTabPanel.propTypes = {\n    children: PropTypes.node,\n    index: PropTypes.any.isRequired,\n    value: PropTypes.any.isRequired,\n};\n\nfunction a11yProps(index) {\n    return {\n        id: `full-width-tab-${index}`,\n        'aria-controls': `full-width-tabpanel-${index}`,\n    };\n}\n\n\nconst useStyles = makeStyles({\n    root: {\n        paddingTop: 30,\n        flexGrow: 1\n    },\n});\n\nconst Page = () => {\n    const { currentUser } = useContext(AuthContext);\n\tconst { id } = useParams();\n\n\tconst classes = useStyles()\n\n\tconst [pageData, setPageData] = useState({})\n    const [userRanks, setUserRanks] = useState([])\n    const [userCases, setUserCases] = useState({})\n    const [userTasks, setUserTasks] = useState({})\n    const [filteredStages, setFilteredStages] = useState({})\n    const [unlimStages, setUnlimStages] = useState({})\n    const [tabValue, setTabValue] = useState(0)\n    const [availableStages, setAvailableStages] = useState({})\n    const [availableTasks, setAvailableTasks] = useState({})\n    const [userRanksDescriptions, setUserRanksDescriptions] = useState({})\n\n\n\tuseEffect(() => {\n\t\tconsole.log(\"Page id: \", id)\n        console.log(\"Current user: \", currentUser)\n        let unsubscribe = () => {}\n        if (currentUser) {\n            unsubscribe = firebase\n                .firestore()\n                .collection('pages')\n                .doc(id)\n                .onSnapshot(doc => {\n                    setPageData(doc.data())\n                    console.log(\"Page data: \", doc.data())\n                })\n        }\n        return unsubscribe\n    }, [currentUser, id])\n\n    useEffect(() => {\n\t\tconsole.log(\"Page id: \", id)\n        console.log(\"Current user: \", currentUser)\n        let unsubscribe = () => {}\n        if (currentUser && pageData && pageData.ranks) {\n            unsubscribe = firebase\n                .firestore()\n                .collection('users')\n                .doc(currentUser.uid)\n                .collection(\"user_private\")\n                .doc(\"private\")\n                .onSnapshot(doc => {\n                    setUserRanks(intersection(doc.data().ranks, pageData.ranks))\n                    console.log(\"User ranks: \", doc.data().ranks)\n                })\n        }\n        return unsubscribe\n    }, [currentUser, id, pageData])\n\n\n    useEffect(() => {\n\t\tif (pageData && Object.entries(pageData).length > 0 && userRanks.length > 0) {\n\t\t\tconst casesPath = firebase.firestore()\n\t\t\t\t\t.collection(\"schema\")\n\t\t\t\t\t.doc(\"structure\")\n\t\t\t\t\t.collection(\"cases\")\n\n\t\t    pageData.cases.map(pCase => {\n                    casesPath.doc(pCase)\n                    .collection(\"stages\")\n                    .where(\"ranks_write\", \"array-contains-any\", userRanks)\n                    .onSnapshot(snapshot => {\n\t\t\t\t\t\tcomplexStateFirebaseUpdate(snapshot, setUserCases, pCase)\n\t\t\t\t\t})\n\t\t\t})\n\n            firebase.firestore()\n                .collection(\"tasks\")\n                .where(\"assigned_users\", \"array-contains\", currentUser.uid)\n                .where(\"case_type\", \"in\", pageData.cases)\n                .onSnapshot(snapshot => {\n                    simpleStateFirebaseUpdate(snapshot, setUserTasks)\n                })\n\n            if (pageData.caseWithSelectableTasks) {\n                casesPath.doc(pageData.caseWithSelectableTasks)\n                    .collection(\"stages\")\n                    .where(\"ranks_read\", \"array-contains-any\", userRanks)\n                    .onSnapshot(snapshot => {\n\t\t\t\t\t\tsimpleStateFirebaseUpdate(snapshot, setAvailableStages)\n\t\t\t\t\t})\n\n                firebase.firestore()\n                    .collection(\"tasks\")\n                    .where(\"case_type\", \"==\", pageData.caseWithSelectableTasks)\n                    .where(\"assigned_users\", \"==\", [])\n                    .where(\"available\", \"==\", true)\n                    .where(\"is_complete\", \"==\", false)\n                    .where(\"ranks_read\", \"array-contains-any\", userRanks)\n                    .limit(25)\n                    .onSnapshot(snapshot => {\n                        simpleStateFirebaseUpdate(snapshot, setAvailableTasks)\n                    })\n            }\n        }\n\t}, [currentUser, pageData, userRanks, id])\n\n\n    const complexStateFirebaseUpdate = (snapshot, setFunction, subState) => {\n        snapshot.docChanges().forEach(change => {\n            if (change.type === \"added\" || change.type === \"modified\") {\n                setFunction(prevState => {\n                    const newState = Object.assign({}, prevState)\n                    if (!newState[subState]) {\n                        newState[subState] = {}\n                    }\n                    newState[subState][change.doc.id] = change.doc.data()\n                    console.log(\"User stages: \", newState)\n                    return newState\n                })\n            }\n            if (change.type === \"removed\") {\n                setFunction(prevState => {\n                    const newState = Object.assign({}, prevState)\n                    delete newState[subState][change.doc.id]\n                    return newState\n                })\n            }\n        })\n    }\n\n    const simpleStateFirebaseUpdate = (snapshot, setFunction) => {\n        snapshot.docChanges().forEach(change => {\n            if (change.type === \"added\" || change.type === \"modified\") {\n                setFunction(prevState => (\n                    {...prevState, [change.doc.id]: change.doc.data()}\n                ))\n            }\n            if (change.type === \"removed\") {\n                setFunction(prevState => {\n                    const newState = Object.assign({}, prevState)\n                    delete newState[change.doc.id]\n                    return newState\n                })\n            }\n        })\n    }\n\n    useEffect(() => {\n        if (Object.keys(userCases).length > 0) {\n            const newFilteredStages = cloneDeep(userCases)\n            let newUnlimStages = {}\n            Object.keys(userCases).map(caseID => {\n                Object.keys(userCases[caseID]).map(stageId => {\n                    const stage = userCases[caseID][stageId]\n                    if (stage.rank_limit_number && Object.keys(stage.rank_limit_number).length > 0) {\n                        const setIntersection = intersection(Object.keys(stage.rank_limit_number), userRanks)\n                        if (setIntersection.length > 0) {\n                            const maxTasksPerStage = calculatemaxTasksPerStage(setIntersection, stage.rank_limit_number)\n                            const tasksPerStage = countTasksPerStage(stageId, userTasks)\n                            console.log(\"caseID: \", caseID)\n                            console.log(\"stageId: \", stageId)\n                            console.log(\"maxTasksPerStage: \", maxTasksPerStage)\n                            console.log(\"tasksPerStage: \", tasksPerStage)\n                            // if (tasksPerStage >= maxTasksPerStage) {\n                            //     console.log(\"newFilteredStages: \", newFilteredStages)\n                            //     delete newFilteredStages[caseID][stageId]\n                            //     console.log(\"newFilteredStages after delete: \", newFilteredStages)\n                            // }\n                            if (tasksPerStage >= maxTasksPerStage || !(\"creatable\" in stage) || !(stage.creatable)) {\n                                console.log(\"newFilteredStages: \", newFilteredStages)\n                                delete newFilteredStages[caseID][stageId]\n                                console.log(\"newFilteredStages after delete: \", newFilteredStages)\n                            }\n                            console.log(\"userCases: \", userCases)\n                        } else {\n                            if (newUnlimStages[caseID]) {\n                                newUnlimStages[caseID][stageId] = newFilteredStages[caseID][stageId]\n                            } else {\n                                newUnlimStages[caseID] = {}\n                                newUnlimStages[caseID][stageId] = newFilteredStages[caseID][stageId]\n                            }\n                            delete newFilteredStages[caseID][stageId]\n                        }\n                    }\n                })\n            })\n            setFilteredStages(newFilteredStages)\n            setUnlimStages(newUnlimStages)\n        }\n    }, [currentUser, userCases, userTasks, id])\n\n\n    const countTasksPerStage = (stage, tasks) => {\n\t    let occurrences = 0\n        Object.values(tasks).map(task => {\n            if (task.case_stage_id === stage) {\n                occurrences++\n            }\n        })\n        return occurrences\n    }\n\n    const calculatemaxTasksPerStage = (rArray, limits) => {\n        let largestLimit = 0\n        rArray.map(v => {\n            if (limits[v] > largestLimit) {\n                largestLimit = limits[v]\n            }\n        })\n        return largestLimit\n    }\n\n    const intersection = (arrA, arrB) => {\n\t    const setA = new Set(arrA)\n        const setB = new Set(arrB)\n        let _intersection = new Set()\n        for (let elem of setB) {\n            if (setA.has(elem)) {\n                _intersection.add(elem)\n            }\n        }\n        return [..._intersection]\n    }\n\n    useEffect(() => {\n        if (userRanks.length > 0) {\n            firebase.firestore()\n                .collection(\"schema\")\n                .doc(\"structure\")\n                .collection(\"ranks\")\n                .where(firebase.firestore.FieldPath.documentId(), \"in\", userRanks)\n                .onSnapshot(snapshot => {\n                    snapshot.docChanges().forEach(change => {\n                        if (change.type === \"added\" || change.type === \"modified\") {\n                            setUserRanksDescriptions(prevState => {\n                                return {...prevState, [change.doc.id]: change.doc.data()}\n                            })\n                        }\n                        if (change.type === \"removed\") {\n                            setUserRanksDescriptions(prevState => {\n                                const newState = Object.assign({}, prevState)\n                                delete newState[change.doc.id]\n                                return newState\n                            })\n                        }\n                    })\n                })\n        }\n    }, [userRanks])\n\n    const displayTasks = (tasks, stages, cases, cardType, complete) => {\n        const displayedTasks = Object.keys(tasks).map(taskId => {\n            const caseType = tasks[taskId].case_type\n            const stageId = tasks[taskId].case_stage_id\n\n            let stage = false\n\n            if (stages) {\n                if (stages[stageId]) {\n                    stage = stages[stageId]\n                }\n            } else if (cases && cases[caseType] && cases[caseType][stageId]) {\n                stage = cases[caseType][stageId]\n            }\n\n            if (stage && tasks[taskId].is_complete === complete) {\n                console.log(\"TASKS: \", tasks[taskId])\n                console.log(\"userStages: \", userCases)\n                return <Grid key={taskId} style={{padding: 10}}>\n                    <TaskCard\n                        stage={stage}\n                        stageID={stageId}\n                        cardType={cardType}\n                        task={tasks[taskId]}\n                        user={currentUser}\n                        pCase={caseType}\n                        id={taskId}/>\n                </Grid>\n            }\n        })\n        return displayedTasks\n    }\n\n\n\n    const handleTabChange = (event, newValue) => {\n        setTabValue(newValue);\n    };\n\n\n    return (<Grid container justify=\"center\" alignItems=\"center\" direction=\"column\">\n        {console.log(\"pageData: \", pageData)}\n        {console.log(\"userRanks: \", userRanks)}\n        {console.log(\"userCases: \", userCases)}\n        {console.log(\"userTasks: \", userTasks)}\n        {console.log(\"filteredStages: \", filteredStages)}\n        {console.log(\"availableStages: \", availableStages)}\n        {console.log(\"availableTasks: \", availableTasks)}\n\n        {/* <Grid>\n\t\t\t\t<Button onClick={requestTask}>Получить задание</Button>\n\t\t\t</Grid> */}\n        {Object.keys(userRanksDescriptions).map(rank => (\n            <Typography variant=\"h5\">{userRanksDescriptions[rank].description}</Typography>\n        ))}\n        <div className={classes.root}>\n            {Object.keys(unlimStages).map(pCase => (\n                Object.keys(unlimStages[pCase]).map(stage => (\n                    <Grid key={pCase + stage} style={{padding: 10}}>\n                        <TaskCard complete={false}\n                                  stage={unlimStages[pCase][stage]}\n                                  stageID={stage}\n                                  user={currentUser}\n                                  pCase={pCase}\n                                  cardType = \"creatableUnlim\"/>\n                    </Grid>\n                ))\n            ))}\n            <Paper position=\"static\" color=\"default\">\n\n                <Tabs value={tabValue} onChange={handleTabChange} variant=\"fullWidth\" centered\n                      aria-label=\"simple tabs example\">\n                    <Tab label=\"Невыполненные\" {...a11yProps(0)}/>\n                    <Tab label=\"Выполненные\" {...a11yProps(1)}/>\n                    {(Object.keys(availableTasks).length > 0 && Object.keys(availableStages).length > 0) ?\n                        <Tab label=\"Доступные\" {...a11yProps(2)}/>\n                        :\n                        null}\n\n                    {/*<Tab label=\"Быстрые задания\" {...a11yProps(3)}/>*/}\n                </Tabs>\n            </Paper>\n        </div>\n\n        <TabPanel value={tabValue} index={0}>\n            {Object.keys(filteredStages).map(pCase => (\n                Object.keys(filteredStages[pCase]).map(stage => (\n                    <Grid key={pCase + stage} style={{padding: 10}}>\n                        <TaskCard complete={false}\n                                  stage={filteredStages[pCase][stage]}\n                                  stageID={stage}\n                                  user={currentUser}\n                                  pCase={pCase}\n                                  cardType = \"creatable\"/>\n                    </Grid>\n                ))\n            ))}\n            {displayTasks(userTasks, false, userCases, \"selected\", false)}\n        </TabPanel>\n\n        <TabPanel value={tabValue} index={1}>\n            {displayTasks(userTasks, false, userCases, \"selected\", true)}\n        </TabPanel>\n\n        {(Object.keys(availableTasks).length > 0 && Object.keys(availableStages).length > 0) ?\n        <TabPanel value={tabValue} index={2}>\n            {console.log(\"availableTasks: \", availableTasks)}\n            {displayTasks(availableTasks, availableStages, false, \"selectable\", false)}\n        </TabPanel>\n        :\n        null}\n        {/* <TabPanel value={value} index={2}>\n                быстрые задания\n            </TabPanel>*/}\n    </Grid>)\n}\n\nexport default Page","import React, {useEffect, useState} from \"react\";\nimport firebase from \"firebase\";\nimport LinearProgressWithLabel from \"./LinearProgressWithLabel\";\nimport {cloneDeep} from \"lodash\";\n\n\nconst Loader = props => {\n    const [fileBeingUploaded, setFileBeingUploaded] = useState({})\n    //const [storedFiles, setStoredFiles] = useState({})\n\n    // useEffect(() => {\n    //     props.filesLinks.onSnapshot(doc => {\n    //         setStoredFiles(doc.data().contents)\n    //     });\n    // }, [props.filesLinks])\n\n\n    const upload = async files => {\n        await Promise.all(files.map(async file => {\n            const snap = props.storageRef.child(file.name).put(file)\n            setFileBeingUploaded(prevState => {\n                const update = {[file.name]: {status: \"loading\", progress: 0}}\n                return prevState ? {...prevState, ...update} : update\n            })\n\n            // Listen for state changes, errors, and completion of the upload.\n            snap.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'\n                snapshot => {\n                    // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded\n                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;\n                    setFileBeingUploaded(prevState => {\n                        const update = {[file.name]: {status: \"loading\", progress: progress}}\n                        return prevState ? {...prevState, ...update} : update\n                    })\n                    console.log('Upload is ' + progress + '% done');\n\n                    switch (snapshot.state) {\n                        case firebase.storage.TaskState.PAUSED: // or 'paused'\n                            console.log('Upload is paused');\n                            break;\n                        case firebase.storage.TaskState.RUNNING: // or 'running'\n                            console.log('Upload is running');\n                            break;\n                    }\n                }, error => {\n\n                    // A full list of error codes is available at\n                    // https://firebase.google.com/docs/storage/web/handle-errors\n                    switch (error.code) {\n                        case 'storage/unauthorized':\n                            // User doesn't have permission to access the object\n                            break;\n\n                        case 'storage/canceled':\n                            // User canceled the upload\n                            break;\n\n                        default:\n                            // Unknown error occurred, inspect error.serverResponse\n                            break;\n                    }\n                }, () => {\n                    // Upload completed successfully, now we can get the download URL\n                    snap.snapshot.ref.getDownloadURL().then(async downloadURL => {\n                        await props.filesLinks.set({contents: {[downloadURL]: {name: file.name, url: downloadURL}}},\n\t\t\t\t\t{merge: true})\n                        setFileBeingUploaded(prevState => {\n                            const newState = Object.assign({}, prevState)\n                            delete newState[file.name]\n                            return newState\n                        })\n                        console.log('File available at', downloadURL);\n                    });\n                });\n\n            // let url = await snap.ref.getDownloadURL()\n            // let url_wo_token = url.split(\"?\")[0]\n            // console.log(\"File uploaded: \", url)\n            // //await uploadFilesData(file.name, url_wo_token, key)\n        }));\n    }\n\n    const handleChange = (event) => {\n        console.log(\"Files selected: \", [...event.target.files,])\n        upload([...event.target.files])\n    };\n\n\n    return (\n        <div>\n            <input\n                type=\"file\"\n                onChange={handleChange}\n                multiple\n            />\n            {Object.keys(fileBeingUploaded).map(filename =>\n                <div key={filename}>\n                    <p>{filename}</p>\n                    <LinearProgressWithLabel value={fileBeingUploaded[filename].progress}/>\n                </div>\n\n            )}\n            {/*{storedFiles ? <p>Сохраненные файлы</p> : <p></p>}*/}\n            {/*{Object.keys(storedFiles).map(fileUrl =>*/}\n            {/*    <div key={fileUrl}>*/}\n            {/*        <a href={fileUrl}>{storedFiles[fileUrl].name}</a>*/}\n            {/*    </div>*/}\n            {/*)}*/}\n        </div>\n    );\n}\n\nexport default Loader","import firebase from \"../../util/Firebase\";\nimport Loader from \"./Loader\";\nimport React, { useState } from \"react\";\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nconst CustomFileUpload = props => {\n\tconsole.log(\"All props: \", props)\n\tconsole.log(\"ID: \", props.taskID)\n\tconsole.log(\"Question ID: \", props.name)\n\tconsole.log(\"User UID: \", props.currentUserUid)\n\n\tconst [connectingTelegram, setConnectingTelegram] = useState(false)\n\tconst [telegramConnected, setTelegramConnected] = useState(false)\n\n\tlet pathToFolder = null\n\tlet handleTgConnectClick = null\n\tif (!props.disabled) {\n\t\tpathToFolder = firebase\n\t\t\t.storage()\n\t\t\t.ref(props.taskID)\n\t\t\t.child(props.name)\n\t\t\t.child(props.currentUserUid)\n\n\t\thandleTgConnectClick = async () => {\n\t\t\tsetConnectingTelegram(true)\n\t\t\tawait firebase\n\t\t\t\t.firestore()\n\t\t\t\t.collection(\"users\")\n\t\t\t\t.doc(props.currentUserUid)\n\t\t\t\t.set({fileUpload: props.taskID + \"/\" + props.name }, {merge: true})\n\t\t\tsetConnectingTelegram(false)\n\t\t\tsetTelegramConnected(true)\n\n\t\t}\n\t}\n\tconst linksToFiles = firebase\n\t\t.firestore()\n\t\t.collection(\"tasks\")\n\t\t.doc(props.taskID)\n\t\t.collection(\"responses\")\n\t\t.doc(props.name)\n\n\tconsole.log(\"Props formData: \", props.formData)\n\n\treturn (\n\t\t<div>\n\t\t\t{props.schema.title ? <div>{props.schema.title}</div> : <div></div>}\n\t\t\t{props.schema.description ? <div>{props.schema.description}</div> : <div></div>}\n\t\t\t{props.disabled ? null :\n\t\t\t\t<div>\n\t\t\t\t\t<Loader storageRef={pathToFolder}\n\t\t\t\t\t\t\tfilesLinks={linksToFiles}/>\n\t\t\t\t\t{connectingTelegram ?\n\t\t\t\t\t\t<CircularProgress/>\n\t\t\t\t\t\t:\n\t\t\t\t\t\ttelegramConnected ?\n\t\t\t\t\t\t\t<div>Вы можете начать загрузку файлов через бота. Все файлы, отправляемые боту, будут сохраняться здесь. После загрузки файлов через бот, не забудьте вернуться сюда и нажать \"ОТПРАВИТЬ\". <a href=\"https://t.me/journal_tg_bot\">Перейти в бот.</a></div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<p>Вы так же можете загрузить сюда файлы через Телеграм-бота. Для этого нажмите кнопку ниже: </p>\n\t\t\t\t\t\t\t\t<button onClick={handleTgConnectClick}>Загрузка через бот</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t}\n\t\t\t{props.formData ?\n\t\t\t\t<div>\n\t\t\t\t\t{Object.keys(props.formData).map(path =>\n\t\t\t\t\t\t<div key={path}>\n\t\t\t\t\t\t\t<a href={props.formData[path].url}>{props.formData[path].name}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t:\n\t\t\t\t<div></div>\n\t\t\t}\n\n\t\t</div>\n\t);\n}\n\nexport default CustomFileUpload\n\n","import React, { useState, useEffect, useContext, useRef } from 'react'\nimport firebase, { signInWithGoogle } from '../../util/Firebase'\nimport { AuthContext } from \"../../util/Auth\";\n\n//import Form from \"../form/form\"\nimport Dialog from \"../Dialog/Dialog\"\nimport DialogFeedback from \"../Dialog/FeedbackDialog\"\nimport Feedback from \"../form/feedback\"\n\nimport Loader from \"../form/Loader\"\nimport CustomFileUpload from \"../form/CustomFileUpload\";\nimport { Button, Divider, Grid, Typography } from '@material-ui/core';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nimport JSchemaForm from \"@rjsf/bootstrap-4\";\nimport { cloneDeep, isEqual } from 'lodash'\n\n\nimport { Redirect, useParams, useHistory } from 'react-router';\nimport { Link } from \"react-router-dom\";\n\n\nconst JSchemaTask = () => {\n\tconst [formResponses, setFormResponses] = useState({})\n\tconst [taskForm, setTaskForm] = useState({})\n\tconst [mergedForm, setMergedForm] = useState({})\n\tconst [fields, setFields] = useState({})\n\tconst [taskMetadata, setTaskMetadata] = useState({})\n\tconst [caseStages, setCaseStages] = useState({})\n\tconst [backgroundTasks, setBackgroundTasks] = useState({})\n\tconst [backgroundTaskForms, setBackgroundTaskForms] = useState({})\n\tconst [mergedBackgroundForms, setMergedBackgroundForms] = useState({})\n\tconst [backgroundResponses, setBackgroundResponses] = useState({})\n\tconst [currentFocus, setCurrentFocus] = useState(\"\")\n\tconst [gRef, setGRef] = useState(null)\n\tconst [formLocked, setFormLocked] = useState(true)\n\n\tconst [questions, setQuestions] = useState([])\n\tconst [responses, setResponses] = useState([])\n\tconst [answers, setAnswers] = useState({})\n\tconst [forms, setForms] = useState([])\n\tconst [uploaded, setUploaded] = useState(false)\n\tconst [redirect, setRedirect] = useState(false)\n\tconst [userData, setUserData] = useState({})\n\tconst [lockButton, setLock] = useState(false)\n\tconst [caseTasks, setCaseTasks] = useState([])\n\tconst [dialogState, setDialog] = useState(false)\n\tconst [dialogType, setDialogType] = useState(null)\n\tconst [feedbackValue, setFeedback] = useState({})\n\tconst [releaseFeedbackData, setReleaseFeedbackData] = useState({})\n\tconst [openSnackbar, setOpenSnackbar] = useState(false);\n\tconst [files, setFiles] = useState({})\n\tconst [uploading, setUploading] = useState(false)\n\n\tconst { currentUser } = useContext(AuthContext);\n\tconst { id } = useParams();\n\tconst history = useHistory();\n\n\tconst handleCloseSnackbar = (event, reason) => {\n\t\tif (reason === 'clickaway') {\n\t\t\treturn;\n\t\t}\n\n\t\tsetOpenSnackbar(false);\n\t};\n\n\t// const uploadsRef = useRef();\n\n\tuseEffect(() => {\n\t\tif (currentUser && id) {\n\n\t\t\tconst ref = firebase\n\t\t\t\t.firestore()\n\t\t\t\t.collection(\"tasks\")\n\t\t\t\t.doc(id)\n\n\t\t\tsetGRef(ref)\n\n\t\t\tref.onSnapshot(doc => {\n\t\t\t\t\tsetTaskMetadata(doc.data())\n\t\t\t\t\tsetFormLocked(doc.data().is_complete)\n\t\t\t\t\tconsole.log(\"Task Metadata: \", doc.data());\n\t\t\t\t});\n\n\t\t\tref.collection(\"responses\")\n\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\tconst changes = {}\n\t\t\t\t\tconst deletes = []\n\t\t\t\t\tlet modifyResponses = false\n\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\tconst contents = change.doc.data().contents\n\t\t\t\t\t\t\tchanges[change.doc.id] = contents\n\t\t\t\t\t\t\tmodifyResponses = true\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (change.type === \"removed\") {\n\t\t\t\t\t\t\t//if (formResponses.hasOwnProperty(change.doc.id)) {\n\t\t\t\t\t\t\tconsole.log(\"Response Removed: \", change.doc.data());\n\t\t\t\t\t\t\tdeletes.push(change.doc.id)\n\t\t\t\t\t\t\tmodifyResponses = true\n\t\t\t\t\t\t\t//}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (modifyResponses) {\n\t\t\t\t\t\tsetFormResponses(prevState => {\n\t\t\t\t\t\t\tconst newState = cloneDeep(prevState)\n\t\t\t\t\t\t\tdeletes.forEach(d => delete newState[d])\n\t\t\t\t\t\t\tObject.keys(changes).forEach(key => newState[key] = changes[key])\n\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tref.collection(\"questions\")\n\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\tsetTaskForm(prevState => {\n\t\t\t\t\t\t\t\treturn {...prevState, [change.doc.id]: change.doc.data()}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t}\n\n\t}, [id, currentUser])\n\n\tuseEffect( () => {\n\t\tif (Object.entries(taskMetadata).length > 0) {\n\t\t\tconsole.log(\"Task metadata: \", taskMetadata)\n\t\t\tfirebase.firestore()\n\t\t\t\t.collection(\"schema\")\n\t\t\t\t.doc(\"structure\")\n\t\t\t\t.collection(\"cases\")\n\t\t\t\t.doc(taskMetadata.case_type)\n\t\t\t\t.collection(\"stages\")\n\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\tconsole.log(\"Case stage: \", change.doc.data())\n\t\t\t\t\t\t\tsetCaseStages(prevState => {\n\t\t\t\t\t\t\t\treturn {...prevState, [change.doc.id]: change.doc.data()}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (change.type === \"removed\") {\n\t\t\t\t\t\t\tsetCaseStages(prevState => {\n\t\t\t\t\t\t\t\tconst newState = Object.assign({}, prevState)\n\t\t\t\t\t\t\t\tdelete newState[change.doc.id]\n\t\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t}\n\t}, [taskMetadata.case_type])\n\n\tuseEffect(() => {\n\t\tconst mergedBgForms = {}\n\t\tconsole.log(\"Bg tasks: \", backgroundTasks)\n\t\tObject.keys(backgroundTasks).map(taskId => {\n\t\t\tconst stage = backgroundTasks[taskId].case_stage_id\n\t\t\tif (! mergedBgForms[stage]) {\n\t\t\t\tmergedBgForms[stage] = {}\n\t\t\t}\n\t\t\tmergedBgForms[stage][taskId] = mergeForm(backgroundTaskForms[taskId],\n\t\t\t\tcaseStages[stage])\n\t\t})\n\t\tconsole.log(\"Merged bg forms: \", mergedBgForms)\n\t\tsetMergedBackgroundForms(mergedBgForms)\n\t}, [backgroundTasks, backgroundTaskForms, caseStages])\n\n\tuseEffect(() => {\n\t\tsetMergedForm(mergeForm(taskForm, caseStages[taskMetadata.case_stage_id]))\n\t}, [taskForm, taskMetadata, caseStages])\n\n\tuseEffect(() => {\n\n\t\tif (Object.keys(caseStages).length > 0 && Object.keys(taskMetadata).length > 0 && caseStages[taskMetadata.case_stage_id]) {\n\t\t\tconsole.log(\"caseStages: \", caseStages)\n\t\t\tconsole.log(\"taskMetadata: \", taskMetadata)\n\t\t\tconst backgroundTasksList = caseStages[taskMetadata.case_stage_id].backgroundStages\n\t\t\tif (backgroundTasksList && backgroundTasksList.length > 0) {\n\t\t\t\tconsole.log(\"backgroundTasksList: \", backgroundTasksList.length)\n\t\t\t\tfirebase.firestore()\n\t\t\t\t\t.collection(\"tasks\")\n\t\t\t\t\t.where(\"case_id\", \"==\", taskMetadata.case_id)\n\t\t\t\t\t.where(\"case_stage_id\", \"in\", backgroundTasksList)\n\t\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\t\tconsole.log(\"Background task: \", change.doc.data())\n\t\t\t\t\t\t\t\tsetBackgroundTasks(prevState => {\n\t\t\t\t\t\t\t\t\treturn {...prevState, [change.doc.id]: change.doc.data()}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (change.type === \"removed\") {\n\t\t\t\t\t\t\t\tsetBackgroundTasks(prevState => {\n\t\t\t\t\t\t\t\t\tconst newState = Object.assign({}, prevState)\n\t\t\t\t\t\t\t\t\tdelete newState[change.doc.id]\n\t\t\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}, [caseStages, taskMetadata])\n\n\tuseEffect(() => {\n\t\tif (Object.entries(backgroundTasks).length > 0) {\n\t\t\tObject.keys(backgroundTasks).map(key => {\n\t\t\t\tfirebase.firestore()\n\t\t\t\t\t.collection(\"tasks\")\n\t\t\t\t\t.doc(key)\n\t\t\t\t\t.collection(\"questions\")\n\t\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\t\tsetBackgroundTaskForms(prevState => {\n\t\t\t\t\t\t\t\t\tconst newState = Object.assign({}, prevState)\n\t\t\t\t\t\t\t\t\tnewState[key][change.doc.id] = change.doc.data()\n\t\t\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\tfirebase.firestore()\n\t\t\t\t\t.collection(\"tasks\")\n\t\t\t\t\t.doc(key)\n\t\t\t\t\t.collection(\"responses\")\n\t\t\t\t\t.onSnapshot(snapshot => {\n\t\t\t\t\t\tsnapshot.docChanges().forEach(change => {\n\t\t\t\t\t\t\tif (change.type === \"added\" || change.type === \"modified\") {\n\t\t\t\t\t\t\t\tsetBackgroundResponses(prevState => {\n\t\t\t\t\t\t\t\t\tconst newState = Object.assign({}, prevState)\n\t\t\t\t\t\t\t\t\tif (! newState[key]) {\n\t\t\t\t\t\t\t\t\t\tnewState[key] = {}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnewState[key][change.doc.id] = change.doc.data().contents\n\t\t\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (change.type === \"removed\") {\n\t\t\t\t\t\t\t\tsetBackgroundResponses(prevState => {\n\t\t\t\t\t\t\t\t\tconst newState = Object.assign({}, prevState)\n\t\t\t\t\t\t\t\t\tdelete newState[key][change.doc.id]\n\t\t\t\t\t\t\t\t\treturn newState\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t})\n\t\t}\n\t}, [backgroundTasks])\n\n\t// useEffect( () => {\n\t// \tsetMergedQuestions(mergeQuestions([caseStages[taskMetadata.case_stage_id]]))\n\t// }, [caseStages, taskQuestions])\n\n\t// useEffect(() => {\n\t// \tconst timer = setTimeout(() => {\n\t// \t\tif (formResponsesChanged) {\n\t// \t\t\tfirebase\n\t// \t\t\t\t.firestore()\n\t// \t\t\t\t.collection(\"tasks\")\n\t// \t\t\t\t.doc(id)\n\t// \t\t\t\t.collection(\"responses\")\n\t// \t\t\t\t.doc(\"form_responses\")\n\t// \t\t\t\t.set(formResponses)\n\t// \t\t\t\t.then(docRef => {\n\t// \t\t\t\t\tsetFormResponsesChanged(false);\n\t// \t\t\t\t\tconsole.log(\"Document written with ID: \", docRef.id);\n\t// \t\t\t\t})\n\t// \t\t\t\t.catch(error => console.error(\"Error setting document: \", error));\n\t// \t\t}\n\t// \t}, AUTOSAVE_INTERVAL);\n\t// \treturn () => clearTimeout(timer);\n\t// }, [formResponsesChanged, formResponses]);\n\n\n\tconst handleFormChange = e => {\n\t\tsetFormResponses(e.formData)\n\t};\n\n\t// const handleBlur = e => {\n\t// \tif (gRef) {\n\t// \t\tconsole.log(\"Responses: \", formResponses)\n\t// \t\tconsole.log(\"That is what was blured\", e)\n\t// \t\tif (e === \"root\") {\n\t// \t\t\tconsole.log(\"e from first option when trigger is root\", e)\n\t// \t\t\tObject.keys(formResponses).map(k => {\n\t// \t\t\t\tgRef.collection(\"responses\")\n\t// \t\t\t\t\t.doc(k)\n\t// \t\t\t\t\t.set({contents: formResponses[k] ? formResponses[k] : firebase.firestore.FieldValue.delete()},\n\t// \t\t\t\t\t\t{merge: true})\n\t// \t\t\t})\n\t// \t\t} else {\n\t// \t\t\tconsole.log(\"e from second option when trigger is not root\", e)\n\t// \t\t\tconst docID = e.split(\"_\")[1]\n\t// \t\t\tgRef.collection(\"responses\")\n\t// \t\t\t\t.doc(docID)\n\t// \t\t\t\t.set({contents: formResponses[docID] ? formResponses[docID] : firebase.firestore.FieldValue.delete()},\n\t// \t\t\t\t\t{merge: true})\n\t// \t\t}\n\t// \t}\n\t// }\n\n\tconst handleBlur = e => {\n\t\tif (gRef) {\n\t\t\tconsole.log(\"Responses: \", formResponses)\n\t\t\tconsole.log(\"That is what was blured\", e)\n\n\t\t\tObject.keys(formResponses).map(k => {\n\t\t\t\tgRef.collection(\"responses\")\n\t\t\t\t\t.doc(k)\n\t\t\t\t\t.set({contents: formResponses[k] ? formResponses[k] : firebase.firestore.FieldValue.delete()},\n\t\t\t\t\t\t{merge: true})\n\t\t\t})\n\t\t}\n\t}\n\n\tconst mergeForm = (taskForm, caseForms) => {\n\t\tconst tForm = Object.assign({}, taskForm)\n\t\tconst cForms = Object.assign({}, caseForms)\n\n\t\tcForms.start = cForms.start ? cForms.start : {}\n\t\tcForms.end = cForms.end ? cForms.end : {}\n\t\tcForms.start_ui_schema = cForms.start_ui_schema ? cForms.start_ui_schema : {}\n\t\tcForms.end_ui_schema = cForms.end_ui_schema ? cForms.end_ui_schema : {}\n\n\t\ttForm.form_questions = tForm.form_questions ? tForm.form_questions : {}\n\t\ttForm.ui_schema = tForm.ui_schema ? tForm.ui_schema : {}\n\n\n\t\tconst properties = {\n\t\t\t...(cForms.start.properties ? cForms.start.properties : {}),\n\t\t\t...(cForms.end.properties ? cForms.end.properties : {}),\n\t\t\t...(tForm.form_questions.properties ? tForm.form_questions.properties : {})\n\t\t}\n\n\t\tconst definitions = {\n\t\t\t...(cForms.start.definitions ? cForms.start.definitions : {}),\n\t\t\t...(cForms.end.definitions ? cForms.end.definitions : {}),\n\t\t\t...(tForm.form_questions.definitions ? tForm.form_questions.definitions : {})\n\t\t}\n\n\t\tlet title = \"\"\n\t\tif (tForm.form_questions.title) {\n\t\t\ttitle = tForm.form_questions.title\n\t\t} else if (cForms.end.title) {\n\t\t\ttitle = cForms.end.title\n\t\t} else if (cForms.start.title) {\n\t\t\ttitle = cForms.start.title}\n\n\t\tlet description = \"\"\n\t\tif (tForm.form_questions.description) {\n\t\t\tdescription = tForm.form_questions.description\n\t\t} else if (cForms.end.description) {\n\t\t\tdescription = cForms.end.description\n\t\t} else if (cForms.start.description) {\n\t\t\tdescription = cForms.start.description}\n\n\t\tconst required = [...new Set([\n\t\t\t...(cForms.start.required ? cForms.start.required : []),\n\t\t\t...(tForm.form_questions.required ? tForm.form_questions.required : []),\n\t\t\t...(cForms.start.required ? cForms.start.required : [])\n\t\t])]\n\n\t\tconst uiOrder = [...new Set([\n\t\t\t...(cForms.start_ui_schema[\"ui:order\"] ? cForms.start_ui_schema[\"ui:order\"] : []),\n\t\t\t...(tForm.ui_schema[\"ui:order\"]\t ? tForm.ui_schema[\"ui:order\"] : []),\n\t\t\t...(cForms.end_ui_schema[\"ui:order\"] ? cForms.end_ui_schema[\"ui:order\"] : [])\n\t\t])]\n\n\t\tlet uiSchema = {\n\t\t\t...(cForms.start_ui_schema ? cForms.start_ui_schema : {}),\n\t\t\t...(cForms.end_ui_schema ? cForms.end_ui_schema : {}),\n\t\t\t...(tForm.ui_schema ? tForm.ui_schema : {})\n\t\t}\n\n\t\tuiSchema = {...uiSchema, ...{\"ui:order\": uiOrder}}\n\n\t\tconst form = {\n\t\t\tproperties: properties,\n\t\t\tdefinitions: definitions,\n\t\t\ttitle: title,\n\t\t\tdescription: description,\n\t\t\trequired: required\n\t\t}\n\t\treturn {form_questions: form, ui_schema: uiSchema}\n\n\t}\n\n\n\t// useEffect(() => {\n\t// \tconst getQuestions = async (taskID) => {\n\t// \t\tlet q = []\n\t//\n\t// \t\tawait firebase.firestore().collection(\"tasks\").doc(taskID).collection(\"questions\").get()\n\t// \t\t\t.then((querySnapshot) => {\n\t// \t\t\t\tquerySnapshot.forEach((doc) => {\n\t// \t\t\t\t\tq.push({ questionId: doc.id, data: doc.data() })\n\t// \t\t\t\t});\n\t// \t\t\t})\n\t// \t\t\t.catch((error) => {\n\t// \t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t// \t\t\t});\n\t//\n\t// \t\treturn q\n\t// \t}\n\t//\n\t//\n\t// \tconst getResponses = async (taskID) => {\n\t// \t\tlet r = []\n\t//\n\t// \t\tawait firebase.firestore().collection(\"tasks\").doc(taskID).collection(\"responses\").get()\n\t// \t\t\t.then((querySnapshot) => {\n\t// \t\t\t\tquerySnapshot.forEach((doc) => {\n\t// \t\t\t\t\tr.push({ responseId: doc.id, data: doc.data() })\n\t// \t\t\t\t});\n\t// \t\t\t})\n\t// \t\t\t.catch((error) => {\n\t// \t\t\t\tconsole.log(\"Error getting documents: \", error);\n\t// \t\t\t});\n\t//\n\t// \t\treturn r\n\t// \t}\n\t//\n\t//\n\t// \tconst getSameCaseTasks = async () => {\n\t// \t\tlet sameCaseTasks = []\n\t//\n\t// \t\tawait firebase.firestore().collection(\"tasks\").doc(id).get().then(doc => {\n\t// \t\t\treturn doc.data()\n\t// \t\t}).then(async data => {\n\t// \t\t\tawait firebase.firestore().collection(\"tasks\").where(\"case_id\", \"==\", data.case_id).get().then(snap => {\n\t// \t\t\t\tsnap.forEach(doc => {\n\t// \t\t\t\t\tif (doc.id !== id) {\n\t// \t\t\t\t\t\tsameCaseTasks.push({ id: doc.id, ...doc.data() })\n\t// \t\t\t\t\t}\n\t// \t\t\t\t})\n\t// \t\t\t})\n\t// \t\t})\n\t// \t\treturn sameCaseTasks\n\t// \t}\n\t//\n\t// \tconst getForms = async () => {\n\t// \t\tlet f = []\n\t// \t\tlet locked = true\n\t//\n\t// \t\tsetForms(null)\n\t//\n\t// \t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").get().then(doc => {\n\t// \t\t\tif (doc.data().status === 'complete') {\n\t// \t\t\t\tlocked = true\n\t// \t\t\t\tsetLock(true)\n\t// \t\t\t}\n\t// \t\t\telse {\n\t// \t\t\t\tlocked = false\n\t// \t\t\t}\n\t// \t\t})\n\t//\n\t// \t\tlet sq = []\n\t// \t\tlet sr = []\n\t//\n\t// \t\tlet sameCaseTasks = await getSameCaseTasks()\n\t// \t\tsetCaseTasks(sameCaseTasks)\n\t// \t\tif (sameCaseTasks.length > 0) {\n\t// \t\t\tlet ques = sameCaseTasks.map(t => {\n\t// \t\t\t\treturn getQuestions(t.id)\n\t// \t\t\t})\n\t// \t\t\tlet resp = sameCaseTasks.map(t => {\n\t// \t\t\t\treturn getResponses(t.id)\n\t// \t\t\t})\n\t// \t\t\tconsole.log(ques)\n\t// \t\t\tawait Promise.all(ques).then(data => data.forEach(d => sq.push(...d)))\n\t// \t\t\tawait Promise.all(resp).then(data => data.forEach(d => sr.push(...d)))\n\t//\n\t// \t\t\tconsole.log(sq)\n\t// \t\t\tconsole.log(sr)\n\t// \t\t}\n\t//\n\t// \t\tlet sf = sq.map((el, i) => {\n\t// \t\t\tlet response = null\n\t// \t\t\tsr.forEach((res) => {\n\t// \t\t\t\tif (el.questionId === res.responseId) {\n\t// \t\t\t\t\tresponse = res.data.answer\n\t// \t\t\t\t\treturnAnswer(res.data.answer, i)\n\t// \t\t\t\t}\n\t// \t\t\t})\n\t// \t\t\treturn <Form key={el.questionId + '_' + i} question={el.data} index={i} response={response} returnAnswer={returnAnswer} locked={true} askFeedback={true} saveQuestionFeedback={saveQuestionFeedback} id={el.questionId} prevTaskId={sameCaseTasks[0].id} />\n\t// \t\t})\n\t//\n\t// \t\tsf.push(<div key={\"div_divider_stripped\"} style={{ height: 25, margin: '20px 0', background: 'repeating-linear-gradient( 45deg, white, white 10px, grey 10px, grey 25px)' }}><br /></div>)\n\t//\n\t//\n\t// \t\tlet q = await getQuestions(id)\n\t// \t\tlet r = await getResponses(id)\n\t//\n\t//\n\t// \t\tsetQuestions(q)\n\t// \t\tsetResponses(r)\n\t//\n\t//\n\t// \t\t// let newQ = sq.concat(q)\n\t// \t\t// let newR = sr.concat(r)\n\t//\n\t// \t\tf = q.map((el, i) => {\n\t// \t\t\tlet response = null\n\t// \t\t\tr.forEach((res) => {\n\t// \t\t\t\tif (el.questionId === res.responseId) {\n\t// \t\t\t\t\tresponse = res.data.answer\n\t// \t\t\t\t\treturnAnswer(res.data.answer, i)\n\t// \t\t\t\t}\n\t// \t\t\t})\n\t// \t\t\treturn (\n\t// \t\t\t\t<Form\n\t// \t\t\t\t\tkey={el.questionId + '_' + i}\n\t// \t\t\t\t\tquestion={el.data}\n\t// \t\t\t\t\tindex={i}\n\t// \t\t\t\t\tresponse={response}\n\t// \t\t\t\t\treturnFile={returnFile}\n\t// \t\t\t\t\treturnAnswer={returnAnswer}\n\t// \t\t\t\t\tid={el.questionId}\n\t// \t\t\t\t\tlocked={locked}\n\t// \t\t\t\t\t// ref={uploadsRef}\n\t// \t\t\t\t\tuploadFilesData={uploadFilesData} />\n\t// \t\t\t)\n\t// \t\t})\n\t//\n\t// \t\tlet newF = sf.concat(f)\n\t// \t\tsetForms(newF)\n\t// \t}\n\t// \tif (currentUser) {\n\t// \t\tgetForms()\n\t// \t}\n\t// }, [currentUser, id, lockButton])\n\t//\n\t//\n\t// const returnAnswer = (answer, index) => {\n\t// \tconst tmp = answers\n\t// \ttmp[index] = answer\n\t// \tsetAnswers(tmp)\n\t// }\n\t//\n\t// const returnFile = (file, questionId) => {\n\t// \tlet arr = [...file]\n\t// \tlet tmp = files\n\t// \ttmp[questionId] = arr\n\t// \tsetFiles(tmp)\n\t// \tconsole.log([...file], questionId)\n\t// }\n\t//\n\t// const upload = async () => {\n\t// \t// uploadsRef.current.startUpload()\n\t// \tif (Object.keys(files).length > 0) {\n\t// \t\tconsole.log('files')\n\t// \t\tsetUploading(true)\n\t// \t\tfor (const [key, value] of Object.entries(files)) {\n\t// \t\t\tlet ref = firebase.storage().ref(id).child(key).child(currentUser.uid)\n\t// \t\t\tawait Promise.all(value.map(async v => {\n\t// \t\t\t\tlet snap = await ref.child(v.name).put(v)\n\t// \t\t\t\tlet url = await snap.ref.getDownloadURL()\n\t// \t\t\t\tlet url_wo_token = url.split(\"?\")[0]\n\t// \t\t\t\tawait uploadFilesData(v.name, url_wo_token, key)\n\t// \t\t\t}));\n\t// \t\t}\n\t// \t\tsetUploaded(true)\n\t// \t\tsetUploading(false)\n\t// \t}\n\t// }\n\t//\n\t// const saveQuestionFeedback = (data, questionId, previousTaskId) => {\n\t// \tif (previousTaskId) {\n\t// \t\tfirebase.firestore().collection('tasks').doc(previousTaskId).collection('feedbacks').doc(questionId).collection('messages')\n\t// \t\t\t.add({\n\t// \t\t\t\tanswer: data.reason,\n\t// \t\t\t\ttext: data.text,\n\t// \t\t\t\tuser_id: currentUser.uid,\n\t// \t\t\t\ttimestamp: firebase.firestore.FieldValue.serverTimestamp()\n\t// \t\t\t})\n\t// \t\t\t.then(() => setOpenSnackbar(true))\n\t// \t}\n\t// \telse {\n\t// \t\talert('Ошибка: Что-то пошло не так при сохранении фидбека. Сообщите программисту!')\n\t// \t}\n\t// }\n\t//\n\t// const saveToFirebase = async (lock) => {\n\t// \tawait upload()\n\t// \tquestions.forEach(async (q, i) => {\n\t// \t\tif (answers[i] || answers[i] === \"\") {\n\t// \t\t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"responses\").doc(q.questionId).set({ answer: answers[i] }, { merge: true })\n\t// \t\t}\n\t// \t})\n\t//\n\t// \tif (lock) {\n\t// \t\tawait firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'complete' })\n\t// \t\tsetLock(true)\n\t// \t\tconsole.log(\"Task Locked\")\n\t// \t\tsetDialog(false)\n\t// \t}\n\t// }\n\t//\n\t// const uploadFilesData = async (filename, url, questionId) => {\n\t// \tlet rootRef = firebase.firestore().collection(\"tasks\").doc(id).collection(\"responses\").doc(questionId)\n\t// \tconsole.log(\"Файл отправлен\")\n\t// \tif (filename && url) {\n\t// \t\trootRef.set(\n\t// \t\t\t{\n\t// \t\t\t\tfiles: firebase.firestore.FieldValue.arrayUnion({ public_url: url, filename: filename })\n\t// \t\t\t}, { merge: true }\n\t// \t\t).then(() => console.log('super'))\n\t// \t}\n\t// };\n\t//\n\tconst handleDialogClose = () => {\n\t\tsetDialog(false);\n\t\t//setFeedback({})\n\t};\n\n\tconst handleOk = () => {\n\t\tsetDialog(false)\n\t\thistory.goBack()\n\t};\n\n\tconst handleDialogOpen = (type) => {\n\t\tconsole.log(\"Dialog open\")\n\t\tif (type === 'send') {\n\t\t\tsetDialogType('send')\n\t\t\tsetDialog(true)\n\t\t}\n\t\t// if (type === 'release') {\n\t\t// \tsetDialogType('release')\n\t\t// \tsetDialog(true)\n\t\t// }\n\t}\n\n\t// useEffect(() => {\n\t// \tfirebase.firestore().collection(\"schema\").doc(\"structure\").collection(\"feedbacks\").doc(\"release\").get().then(doc => {\n\t// \t\tsetReleaseFeedbackData(doc.data())\n\t// \t})\n\t// }, [])\n\t//\n\t// const releaseTask = () => {\n\t// \tfirebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'open' })\n\t// \t\t.then(() => firebase.firestore().collection(\"tasks\").doc(id).collection(\"user_editable\").doc(\"user_editable\").update({ status: 'released', release_status: feedbackValue.reason, release_description: feedbackValue.text })\n\t// \t\t\t.then(() => {\n\t// \t\t\t\tsetDialog(false)\n\t// \t\t\t\tsetLock(true)\n\t// \t\t\t}))\n\t// \t// alert(feedbackValue)\n\t// }\n\t//\n\t// const handleFeedbackSave = (value) => {\n\t// \tsetFeedback(value)\n\t// }\n\n\tconst lockForm = () => {\n\t\tfirebase.firestore()\n\t\t\t.collection(\"tasks\")\n\t\t\t.doc(id)\n\t\t\t.collection(\"user_editable\")\n\t\t\t.doc(\"user_editable\")\n\t\t\t.update({ status: 'complete' })\n\t}\n\n\treturn (\n\t\tcurrentUser ?\n\t\t\t<Grid style={{ padding: 30 }}>\n\t\t\t\t{dialogType === 'send' && <Dialog\n\t\t\t\t\tstate={dialogState}\n\t\t\t\t\thandleClose={handleDialogClose}\n\t\t\t\t\thandleOk={handleOk}\n\t\t\t\t\tshowOk={formLocked}\n\t\t\t\t\ttitle={formLocked ? \"Форма успешно отправлена.\" : \"Отправить форму?\"}\n\t\t\t\t\tcontent={formLocked ? \"Спасибо\" : \"Вы собираетесь отправить форму. Это значит, что вы больше не сможете изменять ответы.\"}\n\t\t\t\t\tdialogFunction={lockForm} />}\n\t\t\t\t{/*{dialogType === 'release' && <DialogFeedback*/}\n\t\t\t\t{/*\tstate={dialogState}*/}\n\t\t\t\t{/*\tfeedbackValue={feedbackValue}*/}\n\t\t\t\t{/*\thandleClose={handleDialogClose}*/}\n\t\t\t\t{/*\ttitle={releaseFeedbackData.title}*/}\n\t\t\t\t{/*\tdialogFunction={releaseTask}*/}\n\t\t\t\t{/*\tanswers={releaseFeedbackData.answers}*/}\n\t\t\t\t{/*\tdescription={releaseFeedbackData.description}*/}\n\t\t\t\t{/*\treturnFeedback={handleFeedbackSave} />}*/}\n\t\t\t\t{/*{redirect && <Redirect to=\"/tasks\" />}*/}\n\t\t\t\t{/*<Snackbar*/}\n\t\t\t\t{/*\tanchorOrigin={{*/}\n\t\t\t\t{/*\t\tvertical: 'bottom',*/}\n\t\t\t\t{/*\t\thorizontal: 'left',*/}\n\t\t\t\t{/*\t}}*/}\n\t\t\t\t{/*\topen={openSnackbar}*/}\n\t\t\t\t{/*\tautoHideDuration={6000}*/}\n\t\t\t\t{/*\tonClose={handleCloseSnackbar}*/}\n\t\t\t\t{/*\tmessage=\"Фидбек отправлен\"*/}\n\t\t\t\t{/*\taction={*/}\n\t\t\t\t{/*\t\t<React.Fragment>*/}\n\t\t\t\t{/*\t\t\t<IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={handleCloseSnackbar}>*/}\n\t\t\t\t{/*\t\t\t\t<CloseIcon fontSize=\"small\" />*/}\n\t\t\t\t{/*\t\t\t</IconButton>*/}\n\t\t\t\t{/*\t\t</React.Fragment>*/}\n\t\t\t\t{/*\t}*/}\n\t\t\t\t{/*/>*/}\n\t\t\t\t{/*/!* Предыдущие задания{caseTasks.map((t, i) => <Button key={\"case_button_\"+i} component={ Link } to={\"/tasks/\" + t.id}>{t.title}</Button>)} *!/*/}\n\t\t\t\t{/*{forms}*/}\n\t\t\t\t{/*<Grid container style={{ padding: 20 }} justify=\"center\">*/}\n\t\t\t\t{/*\t<Button variant=\"outlined\" style={{ borderWidth: 2, borderColor: \"grey\", color: 'grey', margin: 5 }} onClick={() => setRedirect(true)}>Назад</Button>*/}\n\t\t\t\t{/*\t{!lockButton &&*/}\n\t\t\t\t{/*\t\t<div>*/}\n\t\t\t\t{/*\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"#003366\", color: '#003366', margin: 5 }} onClick={() => saveToFirebase(false)}>Сохранить</Button>*/}\n\t\t\t\t{/*\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 5 }} onClick={() => handleDialogOpen('send')}>Отправить</Button>*/}\n\t\t\t\t{/*\t\t\t<Button variant=\"outlined\" disabled={lockButton} style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 5 }} onClick={() => handleDialogOpen('release')}>Освободить</Button>*/}\n\t\t\t\t{/*\t\t</div>}*/}\n\t\t\t\t{/*</Grid>*/}\n\n\t\t\t\t{/*{console.log(\"Case stages::: \", caseStages)}*/}\n\t\t\t\t{/*{console.log(\"Task metadata::: \", taskMetadata)}*/}\n\t\t\t\t{/*{console.log(\"Merged background forms::: \", mergedBackgroundForms)}*/}\n\n\t\t\t\t{(Object.keys(caseStages).length > 0 &&\n\t\t\t\t\tObject.keys(taskMetadata).length > 0 &&\n\t\t\t\t\tcaseStages[taskMetadata.case_stage_id] &&\n\t\t\t\t\tcaseStages[taskMetadata.case_stage_id].backgroundStages &&\n\t\t\t\t\tcaseStages[taskMetadata.case_stage_id].backgroundStages.length > 0 &&\n\t\t\t\t\tObject.keys(mergedBackgroundForms).length > 0) ?\n\t\t\t\t\t<Grid style={{padding: 30}}>\n\t\t\t\t\t\t{caseStages[taskMetadata.case_stage_id].backgroundStages.map(stage => {\n\t\t\t\t\t\t\treturn <div key={stage}>\n\t\t\t\t\t\t\t\t{console.log(\"STAGE: \", stage)}\n\t\t\t\t\t\t\t\t{console.log(\"mergedBackgroundForms: \", mergedBackgroundForms)}\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tmergedBackgroundForms[stage] ?\n\t\t\t\t\t\t\t\t\t\t(Object.keys(mergedBackgroundForms[stage]).map(taskId => (\n\t\t\t\t\t\t\t\t\t\t\t<Grid style={{padding: 30}} key={taskId}>\n\t\t\t\t\t\t\t\t\t\t\t\t<JSchemaForm\n\t\t\t\t\t\t\t\t\t\t\t\t\tschema={mergedBackgroundForms[stage][taskId].form_questions}\n\t\t\t\t\t\t\t\t\t\t\t\t\tuiSchema={mergedBackgroundForms[stage][taskId].ui_schema}\n\t\t\t\t\t\t\t\t\t\t\t\t\tformData={backgroundResponses[taskId]}\n\t\t\t\t\t\t\t\t\t\t\t\t\tfields={{customFileUpload: a => CustomFileUpload({...a, ...{taskID: taskId}, ...{\"currentUserUid\": currentUser.uid}})}}\n\t\t\t\t\t\t\t\t\t\t\t\t\tdisabled={true}\n\t\t\t\t\t\t\t\t\t\t\t\t> </JSchemaForm>\n\t\t\t\t\t\t\t\t\t\t\t</Grid>\n\t\t\t\t\t\t\t\t\t\t)))\n\t\t\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\t\t\tnull\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t})}\n\t\t\t\t\t</Grid>\n\t\t\t\t\t:\n\t\t\t\t\tnull\n\t\t\t\t}\n\n\t\t\t\t{mergedForm && gRef ?\n\t\t\t\t\t<JSchemaForm\n\t\t\t\t\t\tschema={mergedForm.form_questions}\n\t\t\t\t\t\tuiSchema={mergedForm.ui_schema}\n\t\t\t\t\t\tformData={formResponses}\n\t\t\t\t\t\tfields={{customFileUpload: a => CustomFileUpload({...a, ...{taskID: id}, ...{\"currentUserUid\": currentUser.uid}})}}\n\t\t\t\t\t\tdisabled={formLocked}\n\t\t\t\t\t\tonChange={e => {\n\t\t\t\t\t\t\thandleFormChange(e)\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonFocus={e => {\n\t\t\t\t\t\t\tconsole.log(\"That is what was focused\", e)\n\t\t\t\t\t\t\tsetCurrentFocus(e.split(\"_\")[1])\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tonBlur={e => {\n\t\t\t\t\t\t\thandleBlur(e)\n\t\t\t\t\t\t}}>\n\t\t\t\t\t\t{formLocked ?\n\t\t\t\t\t\t\t<div>Форма отправлена успешно</div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<Button variant=\"outlined\" disabled={formLocked} style={{ borderWidth: 2, borderColor: \"red\", color: 'red', margin: 5 }} onClick={() => handleDialogOpen('send')}>Отправить</Button>\n\t\t\t\t\t\t}\n\t\t\t\t\t</JSchemaForm>\n\t\t\t\t\t\t:\n\t\t\t\t\t<p></p>}\n\n\t\t\t</Grid>\n\t\t\t:\n\t\t\t<Grid container direction=\"column\" style={{ padding: 20 }} justify=\"center\">\n\t\t\t\t<Typography align=\"center\" variant=\"h3\">авторизируйтесь</Typography>\n\t\t\t\t<br />\n\t\t\t\t<Button variant=\"contained\" onClick={signInWithGoogle}>Войти с помощью аккаунта Google</Button>\n\t\t\t</Grid>\n\t)\n\n}\n\nexport default JSchemaTask","import React, { useState, useContext } from 'react'\nimport { AuthProvider } from \"./util/Auth\";\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Link,\n  Redirect\n} from \"react-router-dom\";\nimport { AuthContext } from \"./util/Auth\";\n\nimport Grid from '@material-ui/core/Grid'\n\n// import Appbar from './Components/Appbar/Appbar'\n// import Appbar from './Components/Appbar/oldAppBar'\nimport Appbar from './Components/Appbar/newAppBar'\nimport Profile from './Components/Profile/Profile'\nimport Tasks from './Components/Tasks/Tasks'\nimport Task from './Components/Tasks/Task'\nimport Cases from './Components/Cases/Cases';\nimport Notifications from './Components/Notifications/Notifications'\nimport Home from './Components/Home/Home'\nimport TasksObserver from './Components/Moderator/TasksObserver'\nimport Signin from './Components/Auth/Signin';\nimport PrivateRoute from './util/PrivateRoute';\nimport FAQ from './Components/FAQ/FAQ';\nimport Page from \"./Components/Page/Page\";\nimport JSchemaTask from \"./Components/Tasks/JSchemaTask\";\n\n\nconst App = () => {\n\n  return (\n    <Router>\n      <Grid container justify=\"center\">\n        <Appbar>\n          <Switch>\n            <Route exact path=\"/profile\">\n              <Profile />\n            </Route>\n            <Route exact path=\"/request\">\n              <Cases />\n            </Route>\n            <Route exact path=\"/tasks\">\n              <Tasks />\n            </Route>\n            <Route path=\"/tasks/:id\">\n              <Task />\n            </Route>\n            <Route path=\"/t/:id\">\n              <JSchemaTask />\n            </Route>\n            <Route exact path=\"/tasksObserver\">\n              <TasksObserver />\n            </Route>\n            <Route exact path=\"/notifications\">\n              <Notifications />\n            </Route>\n            <Route exact path=\"/signin\">\n              <Signin />\n            </Route>\n            <Route exact path=\"/faq\">\n              <FAQ />\n            </Route>\n            <Route path=\"/p/:id\">\n              <Page />\n            </Route>\n            <PrivateRoute path=\"/\" component={Home} />\n          </Switch>\n        </Appbar>\n      </Grid>\n    </Router>\n  )\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import 'bootstrap/dist/css/bootstrap.css';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport {AuthProvider} from './util/Auth'\n\nReactDOM.render(\n  <React.StrictMode>\n    <AuthProvider>\n      <App />\n    </AuthProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}