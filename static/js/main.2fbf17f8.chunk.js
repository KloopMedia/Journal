(this.webpackJsonpjournal=this.webpackJsonpjournal||[]).push([[0],{156:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(0),a=n.n(r),i=n(18),s=n.n(i),o=(n(156),n(8)),l=n(71);l.a.initializeApp({apiKey:"AIzaSyBfzhQOCtbcUk_tWjPDnjYtHwoouCEkclg",authDomain:"journal-bb5e3.firebaseapp.com",databaseURL:"https://journal-bb5e3.firebaseio.com",projectId:"journal-bb5e3",storageBucket:"journal-bb5e3.appspot.com",messagingSenderId:"918752509407",appId:"1:918752509407:web:77670a68ff906f13e5d86a"});var u=new l.a.auth.GoogleAuthProvider,d=function(){l.a.auth().signInWithPopup(u)},j=l.a,b=a.a.createContext(),f=function(e){var t=e.children,n=Object(r.useState)(null),a=Object(o.a)(n,2),i=a[0],s=a[1],l=Object(r.useState)(!0),u=Object(o.a)(l,2),d=(u[0],u[1]);return Object(r.useEffect)((function(){j.auth().onAuthStateChanged((function(e){s(e),d(!1);var t=j.firestore().collection("users");if(e){var n=t.doc(e.uid);n.get().then((function(t){t&&t.exists||(console.log("Creating user"),n.set({username:e.displayName,email:e.email}))}))}}))}),[]),Object(c.jsx)(b.Provider,{value:{currentUser:i},children:t})},O=n(43),h=n(17),p=n(231),x=n(13),g=n.n(x),v=n(22),m=n(23),k=n(32),y=n(229),w=n(228),S=n(226),C=n(256),E=n(251),I=n(175),_=n(112),q=n.n(_),F=n(119),T=n(230),A=n(234),z=n(88),N=n(224),P=n(21),B=n.p+"static/media/kloop_transparent_site.f6fb098e.png",D=n(113),R=n.n(D),U=n(232),W=240,L=Object(N.a)((function(e){return{root:{display:"flex"},drawer:Object(k.a)({},e.breakpoints.up("sm"),{width:W,flexShrink:0}),appBar:Object(k.a)({background:"white",boxShadow:"none"},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(W,"px)"),marginLeft:W}),menuButton:Object(k.a)({color:"black",marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:W},content:{flexGrow:1,padding:e.spacing(3)}}}));var M=function(e){var t=e.window,n=L(),i=Object(P.a)(),s=a.a.useState(!1),l=Object(o.a)(s,2),u=l[0],f=l[1],h=Object(r.useContext)(b).currentUser,x=a.a.useState(null),k=Object(o.a)(x,2),_=k[0],N=k[1],D=Boolean(_),W=function(){f(!u)},M=Object(r.useState)(!1),V=Object(o.a)(M,2),G=V[0],Q=V[1],H=Object(r.useState)(0),J=Object(o.a)(H,2),K=J[0],Y=J[1],X=Object(r.useState)([]),Z=Object(o.a)(X,2),$=Z[0],ee=Z[1];Object(r.useEffect)((function(){j.firestore().collection("editors").get().then((function(e){e.forEach((function(e){e.id===h.uid&&(console.log("moderator"),Q(!0))}))})).catch((function(){return Q(!1)}))}),[h]),Object(r.useEffect)((function(){if(h){var e=j.firestore().collection("notifications").where("user_id","array-contains",h.uid).onSnapshot(function(){var e=Object(m.a)(g.a.mark((function e(t){var n,c;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t.size),n=[],c=0,t.forEach((function(e){e.data().shown||(n.push(Object(v.a)({id:e.id},e.data())),c++)})),Y(c),ee(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){return e()}}}),[h]);var te=Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:n.toolbar}),Object(c.jsx)(S.a,{}),Object(c.jsx)("nav",{children:Object(c.jsxs)("ul",{children:[Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/",children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"})}),Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/profile",children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})}),Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/tasks",children:"\u0417\u0430\u0434\u0430\u043d\u0438\u044f"})}),Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/request",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"})}),Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/notifications",children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"})}),G?Object(c.jsx)("li",{children:Object(c.jsx)(O.b,{to:"/tasksObserver",children:"\u041c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440"})}):null]})})]}),ne=void 0!==t?function(){return t().document.body}:void 0;return Object(c.jsxs)("div",{className:n.root,children:[Object(c.jsx)(w.a,{}),Object(c.jsx)(y.a,{position:"fixed",className:n.appBar,children:Object(c.jsxs)(T.a,{children:[Object(c.jsx)(I.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:W,className:n.menuButton,children:Object(c.jsx)(q.a,{})}),Object(c.jsx)(p.a,{container:!0,style:{flexGrow:1},children:Object(c.jsx)("img",{src:B,alt:"Kloop.kg - \u041d\u043e\u0432\u043e\u0441\u0442\u0438 \u041a\u044b\u0440\u0433\u044b\u0437\u0441\u0442\u0430\u043d\u0430",style:{width:150,height:"auto"}})}),h&&Object(c.jsxs)("div",{children:[Object(c.jsx)(I.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){N(e.currentTarget)},color:"inherit",size:"small",children:Object(c.jsx)(U.a,{badgeContent:K,color:"secondary",overlap:"circle",children:Object(c.jsx)(R.a,{style:{fill:"grey",fontSize:"28px"}})})}),Object(c.jsx)(F.a,{id:"menu-appbar",anchorEl:_,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:D,onClose:function(){N(null)},children:Object(c.jsx)(p.a,{container:!0,direction:"column",alignItems:"center",children:$.length>0?$.map((function(e,t){return Object(c.jsxs)(p.a,{container:!0,className:n.message,justify:"flex-start",style:{padding:0},children:[Object(c.jsx)(z.a,{style:{flex:1,padding:10},children:e.title}),Object(c.jsx)(A.a,{style:{padding:10},onClick:function(){return t=e.id,void j.firestore().collection("notifications").doc(t).update({shown:!0});var t},size:"small",children:"\u0441\u043a\u0440\u044b\u0442\u044c"})]},"notification_"+t)})):Object(c.jsx)(z.a,{className:n.message,align:"center",style:{padding:10},children:"\u041d\u0435\u0442 \u043d\u043e\u0432\u044b\u0445 \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u0439"})})})]}),h?Object(c.jsx)(A.a,{style:{borderColor:"black",color:"black",marginLeft:10,fontSize:12},variant:"outlined",size:"small",onClick:function(){return j.auth().signOut()},children:"\u0412\u044b\u0445\u043e\u0434"}):Object(c.jsx)(A.a,{style:{borderColor:"black",color:"black",marginLeft:10,fontSize:12},size:"small",variant:"outlined",onClick:d,children:"\u0432\u0445\u043e\u0434"})]})}),Object(c.jsxs)("nav",{className:n.drawer,"aria-label":"mailbox folders",children:[Object(c.jsx)(E.a,{smUp:!0,implementation:"css",children:Object(c.jsx)(C.a,{container:ne,variant:"temporary",anchor:"rtl"===i.direction?"right":"left",open:u,onClose:W,classes:{paper:n.drawerPaper},ModalProps:{keepMounted:!0},children:te})}),Object(c.jsx)(E.a,{xsDown:!0,implementation:"css",children:Object(c.jsx)(C.a,{classes:{paper:n.drawerPaper},variant:"permanent",open:!0,children:te})})]}),Object(c.jsxs)("main",{className:n.content,children:[Object(c.jsx)("div",{className:n.toolbar}),e.children]})]})},V=n(237),G=n(249),Q=n(93),H=n.n(Q),J=n(238),K=n(242),Y=n(240),X=n(241),Z=n(239),$=n(253),ee=n(235),te=n(236),ne=n(177),ce=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),a=n[0],i=n[1],s=Object(r.useState)(""),l=Object(o.a)(s,2),u=l[0],d=l[1],j=e.returnAnswer;return Object(c.jsxs)("div",{children:[Object(c.jsx)("h4",{children:e.title}),Object(c.jsx)(ne.a,{const:"fieldset",style:{paddingBottom:15},children:Object(c.jsx)(ee.a,{"aria-label":e.title,name:e.title,value:a,onChange:function(e){i(e.target.value),j({reason:e.target.value,text:u})},children:e.answers.map((function(t,n){return Object(c.jsx)(te.a,{value:t,control:Object(c.jsx)($.a,{color:"primary"}),label:t,disabled:!!e.locked},n)}))})}),Object(c.jsx)(V.a,{id:"feedback_input",label:"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u0435",value:u,onChange:function(e){d(e.target.value),j({reason:a,text:e.target.value})},multiline:!0,rows:5,variant:"outlined",fullWidth:!0})]})};function re(e){return Object(c.jsx)("div",{children:Object(c.jsxs)(J.a,{open:e.state,onClose:e.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(c.jsx)(Z.a,{id:"alert-dialog-title",children:e.title}),Object(c.jsx)(Y.a,{children:Object(c.jsxs)(X.a,{id:"alert-dialog-description",children:[Object(c.jsx)(z.a,{children:e.description}),Object(c.jsx)(ce,{answers:e.answers,returnAnswer:e.returnFeedback})]})}),Object(c.jsxs)(K.a,{children:[Object(c.jsx)(A.a,{onClick:e.handleClose,color:"primary",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(c.jsx)(A.a,{onClick:e.dialogFunction,disabled:!e.feedbackValue.reason,color:"primary",autoFocus:!0,children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]})})}n(244),n(115),n(116),n(243);var ae=Object(N.a)((function(e){return{root:{"& > *":{width:"40ch"}}}})),ie=function(e){ae();var t=a.a.useState(""),n=Object(o.a)(t,2),i=(n[0],n[1],Object(r.useState)(!1)),s=Object(o.a)(i,2),l=(s[0],s[1],Object(r.useState)({})),u=Object(o.a)(l,2),d=(u[0],u[1],Object(r.useState)({})),b=Object(o.a)(d,2),f=(b[0],b[1]),O=Object(r.useState)(!1),h=Object(o.a)(O,2),p=(h[0],h[1]),x=e.returnFile,g=(e.locked,e.id),v=e.feedbackType,m=e.askFeedback;e.saveQuestionFeedback,e.prevTaskId;Object(r.useEffect)((function(){console.log(v),v&&m?(console.log(v),j.firestore().collection("schema").doc("structure").collection("feedbacks").doc(v).get().then((function(e){f(e.data())})),p(!0)):p(!1)}),[v]);return Object(c.jsx)("div",{children:Object(c.jsx)("input",{type:"file",onChange:function(e){x(e.target.files,g)},multiple:!0})})},se=Object(N.a)((function(e){return{root:{"& > *":{width:"40ch"}}}})),oe=Object(r.forwardRef)((function(e,t){se();var n=a.a.useState(""),i=Object(o.a)(n,2),s=i[0],l=i[1],u=Object(r.useState)(!1),d=Object(o.a)(u,2),b=d[0],f=d[1],O=Object(r.useState)(null),h=Object(o.a)(O,2),p=(h[0],h[1],Object(r.useState)({})),x=Object(o.a)(p,2),g=x[0],v=x[1],m=Object(r.useState)({}),k=Object(o.a)(m,2),y=k[0],w=k[1],S=Object(r.useState)(!1),C=Object(o.a)(S,2),E=C[0],_=C[1],q=e.index,F=e.response,T=e.returnFile,A=e.locked,N=e.id,P=e.feedbackType,B=e.askFeedback,D=e.saveQuestionFeedback,R=e.prevTaskId,U=(e.uploadFilesData,e.attachMaterials);Object(r.useEffect)((function(){F&&l(F)}),[F]),Object(r.useEffect)((function(){P&&B?(console.log(P),j.firestore().collection("schema").doc("structure").collection("feedbacks").doc(P).get().then((function(e){w(e.data())})),_(!0)):_(!1)}),[P]);var W=function(){f(!1)};return Object(c.jsxs)("div",{children:[Object(c.jsx)(re,{title:y.title,dialogFunction:function(){D(g,N,R),W()},state:b,handleClose:W,feedbackValue:g,answers:y.answers,description:y.description,returnFeedback:function(e){v(e)}}),Object(c.jsxs)(G.a,{display:"flex",style:{marginBottom:10,marginTop:20},children:[Object(c.jsx)(z.a,{variant:"h6",style:{paddingRight:8},children:e.title}),E&&Object(c.jsx)(I.a,{size:"small",onClick:function(){return f(!0)},children:Object(c.jsx)(H.a,{color:"primary"})})]}),Object(c.jsx)(V.a,{id:"inputBox"+q,label:"\u041c\u043e\u0439 \u043e\u0442\u0432\u0435\u0442",value:s,onChange:function(t){l(t.target.value),e.returnAnswer(t.target.value,e.index)},multiline:!0,rows:5,disabled:A,variant:"outlined",fullWidth:!0}),!A&&U&&Object(c.jsx)(ie,{returnFile:T,locked:A,id:N})]})})),le=n(180),ue=n(257),de=n(186),je=Object(N.a)((function(e){return{formControl:{minWidth:120}}}));function be(e){var t=je(),n=a.a.useState(""),i=Object(o.a)(n,2),s=i[0],l=i[1],u=a.a.useState(!1),d=Object(o.a)(u,2),j=d[0],b=d[1],f=e.index,O=e.response,h=(e.required,e.locked);Object(r.useEffect)((function(){O&&l(O)}),[O]);return Object(c.jsxs)("div",{children:[Object(c.jsx)(z.a,{variant:"h6",style:{marginBottom:5,marginTop:20},children:e.title}),Object(c.jsxs)(ne.a,{className:t.formControl,disabled:h,children:[Object(c.jsx)(le.a,{id:"controlled-open-select-label",children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c"}),Object(c.jsxs)(de.a,{labelId:"controlled-open-select-label",id:"select"+f,open:j,onClose:function(e){b(!1)},onOpen:function(e){b(!0)},value:s,onChange:function(t){l(t.target.value);e.answers.indexOf(t.target.value);e.returnAnswer(t.target.value,f)},children:[Object(c.jsx)(ue.a,{value:"",children:Object(c.jsx)("em",{children:"None"})}),e.answers.map((function(e,t){return Object(c.jsx)(ue.a,{value:e,children:e},t)}))]})]})]})}function fe(e){var t=a.a.useState(""),n=Object(o.a)(t,2),i=n[0],s=n[1],l=e.index,u=e.response;Object(r.useEffect)((function(){u&&s(u)}),[u]);return Object(c.jsxs)("div",{children:[Object(c.jsx)("h4",{children:e.title}),Object(c.jsx)(ne.a,{const:"fieldset",children:Object(c.jsx)(ee.a,{"aria-label":e.title,name:e.title,value:i,onChange:function(t){s(t.target.value);var n=e.answers.indexOf(t.target.value);e.returnAnswer(t.target.value,l,n)},children:e.answers.map((function(t,n){return Object(c.jsx)(te.a,{value:t,control:Object(c.jsx)($.a,{color:"primary"}),label:t,disabled:!!e.locked},n)}))})})]})}var Oe=Object(N.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"auto"}}}));function he(e){var t=Oe(),n=a.a.useState(""),i=Object(o.a)(n,2),s=i[0],l=i[1],u=e.index,d=e.response;Object(r.useEffect)((function(){d&&l(d)}),[u,d]);return Object(c.jsxs)("div",{children:[Object(c.jsx)("h4",{children:e.title}),Object(c.jsx)("form",{className:t.container,noValidate:!0,children:Object(c.jsx)(V.a,{id:"time"+u,label:"\u0412\u0440\u0435\u043c\u044f",type:"time",value:s,onChange:function(t){l(t.target.value),e.returnAnswer(t.target.value,u,t.target.value)},className:t.textField,InputLabelProps:{shrink:!0},InputProps:{disableUnderline:!0},disabled:!!e.locked})})]})}var pe=n(181),xe=n(178),ge=n(254);function ve(e){var t=a.a.useState({}),n=Object(o.a)(t,2),i=n[0],s=n[1],l=Object(r.useState)(!1),u=Object(o.a)(l,2),d=u[0],j=u[1],b=e.index,f=e.answers,O=(e.required,e.response),h=e.locked;Object(r.useEffect)((function(){if(O){s(O);var t={};f.forEach((function(e,n){O[e]?t[e]=O[e]:t[e]=!1})),s(t),e.returnAnswer(t,b)}else{var n={};f.forEach((function(e,t){return n[e]=!1})),e.returnAnswer(n,b)}j(!0),console.log(i)}),[O,f]);var p=function(t){s(Object(v.a)(Object(v.a)({},i),{},Object(k.a)({},t.target.name,t.target.checked))),e.returnAnswer(Object(v.a)(Object(v.a)({},i),{},Object(k.a)({},t.target.name,t.target.checked)),b)};return d?Object(c.jsxs)("div",{children:[Object(c.jsx)(z.a,{variant:"h6",style:{marginBottom:0,marginTop:20},children:e.title}),Object(c.jsxs)(ne.a,{component:"fieldset",disabled:h,children:[Object(c.jsx)(pe.a,{component:"legend",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432"}),Object(c.jsx)(xe.a,{children:f.map((function(e,t){return Object(c.jsx)(te.a,{control:Object(c.jsx)(ge.a,{checked:i[e],onChange:p,name:e}),label:e},t)}))})]})]}):null}var me=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)({}),s=Object(o.a)(i,2),l=s[0],u=s[1],f=Object(r.useState)([]),O=Object(o.a)(f,2),x=O[0],g=O[1],m=Object(r.useState)(!1),k=Object(o.a)(m,2),y=k[0],w=k[1],S=Object(r.useState)(!1),C=Object(o.a)(S,2),E=C[0],I=C[1],_=Object(r.useState)({}),q=Object(o.a)(_,2),F=(q[0],q[1]),T=Object(r.useContext)(b).currentUser;Object(r.useEffect)((function(){var e={};T&&j.firestore().collection("users").doc(T.uid).get().then((function(t){F(t.data()),e=t.data()})).then((function(){j.firestore().collection("profileTemplate").doc("Template").get().then((function(t){console.log(JSON.stringify(t.data())),a(t.data().questions),console.log(t.data().questions);var n=t.data().questions.map((function(t,n){var r=null;return e[t.key]&&(console.log(e[t.key]),r=e[t.key]),"input"===t.type?Object(c.jsx)(oe,{index:n,title:t.question,response:r,returnAnswer:N,required:t.required},"profile_"+n):"select"===t.type?Object(c.jsx)(be,{index:n,title:t.question,response:r,answers:t.answers,returnAnswer:N,required:t.required},"profile_"+n):"radio"===t.type?Object(c.jsx)(fe,{index:n,title:t.question,response:r,answers:t.answers,returnAnswer:N,required:t.required},"profile_"+n):"time"===t.type?Object(c.jsx)(he,{index:n,title:t.question,response:r,returnAnswer:N,required:t.required},"profile_"+n):"checkbox"===t.type?Object(c.jsx)(ve,{index:n,title:t.question,response:r,answers:t.answers,returnAnswer:N,required:t.required},"profile_"+n):null}));g(n)}))}))}),[T]);var N=function(e,t){var n=l;n[t]=e,u(n),console.log(l)};return T?Object(c.jsxs)(p.a,{style:{padding:30},children:[E&&Object(c.jsx)(h.a,{to:"/"}),x,Object(c.jsxs)(p.a,{container:!0,style:{padding:20},justify:"center",children:[Object(c.jsx)(A.a,{variant:"outlined",style:{borderWidth:2,borderColor:"#003366",color:"#003366",margin:10},onClick:function(){var e={};n.forEach((function(t,n){l[n]&&(e[t.key]=l[n])})),j.firestore().collection("users").doc(T.uid).update(Object(v.a)({},e)).then((function(){return w(!0)}))},children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),y&&Object(c.jsx)(A.a,{variant:"outlined",style:{borderWidth:2,borderColor:"red",color:"red",margin:10},onClick:function(){return I(!0)},children:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})]})]}):Object(c.jsxs)(p.a,{container:!0,direction:"column",style:{padding:20},justify:"center",children:[Object(c.jsx)(z.a,{align:"center",variant:"h3",children:"\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c"}),Object(c.jsx)("br",{}),Object(c.jsx)(A.a,{variant:"contained",onClick:d,children:"\u0412\u043e\u0439\u0442\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Google"})]})},ke=n(245),ye=n(247),we=n(246),Se=Object(N.a)({root:{minWidth:250},bullet:{display:"inline-block",margin:"0 2px"},title:{fontSize:14},pos:{marginBottom:12}}),Ce=function(e){var t=Se(),n=e.title,a=(e.status,e.type),i=(e.language,e.description),s=e.id,l=e.cardColor,u=e.sendRequest,d=e.disabled,j=Object(r.useState)(!1),b=Object(o.a)(j,2),f=b[0],O=b[1];return Object(c.jsxs)("div",{children:[f&&Object(c.jsx)(h.a,{to:"/tasks/"+s}),Object(c.jsxs)(ke.a,{className:t.root,style:{background:l},children:[Object(c.jsxs)(we.a,{children:[Object(c.jsx)(z.a,{variant:"h6",children:n}),Object(c.jsxs)(z.a,{variant:"subtitle1",className:t.pos,color:"textSecondary",children:["#",a]}),Object(c.jsxs)(z.a,{variant:"body2",component:"p",children:["\u0417\u0430\u0434\u0430\u043d\u0438\u0435: ",i]})]}),Object(c.jsx)(ye.a,{children:u?Object(c.jsx)(A.a,{variant:"contained",disabled:d,color:"primary",size:"small",onClick:function(){return u(a,s)},children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"}):Object(c.jsx)(A.a,{size:"small",onClick:function(){return O(!0)},children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c"})})]})]})},Ee=function(e){var t=Object(r.useState)(null),n=Object(o.a)(t,2),a=n[0],i=n[1],s=Object(r.useContext)(b).currentUser;return Object(r.useEffect)((function(){if(s){var e=[];console.log("Fired"),j.firestore().collection("tasks").where("assigned_users","array-contains",s.uid).get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data()),e.push({id:t.id,data:t.data()})}))})).then((function(){i(e)})).catch((function(e){console.log("Error getting documents: ",e)}))}}),[s]),Object(c.jsxs)(p.a,{container:!0,justify:"center",alignItems:"center",direction:"column",children:[Object(c.jsx)(z.a,{variant:"h4",children:"\u0417\u0430\u0434\u0430\u043d\u0438\u044f"}),a&&a.map((function(e,t){return Object(c.jsx)(p.a,{style:{padding:10},children:Object(c.jsx)(Ce,{title:e.data.title,description:e.data.description,type:e.data.type,id:e.id})},t)}))]})},Ie=n(72);var _e=function(e){var t=e.title;return Object(c.jsx)("div",{children:Object(c.jsx)(z.a,{variant:"h6",style:{marginBottom:0,marginTop:20},children:t})})},qe=Object(r.forwardRef)((function(e,t){var n=e.question,r=e.index,a=e.response,i=e.uploadsRef,s=e.returnAnswer,o=e.locked,l=e.askFeedback,u=e.saveQuestionFeedback,d=e.id,j=e.prevTaskId,b=e.returnFile,f=e.uploadFilesData;return"input"===n.type?Object(c.jsx)(oe,{index:r,title:n.title,response:a,returnAnswer:s,required:n.required,locked:o,askFeedback:l,feedbackType:n.feedback_type,saveQuestionFeedback:u,id:d,prevTaskId:j,uploadFilesData:f,uploadsRef:i,returnFile:b,attachMaterials:n.attachMaterials},r):"select"===n.type?Object(c.jsx)(be,{index:r,title:n.title,response:a,answers:n.answers,returnAnswer:s,required:n.required,locked:o},r):"radio"===n.type?Object(c.jsx)(fe,{index:r,title:n.title,response:a,answers:n.answers,returnAnswer:s,required:n.required,locked:o},r):"time"===n.type?Object(c.jsx)(he,{index:r,title:n.title,response:a,returnAnswer:s,required:n.required,locked:o},r):"checkbox"===n.type?Object(c.jsx)(ve,{index:r,title:n.title,response:a,answers:n.answers,returnAnswer:s,required:n.required,locked:o},r):"text"===n.type?Object(c.jsx)(_e,{title:n.title},r):"file"===n.type?Object(c.jsx)(ie,{index:r,id:d,title:n.title,returnFile:b,locked:o,askFeedback:l,feedbackType:n.feedback_type,saveQuestionFeedback:u,prevTaskId:j},r):null}));function Fe(e){return Object(c.jsx)("div",{children:Object(c.jsxs)(J.a,{open:e.state,onClose:e.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(c.jsx)(Z.a,{id:"alert-dialog-title",children:e.title}),Object(c.jsx)(Y.a,{children:Object(c.jsx)(X.a,{id:"alert-dialog-description",children:e.content})}),Object(c.jsxs)(K.a,{children:[Object(c.jsx)(A.a,{onClick:e.handleClose,color:"primary",children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(c.jsx)(A.a,{onClick:e.dialogFunction,color:"primary",autoFocus:!0,children:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c"})]})]})})}var Te=n(255),Ae=n(87),ze=n.n(Ae),Ne=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],i=t[1],s=Object(r.useState)([]),l=Object(o.a)(s,2),u=(l[0],l[1]),f=Object(r.useState)({}),O=Object(o.a)(f,2),x=O[0],k=O[1],y=Object(r.useState)([]),w=Object(o.a)(y,2),S=w[0],C=w[1],E=Object(r.useState)(!1),_=Object(o.a)(E,2),q=(_[0],_[1]),F=Object(r.useState)(!1),T=Object(o.a)(F,2),N=T[0],P=T[1],B=Object(r.useState)({}),D=Object(o.a)(B,2),R=(D[0],D[1],Object(r.useState)(!1)),U=Object(o.a)(R,2),W=U[0],L=U[1],M=Object(r.useState)([]),V=Object(o.a)(M,2),G=(V[0],V[1]),Q=Object(r.useState)(!1),H=Object(o.a)(Q,2),J=H[0],K=H[1],Y=Object(r.useState)(null),X=Object(o.a)(Y,2),Z=X[0],$=X[1],ee=Object(r.useState)({}),te=Object(o.a)(ee,2),ne=te[0],ce=te[1],ae=Object(r.useState)({}),ie=Object(o.a)(ae,2),se=ie[0],oe=ie[1],le=Object(r.useState)(!1),ue=Object(o.a)(le,2),de=ue[0],je=ue[1],be=Object(r.useState)({}),fe=Object(o.a)(be,2),Oe=fe[0],he=fe[1],pe=Object(r.useContext)(b).currentUser,xe=Object(h.g)().id,ge=function(e,t){"clickaway"!==t&&je(!1)};Object(r.useEffect)((function(){var e=function(){var e=Object(m.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,j.firestore().collection("tasks").doc(t).collection("questions").get().then((function(e){e.forEach((function(e){n.push({questionId:e.id,data:e.data()})}))})).catch((function(e){console.log("Error getting documents: ",e)}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t=function(){var e=Object(m.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,j.firestore().collection("tasks").doc(t).collection("responses").get().then((function(e){e.forEach((function(e){n.push({responseId:e.id,data:e.data()})}))})).catch((function(e){console.log("Error getting documents: ",e)}));case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n=function(){var e=Object(m.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,j.firestore().collection("tasks").doc(xe).get().then((function(e){return e.data()})).then(function(){var e=Object(m.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.firestore().collection("tasks").where("case_id","==",n.case_id).get().then((function(e){e.forEach((function(e){e.id!==xe&&t.push(Object(v.a)({id:e.id},e.data()))}))}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();pe&&function(){var r=Object(m.a)(g.a.mark((function r(){var a,s,o,l,d,b,f,O,h,p,x;return g.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=[],s=!0,C(null),r.next=5,j.firestore().collection("tasks").doc(xe).collection("user_editable").doc("user_editable").get().then((function(e){"complete"===e.data().status?(s=!0,L(!0)):s=!1}));case 5:return o=[],l=[],r.next=9,n();case 9:if(d=r.sent,G(d),!(d.length>0)){r.next=21;break}return b=d.map((function(t){return e(t.id)})),f=d.map((function(e){return t(e.id)})),console.log(b),r.next=17,Promise.all(b).then((function(e){return e.forEach((function(e){return o.push.apply(o,Object(Ie.a)(e))}))}));case 17:return r.next=19,Promise.all(f).then((function(e){return e.forEach((function(e){return l.push.apply(l,Object(Ie.a)(e))}))}));case 19:console.log(o),console.log(l);case 21:return(O=o.map((function(e,t){var n=null;return l.forEach((function(c){e.questionId===c.responseId&&(n=c.data.answer,ve(c.data.answer,t))})),Object(c.jsx)(qe,{question:e.data,index:t,response:n,returnAnswer:ve,locked:!0,askFeedback:!0,saveQuestionFeedback:ye,id:e.questionId,prevTaskId:d[0].id},e.questionId+"_"+t)}))).push(Object(c.jsx)("div",{style:{height:25,margin:"20px 0",background:"repeating-linear-gradient( 45deg, white, white 10px, grey 10px, grey 25px)"},children:Object(c.jsx)("br",{})},"div_divider_stripped")),r.next=25,e(xe);case 25:return h=r.sent,r.next=28,t(xe);case 28:p=r.sent,i(h),u(p),a=h.map((function(e,t){var n=null;return p.forEach((function(c){e.questionId===c.responseId&&(n=c.data.answer,ve(c.data.answer,t))})),Object(c.jsx)(qe,{question:e.data,index:t,response:n,returnFile:me,returnAnswer:ve,id:e.questionId,locked:s,uploadFilesData:Se},e.questionId+"_"+t)})),x=O.concat(a),C(x);case 34:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()()}),[pe,xe,W]);var ve=function(e,t){var n=x;n[t]=e,k(n)},me=function(e,t){var n=Object(Ie.a)(e),c=Oe;c[t]=n,he(c),console.log(Object(Ie.a)(e),t)},ke=function(){if(Object.keys(Oe).length>0){console.log("files");for(var e=function(){var e=Object(o.a)(n[t],2),c=e[0],r=e[1],a=j.storage().ref(xe).child(c).child(pe.uid);r.forEach((function(e){return a.child(e.name).put(e).then((function(t){return t.ref.getDownloadURL().then((function(t){return Se(e.name,t,c)}))}))}))},t=0,n=Object.entries(Oe);t<n.length;t++)e()}},ye=function(e,t,n){n?j.firestore().collection("tasks").doc(n).collection("feedbacks").doc(t).collection("messages").add({answer:e.reason,text:e.text,user_id:pe.uid,timestamp:j.firestore.FieldValue.serverTimestamp()}).then((function(){return je(!0)})):alert("\u041e\u0448\u0438\u0431\u043a\u0430: \u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a \u043f\u0440\u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0438 \u0444\u0438\u0434\u0431\u0435\u043a\u0430. \u0421\u043e\u043e\u0431\u0449\u0438\u0442\u0435 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0441\u0442\u0443!")},we=function(){var e=Object(m.a)(g.a.mark((function e(t){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ke(),n.forEach(function(){var e=Object(m.a)(g.a.mark((function e(t,n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x[n]&&""!==x[n]){e.next=3;break}return e.next=3,j.firestore().collection("tasks").doc(xe).collection("responses").doc(t.questionId).set({answer:x[n]},{merge:!0});case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),!t){e.next=7;break}return e.next=5,j.firestore().collection("tasks").doc(xe).collection("user_editable").doc("user_editable").update({status:"complete"});case 5:L(!0),K(!1);case 7:q(!0);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Se=function(){var e=Object(m.a)(g.a.mark((function e(t,n,c){var r;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=j.firestore().collection("tasks").doc(xe).collection("responses").doc(c),console.log("\u0424\u0430\u0439\u043b \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"),t&&n&&r.set({files:j.firestore.FieldValue.arrayUnion({public_url:n,filename:t})},{merge:!0}).then((function(){return console.log("super")}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),Ce=function(){K(!1),ce({})},Ee=function(e){"send"===e&&($("send"),K(!0)),"release"===e&&($("release"),K(!0))};Object(r.useEffect)((function(){j.firestore().collection("schema").doc("structure").collection("feedbacks").doc("release").get().then((function(e){oe(e.data())}))}),[]);return pe?Object(c.jsxs)(p.a,{style:{padding:30},children:["send"===Z&&Object(c.jsx)(Fe,{state:J,handleClose:Ce,title:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435?",content:"\u0412\u044b \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u0442\u0435\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435. \u042d\u0442\u043e \u0437\u043d\u0430\u0447\u0438\u0442, \u0447\u0442\u043e \u0432\u044b \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0435 \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u0442\u044c \u043e\u0442\u0432\u0435\u0442\u044b.",dialogFunction:function(){return we(!0)}}),"release"===Z&&Object(c.jsx)(re,{state:J,feedbackValue:ne,handleClose:Ce,title:se.title,dialogFunction:function(){j.firestore().collection("tasks").doc(xe).collection("user_editable").doc("user_editable").update({status:"open"}).then((function(){return j.firestore().collection("tasks").doc(xe).collection("user_editable").doc("user_editable").update({status:"released",release_status:ne.reason,release_description:ne.text}).then((function(){K(!1),L(!0)}))}))},answers:se.answers,description:se.description,returnFeedback:function(e){ce(e)}}),N&&Object(c.jsx)(h.a,{to:"/tasks"}),Object(c.jsx)(Te.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:de,autoHideDuration:6e3,onClose:ge,message:"\u0424\u0438\u0434\u0431\u0435\u043a \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d",action:Object(c.jsx)(a.a.Fragment,{children:Object(c.jsx)(I.a,{size:"small","aria-label":"close",color:"inherit",onClick:ge,children:Object(c.jsx)(ze.a,{fontSize:"small"})})})}),S,Object(c.jsxs)(p.a,{container:!0,style:{padding:20},justify:"center",children:[Object(c.jsx)(A.a,{variant:"outlined",style:{borderWidth:2,borderColor:"grey",color:"grey",margin:5},onClick:function(){return P(!0)},children:"\u041d\u0430\u0437\u0430\u0434"}),!W&&Object(c.jsxs)("div",{children:[Object(c.jsx)(A.a,{variant:"outlined",disabled:W,style:{borderWidth:2,borderColor:"#003366",color:"#003366",margin:5},onClick:function(){return we(!1)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"}),Object(c.jsx)(A.a,{variant:"outlined",disabled:W,style:{borderWidth:2,borderColor:"red",color:"red",margin:5},onClick:function(){return Ee("send")},children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),Object(c.jsx)(A.a,{variant:"outlined",disabled:W,style:{borderWidth:2,borderColor:"red",color:"red",margin:5},onClick:function(){return Ee("release")},children:"\u041e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u044c"})]})]})]}):Object(c.jsxs)(p.a,{container:!0,direction:"column",style:{padding:20},justify:"center",children:[Object(c.jsx)(z.a,{align:"center",variant:"h3",children:"\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c"}),Object(c.jsx)("br",{}),Object(c.jsx)(A.a,{variant:"contained",onClick:d,children:"\u0412\u043e\u0439\u0442\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Google"})]})},Pe=n(97),Be=n(94),De=function(e){var t=e.caseId,n=Object(r.useState)(null),i=Object(o.a)(n,2),s=i[0],l=i[1],u=Object(r.useState)(!1),d=Object(o.a)(u,2),f=d[0],O=d[1],h=Object(r.useContext)(b).currentUser,x=a.a.useState(!1),g=Object(o.a)(x,2),m=g[0],k=g[1],y=Object(r.useState)(!1),w=Object(o.a)(y,2),S=w[0],C=w[1],E=Object(r.useState)(""),_=Object(o.a)(E,2),q=_[0],F=_[1],T=function(e,t){"clickaway"!==t&&k(!1)};Object(r.useEffect)((function(){if(h){var e=[];console.log("Fired"),j.firestore().collection("schema").doc("structure").collection("cases").doc(t).collection("stages").get().then((function(t){t.forEach((function(t){console.log(t.id," => ",t.data()),e.push(Object(v.a)({id:t.id},t.data()))}))})).then((function(){e.sort((function(e,t){return parseInt(e.order)-parseInt(t.order)})),l(e),O(!0)})).catch((function(e){console.log("Error getting documents: ",e)}))}}),[h]),Object(r.useEffect)((function(){j.firestore().collection("tasks").where("assigned_users","array-contains",h.uid).where("is_complete","==",!1).get().then((function(e){e.empty?C(!1):(C(!0),F("\u0423 \u0432\u0430\u0441 \u0435\u0441\u0442\u044c \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f. \u0421\u0434\u0430\u0439\u0442\u0435 \u0438\u043b\u0438 \u043e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442\u0435 \u0438\u0445, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435."))}))}),[h,S]);var A=function(e,n){j.firestore().collection("task_requests").doc(h.uid).collection("requests").add({taskType:e,status:"pending",user:h.uid,case_type:t,case_stage_id:n}).then((function(e){k(!0),console.log("sending request")}))};return Object(c.jsxs)("div",{children:[Object(c.jsx)(Te.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:m,autoHideDuration:6e3,onClose:T,message:"\u0417\u0430\u043f\u0440\u043e\u0441 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d",action:Object(c.jsx)(a.a.Fragment,{children:Object(c.jsx)(I.a,{size:"small","aria-label":"close",color:"inherit",onClick:T,children:Object(c.jsx)(ze.a,{fontSize:"small"})})})}),Object(c.jsxs)(Pe.a,{style:{margin:"20px 5px",border:"1px grey solid"},children:[Object(c.jsxs)(G.a,{style:{padding:"10px 20px 0px"},children:[Object(c.jsx)(G.a,{style:{padding:"5px 10px 10px"},children:Object(c.jsx)(z.a,{variant:"h6",children:e.title})}),Object(c.jsx)(G.a,{style:{padding:"10px 10px 5px"},children:Object(c.jsx)(z.a,{variant:"body2",children:e.description})}),Object(c.jsx)(G.a,{style:{padding:"10px 10px 0px"},children:Object(c.jsx)(z.a,{color:"error",children:q})})]}),Object(c.jsx)(p.a,{container:!0,justify:"center",style:{padding:10},children:f&&s.map((function(e,t){return Object(c.jsx)(p.a,{item:!0,style:{padding:10},children:Object(c.jsx)(Ce,{title:e.title,description:e.description,type:e.type,id:e.id,cardColor:"#F5F5F5",sendRequest:A,disabled:S})},t)}))})]})]})},Re=function(){var e=Object(r.useContext)(b).currentUser,t=Object(r.useState)([]),n=Object(o.a)(t,2),a=n[0],i=n[1],s=Object(r.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1];return Object(r.useEffect)((function(){if(e){var t=[];console.log("Fired"),j.firestore().collection("schema").doc("structure").collection("cases").get().then((function(e){e.forEach((function(e){console.log(e.id," => ",e.data()),t.push(Object(v.a)({id:e.id},e.data()))}))})).then((function(){i(t),d(!0),console.log(t)})).catch((function(e){console.log("Error getting documents: ",e)}))}}),[e]),Object(c.jsx)("div",{children:u&&a.map((function(e,t){return Object(c.jsx)(De,{title:e.title,description:e.description,caseId:e.id},t)}))})},Ue=Object(N.a)((function(e){return{root:Object(k.a)({margin:20,width:500},e.breakpoints.down("sm"),{maxWidth:300}),bullet:{display:"inline-block",margin:"0 2px"},title:{fontSize:14},pos:{marginBottom:12}}})),We=function(e){var t=Ue(),n=e.title,a=e.description,i=e.id,s=(e.index,e.setShown),l=e.shown,u=Object(r.useState)(!1),d=Object(o.a)(u,2),j=d[0],b=d[1];return Object(r.useEffect)((function(){b(!!l)}),[l]),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsxs)(ke.a,{className:t.root,style:j?{background:"grey",opacity:.25}:{background:"lightblue"},children:[Object(c.jsxs)(we.a,{children:[Object(c.jsx)(z.a,{variant:"h6",children:n}),Object(c.jsx)(z.a,{variant:"body2",component:"p",children:a})]}),Object(c.jsx)(ye.a,{style:{justifyContent:"flex-end"},children:Object(c.jsx)(A.a,{size:"small",onClick:function(){return s(i)},children:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u043e"})})]})})},Le=function(){var e=Object(r.useContext)(b).currentUser,t=Object(r.useState)([]),n=Object(o.a)(t,2),a=n[0],i=n[1],s=function(e){j.firestore().collection("notifications").doc(e).update({shown:!0})};return Object(r.useEffect)((function(){if(e){var t=j.firestore().collection("notifications").where("user_id","array-contains",e.uid).onSnapshot(function(){var e=Object(m.a)(g.a.mark((function e(t){var n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t.forEach((function(e,t){n.push(Object(v.a)({id:e.id},e.data()))})),i(n);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){return t()}}}),[e]),Object(c.jsxs)("div",{children:[Object(c.jsx)(z.a,{variant:"h5",align:"center",children:"\u0423\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"}),a.map((function(e,t){return Object(c.jsx)(We,{id:e.id,index:t,title:e.title,setShown:s,shown:e.shown,description:e.description},t)}))]})},Me=n(117),Ve=n.n(Me),Ge=n(252),Qe=n(248),He=Object(N.a)((function(e){return{root:Object(k.a)({marginTop:20,background:"lightgreen",height:200,width:500},e.breakpoints.down("sm"),{maxWidth:300})}})),Je=function(){var e=He(),t=Object(r.useState)(null),n=Object(o.a)(t,2),a=n[0],i=n[1],s=Object(r.useContext)(b).currentUser;return Object(r.useEffect)((function(){var e=function(){return Object(Ge.a)().toString()+"_"+Date.now()};s&&j.firestore().collection("users").doc(s.uid).get().then((function(t){var n=t.data().tg_token;if(n){console.log(n);var c=parseInt(n.substring(n.indexOf("_")+1)),r=Ve()().diff(c,"hours");if(console.log(r),r>0){var a=e();j.firestore().collection("users").doc(s.uid).update({tg_token:a}),i(a)}else i(n)}else{console.log("no token");var o=e();j.firestore().collection("users").doc(s.uid).update({tg_token:o}),i(o)}}))}),[s]),s?Object(c.jsxs)(p.a,{container:!0,justify:"center",direction:"column",alignItems:"center",className:e.root,children:[Object(c.jsx)(z.a,{style:{paddingBottom:10},variant:"h5",align:"center",children:"\u041f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0435 \u0430\u043a\u043a\u0430\u0443\u043d\u0442 \u043a Telegram \u0431\u043e\u0442\u0443 (\u043d\u0430\u0431\u043b\u044e\u0434\u0430\u0442\u0435\u043b\u044f\u043c \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e!)"}),Object(c.jsx)(Qe.a,{variant:"h5",href:"https://telegram.me/journal_tg_bot?start="+a,children:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0431\u043e\u0442"})]}):Object(c.jsxs)(p.a,{container:!0,direction:"column",style:{padding:20},justify:"center",children:[Object(c.jsx)(z.a,{align:"center",variant:"h3",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(c.jsx)("br",{}),Object(c.jsx)(A.a,{size:"large",color:"primary",variant:"contained",onClick:d,children:"\u0412\u043e\u0439\u0442\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0430\u043a\u043a\u0430\u0443\u043d\u0442\u0430 Google"})]})},Ke=Object(N.a)({root:{minWidth:275},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}});function Ye(e){var t=Ke();return console.log("TEST CARD"),console.log(e),e.userInfo=={}?Object(c.jsx)("div",{}):Object(c.jsx)(ke.a,{className:t.root,variant:"outlined",children:Object(c.jsxs)(we.a,{children:[Object(c.jsxs)(z.a,{className:t.title,color:"textSecondary",gutterBottom:!0,children:["id: ",e.userInfo.id]}),Object(c.jsxs)(z.a,{variant:"h5",component:"h2",children:[e.userInfo.surname," ",e.userInfo.name]}),Object(c.jsxs)(z.a,{className:t.pos,color:"textSecondary",children:["\u0420\u0435\u0433\u0438\u043e\u043d: ",e.userInfo.district]}),Object(c.jsx)(z.a,{variant:"body2",component:"p",children:e.userInfo.phone}),Object(c.jsx)(z.a,{variant:"body2",component:"p",children:e.userInfo.email})]})})}var Xe=function(e){var t=a.a.useState([]),n=Object(o.a)(t,2),i=(n[0],n[1],Object(r.useState)({})),s=Object(o.a)(i,2),l=s[0],u=s[1],d={},b=Object(r.useState)([]),f=Object(o.a)(b,2),O=(f[0],f[1]),h=Object(r.useState)([]),x=Object(o.a)(h,2),v=(x[0],x[1]),k=Object(r.useState)({}),y=Object(o.a)(k,2),w=y[0],S=y[1],C=Object(r.useState)(Object(c.jsx)("div",{})),E=Object(o.a)(C,2),I=E[0],_=E[1],q=Object(r.useState)(!1),F=Object(o.a)(q,2),T=F[0],z=F[1],N=Object(r.useState)(!1),P=Object(o.a)(N,2),B=P[0],D=P[1],R=Object(r.useState)(!1),U=Object(o.a)(R,2),W=U[0],L=U[1],M=Object(r.useState)(!1),V=Object(o.a)(M,2),G=V[0],Q=V[1],H=Object(r.useState)(!1),J=Object(o.a)(H,2),K=J[0],Y=J[1],X=function(){var t=Object(m.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:j.firestore().collection("tasks").doc(e.task.id).get().then((function(e){var t=e.data().review_status;z("pending"===t),D("passed"===t),L("not passed"===t),Q("verified"===t),Y("not verified"===t)}));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){var t=function(){var t=Object(m.a)(g.a.mark((function t(){var n,r,a,i;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],r=[],a=[],i=!0,console.log("HOOK"),X(),t.next=8,j.firestore().collection("tasks").doc(e.task.id).get().then((function(e){u(e.data())})).catch((function(e){console.log("Error getting documents: ",e)}));case 8:return t.next=10,j.firestore().collection("tasks").doc(e.task.id).collection("questions").get().then((function(e){e.forEach((function(e){n.push({questionId:e.id,data:e.data()})}))})).then((function(){O(n)})).catch((function(e){console.log("Error getting documents: ",e)}));case 10:return t.next=12,j.firestore().collection("tasks").doc(e.task.id).collection("responses").get().then((function(e){e.forEach((function(e){r.push({responseId:e.id,data:e.data()})}))})).then((function(){v(r)})).catch((function(e){console.log("Error getting documents: ",e)}));case 12:_(Object(c.jsx)("div",{})),a=n.map((function(e,t){var n=null;return r.forEach((function(c){e.questionId===c.responseId&&(n=c.data.answer,Z(c.data.answer,t))})),Object(c.jsx)(qe,{question:e.data,index:t,response:n,returnAnswer:Z,locked:i},t)})),_(a);case 15:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e.task.id&&t()}),[e.task.id]);var Z=function(e,t){var n=w;n[t]=e,S(n)},$=function(){var t=Object(m.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.firestore().collection("tasks").doc(e.task.id).update({review_status:n});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return function(){if(void 0!==l.assigned_users&&l.assigned_users.length>0){var t=e.users.find((function(e){return e.id===l.assigned_users[0]}));d=void 0!==t?t:{}}}(),Object(c.jsxs)(p.a,{style:{padding:30},children:[Object(c.jsxs)(p.a,{container:!0,style:{padding:20},justify:"center",children:[Object(c.jsx)(A.a,{variant:"contained",color:T?"secondary":"{}",onClick:function(){$("pending"),X()},children:"PENDING"}),Object(c.jsx)(A.a,{variant:"contained",color:B?"secondary":"{}",onClick:function(){$("passed"),X()},children:"PASSED"}),Object(c.jsx)(A.a,{variant:"contained",color:W?"secondary":"{}",onClick:function(){$("not passed"),X()},children:"NOT PASSED"}),Object(c.jsx)(A.a,{variant:"contained",color:G?"secondary":"{}",onClick:function(){$("verified"),X()},children:"VERIFIED"}),Object(c.jsx)(A.a,{variant:"contained",color:K?"secondary":"{}",onClick:function(){$("not verified"),X()},children:"NOT VERIFIED"})]}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsx)(Ye,{userInfo:d,children:" "})}),I]})},Ze=n(250),$e=function(e){var t=Object(r.useState)(0),n=Object(o.a)(t,2),a=n[0],i=n[1],s=Object(r.useState)(1),l=Object(o.a)(s,2),u=l[0],d=(l[1],Object(r.useState)([])),j=Object(o.a)(d,2),b=j[0],f=j[1],O=function(e,t,n){var c=Object(Be.a)(n),r=Math.floor(c.size/t);console.log("numberOfPages",r);var a=e*t,i=c.size;return e!==r-1&&(i=(e+1)*t),console.log("Start",a),console.log("End",i),n.slice(a,i)};Object(r.useEffect)((function(){i(0),f(O(0,1,e.data))}),[e.data]);var h=e.data.length>0&&Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsx)(Ze.a,{justify:"center",component:"div",count:e.data.length,page:a,onChangePage:function(t,n){f(O(n,u,e.data)),i(n)},rowsPerPage:u,onChangeRowsPerPage:function(e){},labelRowsPerPage:"\u041f\u043e \u043e\u0434\u043d\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443!"})}),x=void 0!==b[0];return Object(c.jsxs)("div",{children:[h,Object(c.jsx)(p.a,{container:!0,spacing:0,direction:"column",alignItems:"center",justify:"center",style:{minHeight:"100vh"},children:Object(c.jsx)(p.a,{item:!0,xs:12,children:Object(c.jsx)(p.a,{container:!0,justify:"center",direction:"column",spacing:1,children:x?Object(c.jsx)(p.a,{item:!0,children:Object(c.jsx)(Xe,{task:b[0],users:e.users})}):"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b!"})})}),h]})},et=n(114),tt=n(182),nt=n(118),ct=n.n(nt),rt=function(e){var t=["\u0412\u0421\u0415","\u041f\u043e\u0438\u0441\u043a \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445","interview"],n=["\u0412\u0421\u0415","\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u2116 1.1","\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u2116 1.2","\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u2116 1.3","\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u2116 2.1"],i=["\u0412\u0421\u0415","pending","passed","not passed","verified","not verified"],s=a.a.useState([]),l=Object(o.a)(s,2),u=l[0],d=l[1],b=a.a.useState("\u0412\u0421\u0415"),f=Object(o.a)(b,2),O=f[0],h=f[1],x=a.a.useState([]),k=Object(o.a)(x,2),y=k[0],w=k[1],S=a.a.useState(t[0]),C=Object(o.a)(S,2),E=C[0],I=C[1],_=a.a.useState(n[0]),q=Object(o.a)(_,2),F=q[0],T=q[1],z=a.a.useState(i[0]),N=Object(o.a)(z,2),P=N[0],B=N[1],D=function(){var e=Object(m.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[{id:"\u0412\u0421\u0415",name:"\u0412\u0421\u0415",surname:""}],n=j.firestore().collection("users").orderBy("surname"),e.next=4,n.get().then((function(e){e.forEach((function(e){t.push(Object(v.a)({id:e.id},e.data()))})),w(t)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(m.a)(g.a.mark((function e(){var t,n;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=j.firestore().collection("tasks"),"\u0412\u0421\u0415"!=O&&(n=n.where("assigned_users","array-contains",O)),"\u0412\u0421\u0415"!=F&&(n=n.where("title","==",F)),"\u0412\u0421\u0415"!=E&&(n=n.where("type","==",E)),"\u0412\u0421\u0415"!=P&&(n=n.where("review_status","==",P)),e.next=8,n.get().then((function(e){e.forEach((function(e){t.push(Object(v.a)({id:e.id},e.data()))})),d(t)}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){D()}),[]),Object(c.jsxs)("div",{children:[Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsxs)(ne.a,{style:{width:"350px"},children:[Object(c.jsx)(et.a,{value:O.value,onChange:function(e){h(e.target.value)},name:"filterUser",children:y.map((function(e){return Object(c.jsxs)("option",{value:e.id,children:[" ",e.surname," ",e.name]})}))}),Object(c.jsx)(tt.a,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u043e users"})]})}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsxs)(ne.a,{style:{width:"350px"},children:[Object(c.jsx)(et.a,{value:F,onChange:function(e){T(e.target.value)},name:"filterTaskTitle",children:n.map((function(e){return Object(c.jsx)("option",{value:e,children:e})}))}),Object(c.jsx)(tt.a,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u043e \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438"})]})}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsxs)(ne.a,{style:{width:"350px"},children:[Object(c.jsx)(et.a,{value:E,onChange:function(e){I(e.target.value)},name:"filterTaskType",children:t.map((function(e){return Object(c.jsx)("option",{value:e,children:e})}))}),Object(c.jsx)(tt.a,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u043e \u0442\u0438\u043f\u0443 \u0437\u0430\u0434\u0430\u0447\u0438"})]})}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsxs)(ne.a,{style:{width:"350px"},children:[Object(c.jsx)(et.a,{value:P,onChange:function(e){B(e.target.value)},name:"filterReviewStatus",children:i.map((function(e){return Object(c.jsx)("option",{value:e,children:e})}))}),Object(c.jsx)(tt.a,{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0438\u043b\u044c\u0442\u0440 \u043f\u043e review_status"})]})}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsx)(A.a,{style:{width:"350px"},type:"number",variant:"contained",onClick:function(e){R()},color:"primary",startIcon:Object(c.jsx)(ct.a,{}),children:"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"})}),Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsx)($e,{data:u,users:y})})]})},at=function(){return Object(c.jsx)(O.a,{children:Object(c.jsx)(p.a,{container:!0,justify:"center",children:Object(c.jsx)(M,{children:Object(c.jsxs)(h.d,{children:[Object(c.jsx)(h.b,{exact:!0,path:"/profile",children:Object(c.jsx)(me,{})}),Object(c.jsx)(h.b,{exact:!0,path:"/request",children:Object(c.jsx)(Re,{})}),Object(c.jsx)(h.b,{exact:!0,path:"/tasks",children:Object(c.jsx)(Ee,{})}),Object(c.jsx)(h.b,{path:"/tasks/:id",children:Object(c.jsx)(Ne,{})}),Object(c.jsx)(h.b,{exact:!0,path:"/tasksObserver",children:Object(c.jsx)(rt,{})}),Object(c.jsx)(h.b,{exact:!0,path:"/notifications",children:Object(c.jsx)(Le,{})}),Object(c.jsx)(h.b,{exact:!0,path:"/",children:Object(c.jsx)(Je,{})})]})})})})},it=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,259)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};s.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(f,{children:Object(c.jsx)(at,{})})}),document.getElementById("root")),it()}},[[173,1,2]]]);
//# sourceMappingURL=main.2fbf17f8.chunk.js.map